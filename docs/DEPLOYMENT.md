# 🚀 部署指南

**版本**: v1.0.0  
**最後更新**: 2025-08-06  
**適用對象**: 開發者、維護者

## 📋 部署前檢查清單

### 程式碼品質檢查
- [ ] 所有測試通過 (`npm test`)
- [ ] 程式碼風格檢查通過 (`npm run lint`)
- [ ] 建置成功 (`npm run build:prod`)
- [ ] 沒有安全性警告 (`npm audit`)

### 功能驗證
- [ ] Readmoo 資料提取功能正常
- [ ] Chrome Extension 基本功能運作
- [ ] 資料匯出功能正常
- [ ] Overview 頁面顯示正常
- [ ] 搜尋和篩選功能正常

### 文件完整性
- [ ] README.md 更新至最新版本
- [ ] CHANGELOG.md 記錄完整
- [ ] 用戶手冊準備完成
- [ ] API 文件更新

## 🏗 建置流程

### 開發版本建置 (本地測試推薦)
```bash
# 安裝依賴
npm install --legacy-peer-deps

# 執行測試
npm test

# 建置開發版本
npm run build:dev
```

**輸出目錄**: `build/development/`
**用途**: 本地開發測試，保留完整程式碼結構，方便 DevTools 除錯

### 生產版本建置 (上架專用)
```bash
# 清理先前建置
npm run clean

# 建置生產版本
npm run build:prod

# 自動驗證建置結果
npm run validate:build:prod
```

**輸出目錄**: `build/production/`  
**用途**: Chrome Web Store 上架版本，經過優化處理

### 版本共存機制

兩個建置版本可以同時存在，互不影響：
- `build/development/` - 開發測試版本
- `build/production/` - 上架發布版本

### 建議的開發流程

#### 開發階段
```bash
npm run build:dev
```
- 載入到 Chrome: 選擇 `build/development/` 目錄
- 優點: 建置速度快、除錯友好、程式碼結構完整

#### 上架前準備  
```bash
npm run build:prod
```
- 用途: 最終測試和 Chrome Web Store 上架
- 重要: **上架前建議重新打包**，確保程式碼為最新版本

#### 最佳實務建議
1. **開發期間**: 使用 `build:dev` 進行日常開發和測試
2. **功能完成**: 用 `build:prod` 做最終版本測試  
3. **確認無誤**: 將 `build/production/` 打包上架
4. **版本一致性**: 避免開發版本意外上架

### 建置驗證指令

專案提供自動化的建置驗證功能：

```bash
# 驗證開發版本建置
npm run validate:build

# 驗證生產版本建置  
npm run validate:build:prod
```

#### 驗證項目包含

- **目錄結構驗證**: 確認所有必要檔案和目錄存在
- **Manifest 檔案驗證**: 檢查 manifest.json 語法和必要欄位
- **核心檔案檢查**: 驗證 Background、Content Script、Popup 檔案
- **圖示檔案檢查**: 確認 16x16、48x48、128x128 圖示存在
- **權限配置檢查**: 驗證權限設定符合最小權限原則
- **檔案大小檢查**: 防止檔案過大影響載入速度

#### 驗證結果說明

- **✅ 通過**: 所有檢查通過，可安全使用
- **⚠️ 警告**: 功能正常但有優化建議
- **❌ 失敗**: 發現問題，需修正後重新建置

## 📦 Chrome Web Store 上架

### 準備工作
1. **圖示資源檢查**
   - [ ] 16x16 圖示 (`assets/icons/icon-16.png`)
   - [ ] 48x48 圖示 (`assets/icons/icon-48.png`) 
   - [ ] 128x128 圖示 (`assets/icons/icon-128.png`)

2. **Manifest 檢查**
   - [ ] 版本號正確 (`manifest.json` version 欄位)
   - [ ] 權限設定最小化
   - [ ] 描述和名稱準確

3. **商店資源準備**
   - [ ] 應用程式截圖 (1280x800)
   - [ ] 宣傳圖片 (440x280)
   - [ ] 詳細描述
   - [ ] 隱私政策連結

### 上架步驟
1. 登入 [Chrome Developer Dashboard](https://chrome.google.com/webstore/devconsole/)
2. 建立新項目或更新現有項目
3. 上傳 ZIP 檔案 (包含所有必要檔案)
4. 填寫商店資訊
5. 提交審核

### 審核要點
- 確保符合 Chrome Web Store 政策
- 隱私政策明確說明資料使用
- 功能描述準確無誤
- 沒有惡意軟體或不當內容

## 🔄 版本更新流程

### 小版本更新 (v1.0.x)
1. 修復錯誤或小功能改進
2. 更新 `manifest.json` 版本號
3. 更新 `CHANGELOG.md`
4. 建置並測試
5. 上傳至 Chrome Web Store

### 大版本更新 (v1.x.0)
1. 完成功能開發和測試
2. 更新所有相關文件
3. 進行完整的回歸測試
4. 準備發布公告
5. 上架新版本

## 🚨 緊急修復流程

### Hotfix 流程
1. **識別問題**: 確認問題嚴重性和影響範圍
2. **緊急修復**: 建立 hotfix 分支進行修復
3. **快速測試**: 執行關鍵功能測試
4. **緊急部署**: 跳過部分檢查，快速上架
5. **後續追蹤**: 監控修復效果，準備正式版本

### 回滾機制
如果新版本出現嚴重問題：
1. 準備前一版本的程式碼
2. 快速建置和上傳
3. 通知用戶版本回滾
4. 分析問題原因並準備修復

## 📊 部署監控

### 關鍵指標監控
- 安裝數量變化
- 用戶評分和評論
- 錯誤報告頻率
- 功能使用統計

### 問題追蹤
- 建立錯誤報告收集機制
- 監控 Chrome Web Store 評論
- 追蹤 GitHub Issues
- 分析用戶回饋

## 🛡 安全性考量

### 資料安全
- 所有用戶資料在本地處理
- 不上傳敏感資訊到外部服務
- 遵循最小權限原則

### 程式碼安全
- 避免 eval() 和動態程式碼執行
- 驗證所有外部輸入
- 定期更新依賴套件

### 隱私保護
- 明確的隱私政策
- 最小化資料收集
- 提供資料刪除選項

## 🔧 故障排除

### 常見問題
1. **建置失敗**
   - 檢查 Node.js 版本相容性
   - 清理 node_modules 重新安裝
   - 檢查套件版本衝突

2. **Chrome Extension 無法載入**
   - 檢查 manifest.json 語法
   - 確認所有必要檔案存在
   - 檢查權限設定

3. **功能異常**
   - 檢查 Console 錯誤訊息
   - 驗證 DOM 選擇器
   - 確認事件監聽器註冊

### Debug 模式
```bash
# 啟用 Debug 模式
npm run build:debug

# 執行本地測試伺服器
npm run serve:test
```

## 📞 支援聯絡

### 技術支援
- **GitHub Issues**: [專案 GitHub 頁面]
- **開發者郵件**: [開發者聯絡信箱]
- **文件問題**: [文件回饋連結]

### 緊急聯絡
- **緊急修復**: [緊急聯絡方式]
- **安全問題**: [安全回報信箱]

---

**文件維護者**: 開發團隊  
**審核週期**: 每次主要版本發布前更新