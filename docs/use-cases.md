# 📋 Readmoo 書庫提取器 - Use Cases 規格

**版本**: v1.0  
**文件版本**: 2025-08-22  
**基於**: [核心功能規格](./core-functionality.md)

## 🎯 Use Case 概述

本文件描述 Readmoo 書庫提取器的核心使用場景，每個 Use Case 都對應到具體的使用者需求和系統功能。這些 Use Case 將作為測試設計和功能驗證的基礎。

## 👤 角色定義

### Primary Actor: 書籍收集者 (Book Collector)

- **描述**: 使用 Readmoo 閱讀電子書的使用者
- **目標**: 系統化管理和備份個人書庫資料
- **技能水平**: 一般電腦使用者，熟悉瀏覽器操作
- **使用頻率**: 每週1-3次提取新書籍，每月1-2次備份資料

## 📚 核心 Use Cases

### UC-01: 首次安裝與設定

**描述**: 使用者第一次安裝和使用 Extension

**前置條件**:

- 使用者已在Chrome瀏覽器中安裝Extension
- 使用者有Readmoo帳號並已登入

**主要流程**:

1. 使用者訪問 Readmoo 書庫頁面
2. 點擊 Extension 圖示開啟 Popup
3. 看到歡迎訊息和「提取書籍資料」按鈕
4. 點擊按鈕開始首次資料提取
5. 系統掃描頁面並提取所有可見書籍
6. Popup 顯示提取結果：「成功提取 X 本書籍」
7. 使用者點擊「查看詳細資料」開啟 Overview 頁面
8. 在 Overview 頁面查看完整書籍清單

**預期結果**:

- 所有可見書籍都被正確提取
- 資料格式符合JSON結構規範
- 使用者能夠在Overview頁面看到完整資料
- 系統自動儲存資料到本地存儲

**成功標準**:

- 提取成功率 > 95%
- 每本書籍都包含必要欄位（id, title, cover等）
- Overview頁面載入時間 < 3秒
- 無JavaScript錯誤

---

### UC-02: 日常書籍資料提取

**描述**: 使用者定期提取新增的書籍資料

**前置條件**:

- Extension已安裝且之前已有書籍資料
- 使用者在Readmoo書庫頁面
- 書庫中有新書籍（未提取過的）

**主要流程**:

1. 使用者購買或借閱新書籍後，訪問書庫頁面
2. 開啟 Extension Popup
3. 看到現有書籍數量：「目前共有 X 本書籍」
4. 點擊「提取書籍資料」按鈕
5. 系統掃描頁面，識別新書籍和已存在書籍
6. 只提取新書籍，更新已存在書籍的進度資訊
7. Popup 顯示：「新增 X 本書籍，更新 Y 本書籍進度」
8. 使用者可選擇立即查看或關閉 Popup

**替代流程**:

- **2a**: 如果頁面沒有新書籍，顯示「無新書籍需要提取」
- **5a**: 如果網路連接有問題，顯示錯誤訊息並提供重試選項

**預期結果**:

- 新書籍被正確加入資料庫
- 現有書籍的進度資訊被更新
- 不會產生重複記錄
- 去重邏輯正確運行

**成功標準**:

- 新書籍檢測準確率 100%
- 去重邏輯準確率 > 99%
- 進度更新準確率 100%
- 整個流程時間 < 10秒

---

### UC-03: 資料匯出與備份

**描述**: 使用者將書籍資料匯出為檔案進行備份

**前置條件**:

- 系統中已有書籍資料（至少1本）
- 使用者在 Overview 頁面或 Popup 中

**主要流程**:

1. 使用者在 Overview 頁面點擊「匯出」按鈕
2. 選擇匯出格式：JSON（推薦）或 CSV
3. 系統生成檔案並自動下載
4. 檔案名稱格式：`readmoo-books-2025-08-22.json`
5. 檔案儲存到瀏覽器預設下載目錄
6. 系統顯示成功訊息：「已匯出 X 本書籍資料」

**JSON匯出的替代流程**:

- **從Popup匯出**: 點擊Popup中的「匯出JSON」按鈕，直接下載

**CSV匯出的替代流程**:

- **表格格式**: 匯出為試算表友善的CSV格式，適合Excel處理

**預期結果**:

- 產生的檔案包含所有書籍資料
- JSON格式完整且可被系統重新匯入
- CSV格式適合在Excel等軟體中開啟
- 檔案可正常下載到指定位置

**成功標準**:

- 匯出的資料完整性 100%
- JSON檔案符合系統匯入格式
- CSV檔案可在Excel中正常開啟
- 檔案下載成功率 100%

---

### UC-04: 資料匯入與恢復

**描述**: 使用者從JSON檔案載入書籍資料

**前置條件**:

- 使用者擁有有效的JSON匯出檔案
- 使用者在 Overview 頁面

**主要流程**:

1. 使用者點擊「載入檔案」按鈕
2. 選擇之前匯出的JSON檔案
3. 系統驗證檔案格式：
   - 檢查檔案是否為有效JSON
   - 驗證資料結構是否符合規範
4. 顯示載入預覽：「即將載入 X 本書籍」
5. 使用者選擇載入模式：
   - 「覆蓋現有資料」：清空現有資料再載入
   - 「合併資料」：與現有資料合併，自動去重
6. 系統處理資料並應用去重邏輯
7. 更新 Overview 頁面顯示載入後的資料
8. 顯示成功訊息：「成功載入 X 本書籍，合併後共 Y 本」

**錯誤處理流程**:

- **3a**: 檔案格式錯誤，顯示：「檔案格式不正確，請選擇有效的JSON檔案」
- **3b**: 資料結構不符，顯示：「檔案內容不符合書籍資料格式」
- **6a**: 載入過程中發生錯誤，顯示具體錯誤訊息並提供重試選項

**預期結果**:

- 有效資料被正確載入到系統
- 去重邏輯正確運行，無重複記錄
- Overview頁面正確顯示載入後的資料
- 原有資料根據使用者選擇被保留或覆蓋

**成功標準**:

- 檔案格式驗證準確率 100%
- 資料載入完整性 100%
- 去重邏輯準確率 > 99%
- 載入1000筆資料時間 < 5秒

---

### UC-05: 跨設備資料同步

**描述**: 使用者在多個設備間同步書籍資料

**前置條件**:

- 使用者在設備A已有書籍資料
- 使用者需要在設備B獲得相同資料
- 兩個設備都已安裝Extension

**主要流程**:

1. **在設備A**：
   - 使用者匯出最新的書籍資料為JSON檔案
   - 將檔案上傳到雲端硬碟（Google Drive, Dropbox等）
2. **在設備B**：
   - 從雲端硬碟下載JSON檔案
   - 使用載入功能匯入資料
   - 選擇「覆蓋現有資料」確保完全同步
3. **驗證同步**：
   - 在兩個設備上檢查書籍總數是否一致
   - 檢查最近修改時間是否正確

**定期同步流程**:

1. 使用者在常用設備上定期匯出資料
2. 在其他設備上定期匯入最新資料
3. 建立個人的同步排程（如每週同步一次）

**預期結果**:

- 兩個設備上的書籍資料完全一致
- 新增的書籍在所有設備上都可見
- 閱讀進度在所有設備上保持同步

**成功標準**:

- 資料同步一致性 100%
- 跨設備操作流程時間 < 5分鐘
- 無資料遺失或損壞

---

### UC-06: 書籍資料檢視與管理

**描述**: 使用者檢視、搜尋和管理已提取的書籍資料

**前置條件**:

- 系統中已有書籍資料
- 使用者在 Overview 頁面

**主要流程**:

1. **檢視書籍清單**：
   - 以表格形式顯示所有書籍
   - 包含書名、進度、來源、提取時間等欄位
   - 支援分頁顯示（每頁50本）

2. **搜尋特定書籍**：
   - 在搜尋框輸入書名關鍵字
   - 系統即時篩選顯示匹配的書籍
   - 支援模糊匹配（如 "javascrpt" 匹配 "javascript"）

3. **篩選功能**：
   - 按閱讀進度篩選（未開始、進行中、已完成）
   - 按提取時間篩選（本週、本月、全部）
   - 按書籍類型篩選（電子書、有聲書等）

4. **詳細資訊檢視**：
   - 點擊書籍行查看完整資訊
   - 顯示封面圖片、完整標題、閱讀進度、提取時間

**進階管理功能**:

- **手動編輯**: 點擊編輯按鈕修改書名或進度
- **刪除書籍**: 移除不需要的書籍記錄
- **批量操作**: 選擇多本書籍進行批量刪除或匯出

**預期結果**:

- 所有書籍資料正確顯示
- 搜尋和篩選功能運作正常
- 編輯操作即時反映在介面上
- 資料操作不會影響原始資料完整性

**成功標準**:

- 頁面載入時間 < 3秒（1000本書籍）
- 搜尋響應時間 < 1秒
- 篩選準確率 100%
- 編輯操作成功率 100%

---

### UC-07: 錯誤處理與恢復

**描述**: 系統在各種錯誤情況下的處理與恢復

**常見錯誤場景**:

**場景A - 網路連接問題**:

- **觸發**: 提取資料時網路中斷
- **系統行為**: 顯示「網路連接有問題，請檢查網路後重試」
- **使用者操作**: 點擊「重試」按鈕
- **預期結果**: 網路恢復後能成功提取資料

**場景B - Readmoo頁面結構變更**:

- **觸發**: Readmoo網站更新了DOM結構
- **系統行為**: 提取失敗，顯示「無法找到書籍資料，可能是網站結構已更新」
- **使用者操作**: 通知開發者或等待Extension更新
- **預期結果**: 優雅降級，不會崩潰

**場景C - 檔案匯入格式錯誤**:

- **觸發**: 使用者選擇了錯誤格式的檔案
- **系統行為**: 顯示具體錯誤訊息和修正建議
- **使用者操作**: 選擇正確的JSON檔案
- **預期結果**: 能夠成功匯入正確格式的檔案

**場景D - 儲存空間不足**:

- **觸發**: Chrome Extension儲存空間達到限制
- **系統行為**: 顯示空間不足警告和清理建議
- **使用者操作**: 刪除部分資料或匯出後清空
- **預期結果**: 系統能繼續正常運作

**預期結果**:

- 所有錯誤都有清楚的訊息說明
- 使用者能夠理解錯誤原因和解決方法
- 系統在錯誤後能夠恢復正常運作
- 不會有資料遺失或損壞

**成功標準**:

- 錯誤訊息清楚易懂 100%
- 系統恢復成功率 > 95%
- 無因錯誤處理導致的資料遺失

---

## 🔍 Use Case 對映表

| Use Case | 核心功能模組   | 主要組件                                | 測試優先級 |
| -------- | -------------- | --------------------------------------- | ---------- |
| UC-01    | 資料提取、UI   | BookDataExtractor, ReadmooAdapter       | 高         |
| UC-02    | 資料提取、去重 | BookDataExtractor, generateStableBookId | 高         |
| UC-03    | 資料匯出       | JSONExportHandler, exportToCSV          | 高         |
| UC-04    | 資料匯入、去重 | loadFromFile, 格式驗證                  | 高         |
| UC-05    | 匯出、匯入     | 完整匯出入流程                          | 中         |
| UC-06    | UI、資料存儲   | Overview頁面, 搜尋篩選                  | 中         |
| UC-07    | 錯誤處理       | 全系統錯誤處理機制                      | 中         |

## 📋 Use Case 驗證檢查清單

### 功能完整性檢查

- [ ] 每個 Use Case 都有對應的程式碼實現
- [ ] 所有主要流程都有測試覆蓋
- [ ] 替代流程和錯誤處理都有驗證
- [ ] 成功標準都可量化測試

### 使用者體驗檢查

- [ ] 操作流程直觀易懂
- [ ] 錯誤訊息清楚有幫助
- [ ] 響應時間符合預期
- [ ] 介面反饋及時準確

### 系統穩定性檢查

- [ ] 邊界條件處理正確
- [ ] 大量資料處理穩定
- [ ] 錯誤恢復機制有效
- [ ] 資料完整性保證

---

**備註**: 這些 Use Cases 涵蓋了系統的核心功能和主要使用場景。每個 Use Case 都應該有對應的測試案例來驗證實現的正確性。
