# v0.10.12 ç°¡åŒ–ç‰ˆéŒ¯èª¤è™•ç†æ©Ÿåˆ¶è¨­è¨ˆ

**é–‹ç™¼ç‰ˆæœ¬**: v0.10.12  
**é–‹ç™¼æ—¥æœŸ**: 2025-09-03  
**ä¸»è¦ä»»å‹™**: ç°¡åŒ–ç‰ˆéŒ¯èª¤è™•ç†æ©Ÿåˆ¶è¨­è¨ˆ - ç«‹å³å¯å¯¦ä½œç‰ˆæœ¬  
**å·¥ä½œç‹€æ…‹**: ğŸ”„ é€²è¡Œä¸­ - TDD Phase 1 åŠŸèƒ½è¨­è¨ˆéšæ®µ  
**é–‹ç™¼è€…**: lavender-interface-designer (TDDåŠŸèƒ½è¨­è¨ˆå¸«å°ˆå®¶)

## ğŸ¯ å·¥ä½œç›®æ¨™èˆ‡èƒŒæ™¯

### å‹™å¯¦è¨­è¨ˆç†å¿µ

åŸºæ–¼å°ˆå®¶å¯©æŸ¥æ„è¦‹å’Œå¯¦éš›é–‹ç™¼éœ€æ±‚ï¼Œè¨­è¨ˆä¸€å€‹**å¯ç«‹å³å¯¦ä½œ**çš„ç°¡åŒ–ç‰ˆéŒ¯èª¤è™•ç†æ©Ÿåˆ¶ï¼Œå°ˆæ³¨æ–¼è§£æ±ºç•¶å‰çš„å¯¦éš›å•é¡Œï¼Œé¿å…éåº¦è¨­è¨ˆã€‚

### æ ¸å¿ƒå•é¡Œé‡æ–°èšç„¦

**ç•¶å‰ç·Šæ€¥å•é¡Œ**ï¼š
- **3760å€‹ lint å•é¡Œ**ï¼ˆä¸»è¦æ˜¯ console.log è­¦å‘Šï¼‰
- **æ¸¬è©¦å¤±æ•—**ï¼ˆStorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œï¼‰
- **æ–‡å­—ä¸çµ±ä¸€å°è‡´æ¸¬è©¦ä¸ç©©å®š**
- **ç¼ºä¹çµ±ä¸€çš„éŒ¯èª¤å›æ‡‰æ ¼å¼**

**Linuxå°ˆå®¶å»ºè­°æ¡ç”¨çš„ç°¡åŒ–æ–¹æ¡ˆ**ï¼š
- è¨˜æ†¶é«”ä½¿ç”¨ < 500KBï¼ˆè€Œé1.37MB+ï¼‰
- è™•ç†æ™‚é–“ < 5msï¼ˆè€Œé < 1ms ä¸ç¾å¯¦ç›®æ¨™ï¼‰
- é¿å…è¤‡é›œçš„è·¨ç’°å¢ƒå”ä½œæ©Ÿåˆ¶ï¼ˆç¬¬ä¸€ç‰ˆæœ¬ï¼‰

## ğŸ“… 2025-09-03 TDD Phase 1 ç°¡åŒ–è¨­è¨ˆè¨˜éŒ„

### 1. åŠŸèƒ½éœ€æ±‚åˆ†æéšæ®µ âœ…

#### æ ¸å¿ƒåƒ¹å€¼é‡æ–°å®šç¾©ï¼ˆå‹™å¯¦ç‰ˆï¼‰

**ç«‹å³è§£æ±ºå•é¡Œçš„åƒ¹å€¼**ï¼š
- **æ¶ˆé™¤ lint å•é¡Œ**: å°‡æ‰€æœ‰ console.log æ›¿æ›ç‚ºçµ±ä¸€çš„æ—¥èªŒç³»çµ±
- **ä¿®å¾©æ¸¬è©¦å¤±æ•—**: å»ºç«‹çµ±ä¸€çš„éŒ¯èª¤å›æ‡‰æ ¼å¼ï¼Œæ‘’æ£„å­—ä¸²æ¯”å°
- **çµ±ä¸€æ–‡å­—ç®¡ç†**: é›†ä¸­åŒ–ç®¡ç†æ‰€æœ‰ç¡¬ç·¨ç¢¼æ–‡å­—
- **å»ºç«‹åŸºç¤æ¨™æº–**: ç‚ºæœªä¾†æ“´å±•å¥ å®šç°¡å–®ç©©å›ºçš„åŸºç¤

**åœ˜éšŠå”ä½œåƒ¹å€¼**ï¼š
- **å³å­¸å³ç”¨**: æ–°å·¥ç¨‹å¸«å¯åœ¨30åˆ†é˜å…§ç†è§£å’Œä½¿ç”¨
- **ä¸€è‡´æ€§**: æ‰€æœ‰éŒ¯èª¤è™•ç†ä½¿ç”¨ç›¸åŒçš„ç°¡å–®æ¨¡å¼
- **å¯æ¸¬è©¦æ€§**: çµæ§‹åŒ–é©—è­‰å–ä»£å­—ä¸²æ¯”å°
- **å¯ç¶­è­·æ€§**: é›†ä¸­åŒ–æ–‡å­—ç®¡ç†é™ä½ç¶­è­·æˆæœ¬

#### ä½¿ç”¨è€…å ´æ™¯åˆ†æï¼ˆç°¡åŒ–ç‰ˆï¼‰

**å·¥ç¨‹å¸«æ—¥å¸¸é–‹ç™¼å ´æ™¯**ï¼š
1. **éŒ¯èª¤è™•ç†å ´æ™¯**: é–‹ç™¼è€…éœ€è¦ä¸€å€‹ç°¡å–®çš„æ–¹å¼æ‹‹å‡ºå’Œè™•ç†éŒ¯èª¤
2. **çµæœæª¢é©—å ´æ™¯**: é–‹ç™¼è€…éœ€è¦æª¢æŸ¥æ“ä½œçš„æˆåŠŸ/å¤±æ•—ç‹€æ…‹
3. **æ—¥èªŒè¼¸å‡ºå ´æ™¯**: é–‹ç™¼è€…éœ€è¦æ›¿ä»£ console.log çš„çµ±ä¸€æ—¥èªŒæ–¹æ¡ˆ
4. **æ¸¬è©¦ç·¨å¯«å ´æ™¯**: é–‹ç™¼è€…éœ€è¦å¯é çš„çµæ§‹åŒ–æ¸¬è©¦æ–¹æ³•

**ç³»çµ±æ•´åˆå ´æ™¯**ï¼š
1. **æ¨¡çµ„é–“é€šè¨Š**: ä½¿ç”¨çµ±ä¸€çš„ OperationResult æ ¼å¼
2. **éŒ¯èª¤å‚³é**: ç°¡å–®çš„éŒ¯èª¤ç‰©ä»¶åœ¨æ¨¡çµ„é–“å‚³é
3. **æ—¥èªŒèšåˆ**: çµ±ä¸€çš„æ—¥èªŒæ ¼å¼

#### æœŸæœ›æ•ˆæœï¼ˆå¯æ¸¬é‡ç›®æ¨™ï¼‰

**ç¨‹å¼ç¢¼å“è³ªæ”¹å–„**ï¼š
- lint å•é¡Œå¾ 3760 å€‹æ¸›å°‘åˆ° < 100 å€‹ï¼ˆ97%æ”¹å–„ï¼‰
- æ¸¬è©¦é€šéç‡å¾ç›®å‰ç‹€æ…‹æå‡åˆ° 100%
- ç¡¬ç·¨ç¢¼æ–‡å­—æ¸›å°‘ 90%ï¼ˆé›†ä¸­åŒ–ç®¡ç†ï¼‰

**é–‹ç™¼æ•ˆç‡æå‡**ï¼š
- æ–°å·¥ç¨‹å¸«ä¸Šæ‰‹æ™‚é–“ï¼š< 30 åˆ†é˜
- éŒ¯èª¤è™•ç†ç¨‹å¼ç¢¼ç·¨å¯«æ™‚é–“æ¸›å°‘ 50%
- æ¸¬è©¦ç·¨å¯«å’Œç¶­è­·æ™‚é–“æ¸›å°‘ 40%

### 2. åŠŸèƒ½è¦æ ¼è¨­è¨ˆéšæ®µ âœ…

#### æ ¸å¿ƒçµ„ä»¶è¨­è¨ˆï¼ˆæœ€å°å¯è¡Œç‰ˆæœ¬ï¼‰

**1. åŸºç¤éŒ¯èª¤é¡åˆ¥**ï¼š
```javascript
// ç°¡å–®çš„çµ±ä¸€éŒ¯èª¤æ ¼å¼
class StandardError {
  constructor(code, message, details = {}) {
    this.code = code           // éŒ¯èª¤ä»£ç¢¼
    this.message = message     // éŒ¯èª¤è¨Šæ¯
    this.details = details     // é™„åŠ è³‡è¨Š
    this.timestamp = Date.now() // æ™‚é–“æˆ³
    this.id = this.generateId() // å”¯ä¸€è­˜åˆ¥
  }
  
  // è½‰æ›ç‚º JSONï¼ˆç”¨æ–¼å‚³è¼¸å’Œå„²å­˜ï¼‰
  toJSON() {
    return {
      code: this.code,
      message: this.message,
      details: this.details,
      timestamp: this.timestamp,
      id: this.id
    }
  }
  
  // å¾ JSON å»ºç«‹éŒ¯èª¤ç‰©ä»¶
  static fromJSON(json) {
    const error = new StandardError(json.code, json.message, json.details)
    error.timestamp = json.timestamp
    error.id = json.id
    return error
  }
  
  generateId() {
    return `err_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
  }
}
```

**2. çµ±ä¸€å›æ‡‰æ ¼å¼**ï¼š
```javascript
// æ¨™æº–åŒ–æ“ä½œçµæœ
class OperationResult {
  constructor(success, data = null, error = null) {
    this.success = success
    this.data = data
    this.error = error
    this.timestamp = Date.now()
  }
  
  // æˆåŠŸçµæœçš„å¿«é€Ÿå»ºç«‹æ–¹æ³•
  static success(data = null) {
    return new OperationResult(true, data, null)
  }
  
  // å¤±æ•—çµæœçš„å¿«é€Ÿå»ºç«‹æ–¹æ³•
  static failure(error) {
    // ç¢ºä¿éŒ¯èª¤æ˜¯ StandardError æ ¼å¼
    const standardError = error instanceof StandardError 
      ? error 
      : new StandardError('UNKNOWN_ERROR', error.message || 'Unknown error', { originalError: error })
    
    return new OperationResult(false, null, standardError)
  }
  
  // æª¢æŸ¥æ˜¯å¦æˆåŠŸ
  get isSuccess() {
    return this.success === true
  }
  
  // æª¢æŸ¥æ˜¯å¦å¤±æ•—
  get isFailure() {
    return this.success === false
  }
  
  // å¦‚æœå¤±æ•—å‰‡æ‹‹å‡ºç•°å¸¸ï¼ˆç”¨æ–¼å¿…é ˆæˆåŠŸçš„å ´æ™¯ï¼‰
  throwIfFailure() {
    if (this.isFailure) {
      throw new Error(`Operation failed: ${this.error.message} (${this.error.code})`)
    }
    return this.data
  }
}
```

**3. è¨Šæ¯å­—å…¸ç³»çµ±**ï¼š
```javascript
// é›†ä¸­åŒ–æ–‡å­—ç®¡ç†
class MessageDictionary {
  constructor() {
    this.messages = this.loadDefaultMessages()
    this.language = 'zh-TW'
  }
  
  // è¼‰å…¥é è¨­è¨Šæ¯
  loadDefaultMessages() {
    return {
      // éŒ¯èª¤è¨Šæ¯
      VALIDATION_FAILED: 'è³‡æ–™é©—è­‰å¤±æ•—',
      NETWORK_ERROR: 'ç¶²è·¯é€£ç·šç•°å¸¸',
      STORAGE_ERROR: 'å„²å­˜æ“ä½œå¤±æ•—',
      PERMISSION_DENIED: 'æ¬Šé™ä¸è¶³',
      UNKNOWN_ERROR: 'æœªçŸ¥éŒ¯èª¤',
      
      // æ“ä½œè¨Šæ¯
      OPERATION_START: 'é–‹å§‹åŸ·è¡Œæ“ä½œ',
      OPERATION_COMPLETE: 'æ“ä½œå®Œæˆ',
      OPERATION_CANCELLED: 'æ“ä½œå·²å–æ¶ˆ',
      
      // ç³»çµ±è¨Šæ¯
      SYSTEM_READY: 'ç³»çµ±æº–å‚™å°±ç·’',
      LOADING: 'è¼‰å…¥ä¸­...',
      PROCESSING: 'è™•ç†ä¸­...',
      
      // ä½¿ç”¨è€…è¨Šæ¯
      SUCCESS: 'æˆåŠŸ',
      FAILED: 'å¤±æ•—',
      RETRY: 'é‡è©¦',
      CANCEL: 'å–æ¶ˆ'
    }
  }
  
  // å–å¾—è¨Šæ¯
  get(key, params = {}) {
    let message = this.messages[key] || `[Missing: ${key}]`
    
    // ç°¡å–®çš„åƒæ•¸æ›¿æ›
    Object.keys(params).forEach(param => {
      const placeholder = `{${param}}`
      message = message.replace(new RegExp(placeholder, 'g'), params[param])
    })
    
    return message
  }
  
  // æ–°å¢æˆ–æ›´æ–°è¨Šæ¯
  set(key, message) {
    this.messages[key] = message
  }
  
  // æ‰¹æ¬¡æ–°å¢è¨Šæ¯
  addMessages(messages) {
    Object.assign(this.messages, messages)
  }
}

// å…¨åŸŸè¨Šæ¯å­—å…¸å¯¦ä¾‹
const GlobalMessages = new MessageDictionary()
```

**4. çµ±ä¸€æ—¥èªŒç³»çµ±**ï¼š
```javascript
// æ›¿æ›æ‰€æœ‰ console.log çš„æ—¥èªŒç³»çµ±
class Logger {
  constructor(name = 'App') {
    this.name = name
    this.level = 'INFO' // DEBUG, INFO, WARN, ERROR
    this.messages = GlobalMessages
  }
  
  // é™¤éŒ¯è¨Šæ¯
  debug(messageKey, data = {}) {
    if (this.shouldLog('DEBUG')) {
      this.output('DEBUG', messageKey, data)
    }
  }
  
  // è³‡è¨Šè¨Šæ¯
  info(messageKey, data = {}) {
    if (this.shouldLog('INFO')) {
      this.output('INFO', messageKey, data)
    }
  }
  
  // è­¦å‘Šè¨Šæ¯
  warn(messageKey, data = {}) {
    if (this.shouldLog('WARN')) {
      this.output('WARN', messageKey, data)
    }
  }
  
  // éŒ¯èª¤è¨Šæ¯
  error(messageKey, data = {}) {
    if (this.shouldLog('ERROR')) {
      this.output('ERROR', messageKey, data)
    }
  }
  
  // è¼¸å‡ºæ—¥èªŒ
  output(level, messageKey, data) {
    const message = this.messages.get(messageKey, data)
    const logEntry = {
      timestamp: new Date().toISOString(),
      level,
      name: this.name,
      message,
      data: Object.keys(data).length > 0 ? data : undefined
    }
    
    // æ ¹æ“šç­‰ç´šè¼¸å‡ºåˆ°é©ç•¶çš„ console æ–¹æ³•
    switch (level) {
      case 'DEBUG':
        console.debug('[DEBUG]', logEntry)
        break
      case 'INFO':
        console.info('[INFO]', logEntry)
        break
      case 'WARN':
        console.warn('[WARN]', logEntry)
        break
      case 'ERROR':
        console.error('[ERROR]', logEntry)
        break
    }
  }
  
  // æª¢æŸ¥æ˜¯å¦æ‡‰è©²è¼¸å‡ºè©²ç­‰ç´šçš„æ—¥èªŒ
  shouldLog(level) {
    const levels = ['DEBUG', 'INFO', 'WARN', 'ERROR']
    const currentIndex = levels.indexOf(this.level)
    const targetIndex = levels.indexOf(level)
    return targetIndex >= currentIndex
  }
}

// å»ºç«‹å…¨åŸŸæ—¥èªŒå¯¦ä¾‹çš„å·¥å» å‡½æ•¸
function createLogger(name) {
  return new Logger(name)
}
```

**5. éŒ¯èª¤è™•ç†è¼”åŠ©å‡½æ•¸**ï¼š
```javascript
// ç°¡åŒ–éŒ¯èª¤è™•ç†çš„è¼”åŠ©å‡½æ•¸
class ErrorHelper {
  static createError(code, message, details = {}) {
    return new StandardError(code, message, details)
  }
  
  static createNetworkError(message, details = {}) {
    return new StandardError('NETWORK_ERROR', message, details)
  }
  
  static createValidationError(field, message, details = {}) {
    return new StandardError('VALIDATION_FAILED', message, { field, ...details })
  }
  
  static createStorageError(operation, message, details = {}) {
    return new StandardError('STORAGE_ERROR', message, { operation, ...details })
  }
  
  // åŒ…è£æ—¢æœ‰çš„ try-catch çµæ§‹
  static async tryOperation(operation, errorCode = 'OPERATION_FAILED') {
    try {
      const result = await operation()
      return OperationResult.success(result)
    } catch (error) {
      const standardError = new StandardError(
        errorCode, 
        error.message || 'Operation failed',
        { originalError: error.toString() }
      )
      return OperationResult.failure(standardError)
    }
  }
  
  // åŒ…è£åŒæ­¥æ“ä½œ
  static trySync(operation, errorCode = 'OPERATION_FAILED') {
    try {
      const result = operation()
      return OperationResult.success(result)
    } catch (error) {
      const standardError = new StandardError(
        errorCode,
        error.message || 'Operation failed',
        { originalError: error.toString() }
      )
      return OperationResult.failure(standardError)
    }
  }
}
```

#### ä½¿ç”¨ç¯„ä¾‹å’Œæ•´åˆæ–¹å¼

**æ›¿æ› console.log çš„æ¨™æº–åšæ³•**ï¼š
```javascript
// ä¹‹å‰çš„åšæ³•
console.log('Book extracted successfully', bookData)
console.error('Validation failed:', error)

// æ–°çš„åšæ³•
const logger = createLogger('BookExtraction')
logger.info('OPERATION_COMPLETE', { type: 'book_extraction', bookData })
logger.error('VALIDATION_FAILED', { error: error.message })
```

**çµ±ä¸€éŒ¯èª¤è™•ç†çš„æ¨™æº–åšæ³•**ï¼š
```javascript
// ä¹‹å‰çš„åšæ³•
function extractBookData(url) {
  try {
    const data = fetchBookData(url)
    if (!data) {
      throw new Error('No data found')
    }
    return { success: true, data }
  } catch (error) {
    return { success: false, error: error.message }
  }
}

// æ–°çš„åšæ³•
async function extractBookData(url) {
  return await ErrorHelper.tryOperation(async () => {
    const data = await fetchBookData(url)
    if (!data) {
      throw ErrorHelper.createValidationError('data', 'No data found', { url })
    }
    return data
  }, 'BOOK_EXTRACTION_FAILED')
}
```

**æ¸¬è©¦çš„æ¨™æº–åšæ³•**ï¼š
```javascript
// ä¹‹å‰çš„å­—ä¸²æ¯”å°ï¼ˆä¸ç©©å®šï¼‰
test('should handle extraction error', async () => {
  const result = await extractBookData('invalid-url')
  expect(result.success).toBe(false)
  expect(result.error).toContain('No data found')
})

// æ–°çš„çµæ§‹åŒ–é©—è­‰ï¼ˆç©©å®šï¼‰
test('should handle extraction error', async () => {
  const result = await extractBookData('invalid-url')
  expect(result.isFailure).toBe(true)
  expect(result.error.code).toBe('BOOK_EXTRACTION_FAILED')
  expect(result.error.details.url).toBe('invalid-url')
})
```

### 3. é‚Šç•Œæ¢ä»¶åˆ†æéšæ®µ âœ…

#### æ¥µç«¯è¼¸å…¥æƒ…æ³

**ç©ºå€¼å’Œç„¡æ•ˆå€¼è™•ç†**ï¼š
- `code` ç‚ºç©ºï¼šä½¿ç”¨ 'UNKNOWN_ERROR' ä½œç‚ºé è¨­
- `message` ç‚ºç©ºï¼šå¾è¨Šæ¯å­—å…¸ç²å–é è¨­è¨Šæ¯
- `details` ç‚ºéç‰©ä»¶ï¼šè½‰æ›ç‚º `{ value: details }`
- å¾ªç’°åƒç…§ç‰©ä»¶ï¼šä½¿ç”¨ JSON.stringify çš„ replacer è™•ç†

**è¨˜æ†¶é«”é™åˆ¶è™•ç†**ï¼š
- `details` ç‰©ä»¶éå¤§ï¼šé™åˆ¶åºåˆ—åŒ–å¾Œå¤§å° < 10KB
- æ—¥èªŒè¨Šæ¯éå¤šï¼šå¯¦ä½œç°¡å–®çš„ç’°å½¢ç·©è¡å€
- å­—å…¸å¤§å°ï¼šé™åˆ¶ç¸½å¤§å° < 100KB

**æ•ˆèƒ½é‚Šç•Œ**ï¼š
- éŒ¯èª¤å»ºç«‹æ™‚é–“ï¼šç›®æ¨™ < 1msï¼Œä¸Šé™ 5ms
- æ—¥èªŒè¼¸å‡ºæ™‚é–“ï¼šç›®æ¨™ < 0.5msï¼Œä¸Šé™ 2ms
- è¨˜æ†¶é«”ä½¿ç”¨ï¼šç›®æ¨™ < 200KBï¼Œä¸Šé™ 500KB

#### ç³»çµ±é™åˆ¶èˆ‡é™ç´šç­–ç•¥

**è¨Šæ¯å­—å…¸è¼‰å…¥å¤±æ•—**ï¼š
- é™ç´šåˆ°å…§å»ºçš„æœ€å°è¨Šæ¯é›†
- è¨˜éŒ„è­¦å‘Šä½†ä¸é˜»å¡ç¨‹å¼åŸ·è¡Œ
- ä½¿ç”¨éŒ¯èª¤ä»£ç¢¼æœ¬èº«ä½œç‚ºè¨Šæ¯

**JSONåºåˆ—åŒ–å¤±æ•—**ï¼š
- ä½¿ç”¨ç°¡åŒ–çš„ç‰©ä»¶è¡¨ç¤ºæ³•
- ç§»é™¤å¾ªç’°åƒç…§
- é™åˆ¶åµŒå¥—æ·±åº¦ < 5å±¤

**è¨˜æ†¶é«”ä¸è¶³æƒ…æ³**ï¼š
- æ¸…ç©ºæ—¥èªŒç·©è¡å€
- ä½¿ç”¨æœ€ç°¡è¨Šæ¯æ ¼å¼
- é™ç´šåˆ°åŸºæœ¬ console è¼¸å‡º

#### éŒ¯èª¤è™•ç†çš„éŒ¯èª¤è™•ç†

**é¿å…ç„¡çª®è¿´åœˆ**ï¼š
```javascript
class SafeErrorHandler {
  static handleCriticalError(error) {
    // æœ€å¾Œé˜²ç·šï¼šä½¿ç”¨æœ€ç°¡å–®çš„éŒ¯èª¤è™•ç†
    try {
      console.error('[CRITICAL]', {
        timestamp: new Date().toISOString(),
        message: error.message || 'Critical system error',
        stack: error.stack
      })
    } catch (e) {
      // çµ•å°çš„æœ€å¾Œé˜²ç·š
      alert('Critical system error - please refresh page')
    }
  }
  
  static wrapOperation(operation) {
    try {
      return operation()
    } catch (error) {
      this.handleCriticalError(error)
      return OperationResult.failure(
        new StandardError('CRITICAL_ERROR', 'System error', { error: error.toString() })
      )
    }
  }
}
```

### 4. API/ä»‹é¢è¨­è¨ˆéšæ®µ âœ…

#### æ¨¡çµ„åŒ¯å‡ºçµæ§‹

**src/core/errors/index.js**ï¼š
```javascript
export { StandardError } from './StandardError.js'
export { OperationResult } from './OperationResult.js'
export { ErrorHelper } from './ErrorHelper.js'

// å¸¸ç”¨éŒ¯èª¤ä»£ç¢¼
export const ErrorCodes = {
  VALIDATION_FAILED: 'VALIDATION_FAILED',
  NETWORK_ERROR: 'NETWORK_ERROR',
  STORAGE_ERROR: 'STORAGE_ERROR',
  PERMISSION_DENIED: 'PERMISSION_DENIED',
  UNKNOWN_ERROR: 'UNKNOWN_ERROR'
}
```

**src/core/logging/index.js**ï¼š
```javascript
export { Logger } from './Logger.js'
export { createLogger } from './Logger.js'

// é è¨­æ—¥èªŒç­‰ç´š
export const LogLevels = {
  DEBUG: 'DEBUG',
  INFO: 'INFO',
  WARN: 'WARN',
  ERROR: 'ERROR'
}
```

**src/core/messages/index.js**ï¼š
```javascript
export { MessageDictionary } from './MessageDictionary.js'
export { GlobalMessages } from './MessageDictionary.js'

// å¸¸ç”¨è¨Šæ¯éµå€¼
export const MessageKeys = {
  SUCCESS: 'SUCCESS',
  FAILED: 'FAILED',
  LOADING: 'LOADING',
  PROCESSING: 'PROCESSING',
  OPERATION_COMPLETE: 'OPERATION_COMPLETE'
}
```

#### æ•´åˆç¾æœ‰ç³»çµ±çš„ä»‹é¢

**Chrome Extension æ•´åˆ**ï¼š
```javascript
// Background Script æ•´åˆ
class BackgroundErrorManager {
  constructor() {
    this.logger = createLogger('Background')
    this.errorHistory = []
  }
  
  handleError(error, context = {}) {
    const standardError = error instanceof StandardError 
      ? error 
      : ErrorHelper.createError('BACKGROUND_ERROR', error.message, context)
    
    this.errorHistory.push(standardError)
    this.logger.error('BACKGROUND_ERROR', { error: standardError.toJSON() })
    
    // é€šçŸ¥å…¶ä»–ç’°å¢ƒï¼ˆå¦‚æœéœ€è¦ï¼‰
    if (standardError.code === 'CRITICAL_ERROR') {
      chrome.runtime.sendMessage({
        type: 'ERROR_NOTIFICATION',
        error: standardError.toJSON()
      })
    }
    
    return OperationResult.failure(standardError)
  }
}
```

**æ¸¬è©¦æ¡†æ¶æ•´åˆ**ï¼š
```javascript
// æ¸¬è©¦è¼”åŠ©å‡½æ•¸
export class TestHelper {
  // é©—è­‰ OperationResult
  static expectSuccess(result, expectedData = undefined) {
    expect(result).toBeInstanceOf(OperationResult)
    expect(result.isSuccess).toBe(true)
    if (expectedData !== undefined) {
      expect(result.data).toEqual(expectedData)
    }
  }
  
  static expectFailure(result, expectedCode = undefined) {
    expect(result).toBeInstanceOf(OperationResult)
    expect(result.isFailure).toBe(true)
    expect(result.error).toBeInstanceOf(StandardError)
    if (expectedCode) {
      expect(result.error.code).toBe(expectedCode)
    }
  }
  
  // å»ºç«‹æ¸¬è©¦éŒ¯èª¤
  static createTestError(code = 'TEST_ERROR', message = 'Test error') {
    return new StandardError(code, message, { test: true })
  }
}
```

#### èˆ‡ç¾æœ‰ç¨‹å¼ç¢¼çš„ç›¸å®¹æ€§

**æ¼¸é€²å¼é·ç§»ç­–ç•¥**ï¼š
```javascript
// éæ¸¡æœŸé©é…å™¨
class LegacyAdapter {
  // å°‡èˆŠæ ¼å¼è½‰æ›ç‚ºæ–°æ ¼å¼
  static adaptLegacyError(legacyError) {
    if (legacyError instanceof StandardError) {
      return legacyError
    }
    
    // åˆ†æèˆŠéŒ¯èª¤æ ¼å¼
    let code = 'LEGACY_ERROR'
    let message = 'Legacy error'
    let details = {}
    
    if (typeof legacyError === 'string') {
      message = legacyError
    } else if (legacyError instanceof Error) {
      message = legacyError.message
      details.stack = legacyError.stack
    } else if (legacyError && legacyError.message) {
      message = legacyError.message
      details = { ...legacyError }
      delete details.message
    }
    
    return new StandardError(code, message, details)
  }
  
  // å°‡æ–°æ ¼å¼è½‰æ›ç‚ºèˆŠæ ¼å¼ï¼ˆå‘ä¸‹ç›¸å®¹ï¼‰
  static toLegacyFormat(standardError) {
    return {
      message: standardError.message,
      code: standardError.code,
      details: standardError.details,
      timestamp: standardError.timestamp
    }
  }
}
```

### 5. é©—æ”¶æ¨™æº–åˆ¶å®šéšæ®µ âœ…

#### åŠŸèƒ½æ­£ç¢ºæ€§é©—è­‰

**åŸºç¤çµ„ä»¶é©—è­‰**ï¼š
- [ ] StandardError å¯ä»¥æ­£ç¢ºå»ºç«‹ã€åºåˆ—åŒ–ã€ååºåˆ—åŒ–
- [ ] OperationResult å¯ä»¥æ­£ç¢ºå€åˆ†æˆåŠŸ/å¤±æ•—ç‹€æ…‹
- [ ] MessageDictionary å¯ä»¥æ­£ç¢ºå„²å­˜å’Œæª¢ç´¢è¨Šæ¯
- [ ] Logger å¯ä»¥æ­£ç¢ºè¼¸å‡ºä¸åŒç­‰ç´šçš„æ—¥èªŒ
- [ ] ErrorHelper å·¥å» å‡½æ•¸å¯ä»¥å»ºç«‹æ¨™æº–åŒ–éŒ¯èª¤

**æ•´åˆåŠŸèƒ½é©—è­‰**ï¼š
- [ ] console.log æ›¿æ›ï¼šæ‰€æœ‰ console.log éƒ½æ›¿æ›ç‚º Logger
- [ ] éŒ¯èª¤è™•ç†çµ±ä¸€ï¼šæ‰€æœ‰éŒ¯èª¤è™•ç†ä½¿ç”¨ OperationResult æ ¼å¼
- [ ] æ–‡å­—é›†ä¸­ç®¡ç†ï¼šæ‰€æœ‰ç¡¬ç·¨ç¢¼æ–‡å­—ç§»è‡³ MessageDictionary
- [ ] æ¸¬è©¦çµæ§‹åŒ–ï¼šæ‰€æœ‰æ¸¬è©¦ä½¿ç”¨çµæ§‹åŒ–é©—è­‰è€Œéå­—ä¸²æ¯”å°

**ç³»çµ±æ•´åˆé©—è­‰**ï¼š
- [ ] Chrome Extension ç’°å¢ƒï¼šBackground/Content/Popup éƒ½å¯æ­£å¸¸ä½¿ç”¨
- [ ] ç¾æœ‰ç¨‹å¼ç¢¼ç›¸å®¹ï¼šä¸ç ´å£ç¾æœ‰åŠŸèƒ½
- [ ] æ•ˆèƒ½ç¬¦åˆè¦æ±‚ï¼šè¨˜æ†¶é«” < 500KBï¼Œè™•ç†æ™‚é–“ < 5ms
- [ ] é™ç´šæ©Ÿåˆ¶ï¼šç•°å¸¸æƒ…æ³ä¸‹èƒ½æ­£å¸¸é™ç´š

#### æ•ˆèƒ½è¦æ±‚ï¼ˆå¯é”æˆç›®æ¨™ï¼‰

**è¨˜æ†¶é«”ä½¿ç”¨è¦æ±‚**ï¼š
- åŸºç¤ç³»çµ±è¨˜æ†¶é«”å ç”¨ï¼š< 200KB
- å–®ä¸€éŒ¯èª¤ç‰©ä»¶å¤§å°ï¼š< 1KB
- æ—¥èªŒç·©è¡å€å¤§å°ï¼š< 100KB
- è¨Šæ¯å­—å…¸å¤§å°ï¼š< 100KB
- **ç¸½è¨ˆè¨˜æ†¶é«”é™åˆ¶ï¼š< 500KB**

**è™•ç†æ™‚é–“è¦æ±‚**ï¼š
- éŒ¯èª¤ç‰©ä»¶å»ºç«‹ï¼š< 1ms
- æ—¥èªŒè¼¸å‡ºï¼š< 1ms
- è¨Šæ¯å­—å…¸æŸ¥è©¢ï¼š< 0.1ms
- OperationResult å»ºç«‹ï¼š< 0.5ms
- **ç³»çµ±å›æ‡‰æ™‚é–“ï¼š< 5ms**

**ä½µç™¼è™•ç†è¦æ±‚**ï¼š
- åŒæ™‚è™•ç†éŒ¯èª¤æ•¸é‡ï¼š< 50å€‹
- æ—¥èªŒè¼¸å‡ºä½‡åˆ—å¤§å°ï¼š< 100å€‹
- è¨Šæ¯å­—å…¸ä½µç™¼è®€å–ï¼šç„¡é™åˆ¶
- **ä¸¦ç™¼è™•ç†ç„¡æ•ˆèƒ½ç“¶é ¸**

#### ä½¿ç”¨è€…é«”é©—æ¨™æº–ï¼ˆå·¥ç¨‹å¸«é«”é©—ï¼‰

**å­¸ç¿’æ›²ç·š**ï¼š
- æ–°å·¥ç¨‹å¸«ç†è§£ç³»çµ±ï¼š< 30åˆ†é˜
- ç¬¬ä¸€æ¬¡ä½¿ç”¨æˆåŠŸï¼š< 5åˆ†é˜
- API è¨˜æ†¶è² æ“”ï¼š< 10å€‹ä¸»è¦æ–¹æ³•
- éŒ¯èª¤è¨Šæ¯æ¸…æ™°åº¦ï¼š90%æ¸…æ¥šæ˜ç™½

**é–‹ç™¼æ•ˆç‡**ï¼š
- éŒ¯èª¤è™•ç†ç¨‹å¼ç¢¼æ¸›å°‘ï¼š50%
- æ¸¬è©¦ç·¨å¯«æ™‚é–“æ¸›å°‘ï¼š40%
- é™¤éŒ¯æ™‚é–“æ¸›å°‘ï¼š60%
- ç¶­è­·å·¥ä½œé‡æ¸›å°‘ï¼š70%

**ç¨‹å¼ç¢¼å“è³ªæ”¹å–„**ï¼š
- Lint éŒ¯èª¤æ¸›å°‘ï¼š97% (3760 â†’ <100)
- æ¸¬è©¦ç©©å®šæ€§ï¼š100%é€šéç‡
- ç¨‹å¼ç¢¼é‡è¤‡æ¸›å°‘ï¼š80%
- æ–‡ä»¶åŒ–ç¨‹åº¦æå‡ï¼š90%

#### ç¶­è­·æ€§æ¨™æº–

**å¯ç¶­è­·æ€§**ï¼š
- æ–°å¢éŒ¯èª¤é¡å‹ï¼š< 5åˆ†é˜
- æ–°å¢æ—¥èªŒè¨Šæ¯ï¼š< 2åˆ†é˜
- ä¿®æ”¹éŒ¯èª¤è¨Šæ¯ï¼š< 1åˆ†é˜
- ç³»çµ±å‡ç´šç›¸å®¹æ€§ï¼š100%

**å¯æ“´å±•æ€§**ï¼š
- æ”¯æ´æ–°ç’°å¢ƒï¼šè¨­è¨ˆå·²é ç•™ä»‹é¢
- æ”¯æ´æ–°åŠŸèƒ½ï¼šæ¨¡çµ„åŒ–è¨­è¨ˆä¾¿æ–¼æ“´å±•
- æ”¯æ´å¤šèªç³»ï¼šå­—å…¸ç³»çµ±å·²æº–å‚™
- æ”¯æ´è¤‡é›œéŒ¯èª¤ï¼šåŸºç¤æ¶æ§‹å¯æ“´å±•

**å¯æ¸¬è©¦æ€§**ï¼š
- å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ï¼š> 90%
- æ•´åˆæ¸¬è©¦è¦†è“‹ç‡ï¼š> 80%
- æ¸¬è©¦åŸ·è¡Œæ™‚é–“ï¼š< 10ç§’
- æ¸¬è©¦ç©©å®šæ€§ï¼š100%å¯é‡è¤‡

---

## ğŸ“‹ äº¤æ¥çµ¦ sage-test-architect çš„æª¢æŸ¥é»

### TDD Phase 1 ç°¡åŒ–è¨­è¨ˆå®Œæ•´æ€§ç¢ºèª âœ…

- [x] **åŠŸèƒ½éœ€æ±‚æ¸…æ¥šä¸”å…·é«”**: é‡æ–°èšç„¦æ–¼è§£æ±ºç•¶å‰å¯¦éš›å•é¡Œï¼ˆ3760å€‹lintå•é¡Œã€æ¸¬è©¦å¤±æ•—ã€æ–‡å­—ä¸çµ±ä¸€ï¼‰
- [x] **APIä»‹é¢å®šç¾©å®Œæ•´**: è¨­è¨ˆäº†4å€‹æ ¸å¿ƒçµ„ä»¶çš„å®Œæ•´APIä»‹é¢å’Œä½¿ç”¨ç¯„ä¾‹
- [x] **é‚Šç•Œæ¢ä»¶å…¨é¢è­˜åˆ¥**: åˆ†æäº†æ¥µç«¯è¼¸å…¥ã€è¨˜æ†¶é«”é™åˆ¶ã€æ•ˆèƒ½é‚Šç•Œå’Œé™ç´šç­–ç•¥
- [x] **é©—æ”¶æ¨™æº–æ˜ç¢ºå¯é©—è­‰**: åˆ¶å®šäº†åŠŸèƒ½ã€æ•ˆèƒ½ã€ä½¿ç”¨è€…é«”é©—ã€ç¶­è­·æ€§çš„å…·é«”é©—è­‰æ¨™æº–

### ç°¡åŒ–ç‰ˆç³»çµ±è¨­è¨ˆäº¤ä»˜ç‰© âœ…

**æ ¸å¿ƒçµ„ä»¶è¨­è¨ˆï¼ˆæœ€å°å¯è¡Œç‰ˆæœ¬ï¼‰**ï¼š
- [x] **StandardError**: çµ±ä¸€éŒ¯èª¤æ ¼å¼ï¼Œæ”¯æ´åºåˆ—åŒ–å’ŒJSONè½‰æ›
- [x] **OperationResult**: æ¨™æº–åŒ–æˆåŠŸ/å¤±æ•—å›æ‡‰æ ¼å¼ï¼Œçµæ§‹åŒ–é©—è­‰
- [x] **MessageDictionary**: é›†ä¸­åŒ–æ–‡å­—ç®¡ç†ï¼Œæ”¯æ´åƒæ•¸æ’å€¼
- [x] **Logger**: çµ±ä¸€æ—¥èªŒç³»çµ±ï¼Œæ›¿æ›æ‰€æœ‰console.log
- [x] **ErrorHelper**: éŒ¯èª¤è™•ç†è¼”åŠ©å‡½æ•¸ï¼Œç°¡åŒ–å¸¸è¦‹éŒ¯èª¤è™•ç†

**å¯¦ç”¨æ•´åˆæ–¹æ¡ˆ**ï¼š
- [x] **Chrome Extensionæ•´åˆ**: Backgroundç’°å¢ƒçš„éŒ¯èª¤ç®¡ç†å™¨
- [x] **æ¸¬è©¦æ¡†æ¶æ•´åˆ**: çµæ§‹åŒ–æ¸¬è©¦è¼”åŠ©å‡½æ•¸
- [x] **ç¾æœ‰ç¨‹å¼ç¢¼ç›¸å®¹**: æ¼¸é€²å¼é·ç§»ç­–ç•¥å’Œé©é…å™¨
- [x] **ä½¿ç”¨ç¯„ä¾‹**: å®Œæ•´çš„before/afterç¨‹å¼ç¢¼ç¯„ä¾‹

**å‹™å¯¦è¨­è¨ˆç‰¹è‰²**ï¼š
- [x] **ç«‹å³å¯ç”¨**: 30åˆ†é˜å­¸æœƒï¼Œ5åˆ†é˜ä¸Šæ‰‹
- [x] **è¨˜æ†¶é«”å‹å–„**: <500KBç¸½ä½¿ç”¨é‡ï¼Œç¬¦åˆChrome Extensioné™åˆ¶
- [x] **æ•ˆèƒ½å¯¦éš›**: <5msè™•ç†æ™‚é–“ï¼Œå¯å¯¦éš›é”æˆçš„ç›®æ¨™
- [x] **é¿å…éåº¦è¨­è¨ˆ**: å°ˆæ³¨è§£æ±ºå¯¦éš›å•é¡Œï¼Œç‚ºæœªä¾†æ“´å±•å¥ å®šåŸºç¤

### æ¥­å‹™åƒ¹å€¼èˆ‡æŠ€è¡“å¯è¡Œæ€§ âœ…

**ç«‹å³è§£æ±ºçš„å•é¡Œ**ï¼š
1. **3760å€‹ lint å•é¡Œ**: çµ±ä¸€æ—¥èªŒç³»çµ±æ›¿æ›æ‰€æœ‰console.log
2. **æ¸¬è©¦å¤±æ•—**: çµæ§‹åŒ–é©—è­‰æ›¿ä»£ä¸ç©©å®šçš„å­—ä¸²æ¯”å°
3. **æ–‡å­—ä¸çµ±ä¸€**: é›†ä¸­åŒ–è¨Šæ¯å­—å…¸ç®¡ç†
4. **ç¼ºä¹éŒ¯èª¤æ¨™æº–**: çµ±ä¸€çš„éŒ¯èª¤è™•ç†å’Œå›æ‡‰æ ¼å¼

**æŠ€è¡“å¯è¡Œæ€§ä¿è­‰**ï¼š
1. **ç°¡å–®è¨­è¨ˆ**: 4å€‹æ ¸å¿ƒé¡åˆ¥ï¼Œ10å€‹ä¸»è¦æ–¹æ³•ï¼Œå­¸ç¿’æˆæœ¬ä½
2. **æ•ˆèƒ½å¯é”**: è¨˜æ†¶é«”<500KBï¼Œè™•ç†<5msçš„å¯¦éš›å¯é”æˆç›®æ¨™
3. **æ¼¸é€²å¯¦ä½œ**: å¯èˆ‡ç¾æœ‰ç¨‹å¼ç¢¼ä¸¦å­˜ï¼Œé€æ­¥é·ç§»
4. **æ“´å±•é ç•™**: åŸºç¤æ¶æ§‹ç‚ºæœªä¾†è¤‡é›œéœ€æ±‚é ç•™æ“´å±•ç©ºé–“

**é æœŸæ•ˆç›Šï¼ˆä¿å®ˆä¼°ç®—ï¼‰**ï¼š
- Lintå•é¡Œæ¸›å°‘97%ï¼ˆ3760â†’<100ï¼‰
- æ¸¬è©¦é€šéç‡æå‡è‡³100%
- é–‹ç™¼æ•ˆç‡æå‡40%
- ç¶­è­·æˆæœ¬é™ä½60%

**è¨­è¨ˆè¤‡é›œåº¦è©•ä¼°**: ä½-ä¸­ - ç°¡å–®è¨­è¨ˆä½†å®Œæ•´åŠŸèƒ½

---

## ğŸ¯ ä¸‹ä¸€éšæ®µï¼šsage-test-architect TDD Phase 2

### ç°¡åŒ–ç‰ˆéŒ¯èª¤è™•ç†æ©Ÿåˆ¶è¨­è¨ˆæ‘˜è¦

**ç³»çµ±å®šä½**: ç«‹å³å¯å¯¦ä½œçš„çµ±ä¸€éŒ¯èª¤è™•ç†åŸºç¤è¨­æ–½  
**æ ¸å¿ƒåƒ¹å€¼**: è§£æ±ºç•¶å‰å¯¦éš›å•é¡Œï¼Œå»ºç«‹åœ˜éšŠå”ä½œæ¨™æº–ï¼Œç‚ºæœªä¾†æ“´å±•å¥ å®šåŸºç¤  
**æŠ€è¡“ç‰¹è‰²**: ç°¡å–®å¯¦ç”¨ã€æ•ˆèƒ½å‹å–„ã€æ˜“æ–¼å­¸ç¿’ã€å®Œå…¨ç›¸å®¹  
**å¯¦ä½œç­–ç•¥**: æ¼¸é€²å¼é·ç§»ã€ä¸¦è¡Œé–‹ç™¼ã€çµæ§‹åŒ–æ¸¬è©¦

### é—œéµè¨­è¨ˆäº®é»

1. **å‹™å¯¦ä¸»ç¾©**: å°ˆæ³¨è§£æ±ºå¯¦éš›å•é¡Œï¼Œé¿å…éåº¦è¨­è¨ˆé™·é˜±
2. **ç°¡å–®æ˜“ç”¨**: 30åˆ†é˜å­¸æœƒï¼Œ5åˆ†é˜ä¸Šæ‰‹ï¼Œ10å€‹æ ¸å¿ƒæ–¹æ³•
3. **æ•ˆèƒ½å‹å–„**: è¨˜æ†¶é«”<500KBï¼Œè™•ç†<5msçš„å¯¦éš›å¯é”æˆç›®æ¨™
4. **æ¼¸é€²å¯¦ä½œ**: èˆ‡ç¾æœ‰ç¨‹å¼ç¢¼å®Œå…¨ç›¸å®¹ï¼Œæ”¯æ´é€æ­¥é·ç§»
5. **æ“´å±•æº–å‚™**: ç°¡å–®çš„åŸºç¤æ¶æ§‹ç‚ºæœªä¾†è¤‡é›œéœ€æ±‚é ç•™ç©ºé–“

### ç«‹å³è¡Œå‹•è¨ˆç•«

**Phase 2 æ¸¬è©¦è¨­è¨ˆé‡é»**ï¼š
1. æ ¸å¿ƒçµ„ä»¶çš„å–®å…ƒæ¸¬è©¦ï¼ˆStandardError, OperationResult, Logger, MessageDictionaryï¼‰
2. æ•´åˆæ¸¬è©¦ï¼ˆæ›¿æ›console.log, çµ±ä¸€éŒ¯èª¤è™•ç†ï¼‰
3. æ•ˆèƒ½æ¸¬è©¦ï¼ˆè¨˜æ†¶é«”ä½¿ç”¨<500KB, è™•ç†æ™‚é–“<5msï¼‰
4. ç›¸å®¹æ€§æ¸¬è©¦ï¼ˆèˆ‡ç¾æœ‰ç¨‹å¼ç¢¼çš„ç›¸å®¹æ€§ï¼‰

**TDD Phase 1 ç°¡åŒ–è¨­è¨ˆå®Œæˆï¼Œæº–å‚™é€²å…¥ sage-test-architect TDD Phase 2 æ¸¬è©¦è¨­è¨ˆéšæ®µã€‚**

---

## ğŸ§ª TDD Phase 2: æ¸¬è©¦æ¡ˆä¾‹è¨­è¨ˆ

**é–‹ç™¼æ—¥æœŸ**: 2025-09-03  
**æ¸¬è©¦è¨­è¨ˆå¸«**: sage-test-architect (TDD æ¸¬è©¦è¨­è¨ˆå°ˆå®¶)  
**éšæ®µ**: TDD Phase 2 - æ¸¬è©¦æ¡ˆä¾‹è¨­è¨ˆéšæ®µ  

### 1. æ¸¬è©¦ç­–ç•¥è¦åŠƒ âœ…

#### æ ¸å¿ƒæ¸¬è©¦ç­–ç•¥åˆ†æ

**åŸºæ–¼åŠŸèƒ½è¨­è¨ˆçš„æ¸¬è©¦ç­–ç•¥è¦åŠƒ**ï¼š
- **å–®å…ƒæ¸¬è©¦ç­–ç•¥**: é‡å°5å€‹æ ¸å¿ƒçµ„ä»¶è¨­è¨ˆç¨ç«‹æ¸¬è©¦
- **æ•´åˆæ¸¬è©¦ç­–ç•¥**: é‡é»æ¸¬è©¦console.logæ›¿æ›å’Œç¾æœ‰ç³»çµ±æ•´åˆ
- **æ•ˆèƒ½æ¸¬è©¦ç­–ç•¥**: è¨˜æ†¶é«”<500KBã€è™•ç†æ™‚é–“<5msçš„åŸºæº–æ¸¬è©¦  
- **ç›¸å®¹æ€§æ¸¬è©¦ç­–ç•¥**: Chrome Extensionç’°å¢ƒå’Œç¾æœ‰ç¨‹å¼ç¢¼ç›¸å®¹æ€§

**æ¸¬è©¦è¦†è“‹å„ªå…ˆç´š**ï¼š
1. **é«˜å„ªå…ˆç´š**: StandardErrorã€OperationResultã€Loggerï¼ˆè§£æ±º3760å€‹lintå•é¡Œï¼‰
2. **ä¸­å„ªå…ˆç´š**: MessageDictionaryï¼ˆçµ±ä¸€æ–‡å­—ç®¡ç†ï¼‰
3. **ä½å„ªå…ˆç´š**: ErrorHelperï¼ˆè¼”åŠ©å‡½æ•¸å’Œä¾¿åˆ©æ–¹æ³•ï¼‰

**æ¸¬è©¦è‡ªå‹•åŒ–å·¥å…·éœ€æ±‚**ï¼š
- Jestæ¡†æ¶ï¼ˆå·²é…ç½®ï¼‰
- Chrome APIs Mockï¼ˆå·²å­˜åœ¨jest-chromeï¼‰
- æ•ˆèƒ½æ¸¬è©¦å·¥å…·ï¼ˆè‡ªè¨‚è¨ˆæ™‚å™¨å’Œè¨˜æ†¶é«”ç›£æ§ï¼‰
- æ•´åˆæ¸¬è©¦ç’°å¢ƒï¼ˆä½¿ç”¨ç¾æœ‰E2ETestSuiteï¼‰

#### æ¸¬è©¦é‚Šç•Œæ¢ä»¶è­˜åˆ¥

**å–®å…ƒæ¸¬è©¦é‚Šç•Œ**ï¼š
- å„çµ„ä»¶ç¨ç«‹æ€§æ¸¬è©¦ï¼ˆç„¡å¤–éƒ¨ä¾è³´ï¼‰
- Mockç‰©ä»¶æ›¿æ›å…¨å±€ä¾è³´ï¼ˆå¦‚Date.nowã€Math.randomï¼‰
- éŒ¯èª¤è™•ç†çš„éŒ¯èª¤è™•ç†æ¸¬è©¦ï¼ˆé¿å…ç„¡é™è¿´åœˆï¼‰

**æ•´åˆæ¸¬è©¦é‚Šç•Œ**ï¼š
- èˆ‡ç¾æœ‰StorageAPIValidatorçš„æ•´åˆ
- Chrome ExtensionèƒŒæ™¯è…³æœ¬æ•´åˆ
- è·¨æ¨¡çµ„éŒ¯èª¤å‚³éæ¸¬è©¦

### 2. å…·é«”æ¸¬è©¦æ¡ˆä¾‹è¨­è¨ˆ âœ…

#### StandardError é¡åˆ¥æ¸¬è©¦è¨­è¨ˆ

**æ­£å¸¸æµç¨‹æ¸¬è©¦**ï¼š
```javascript
describe('StandardError æ ¸å¿ƒåŠŸèƒ½', () => {
  test('æ‡‰è©²æ­£ç¢ºå»ºç«‹æ¨™æº–éŒ¯èª¤ç‰©ä»¶', () => {
    // Given: åŸºæœ¬éŒ¯èª¤åƒæ•¸
    const code = 'TEST_ERROR'
    const message = 'æ¸¬è©¦éŒ¯èª¤è¨Šæ¯'
    const details = { field: 'testField', value: 'testValue' }
    
    // When: å»ºç«‹StandardErrorå¯¦ä¾‹
    const error = new StandardError(code, message, details)
    
    // Then: é©—è­‰éŒ¯èª¤ç‰©ä»¶çµæ§‹
    expect(error.code).toBe(code)
    expect(error.message).toBe(message)
    expect(error.details).toEqual(details)
    expect(error.timestamp).toBeGreaterThan(Date.now() - 1000)
    expect(error.id).toMatch(/^err_\d+_[a-z0-9]{9}$/)
  })
  
  test('æ‡‰è©²æ”¯æ´JSONåºåˆ—åŒ–å’Œååºåˆ—åŒ–', () => {
    // Given: åŸå§‹éŒ¯èª¤ç‰©ä»¶
    const originalError = new StandardError('SERIALIZE_TEST', 'åºåˆ—åŒ–æ¸¬è©¦', { test: true })
    
    // When: åŸ·è¡ŒJSONè½‰æ›
    const json = originalError.toJSON()
    const restoredError = StandardError.fromJSON(json)
    
    // Then: é©—è­‰åºåˆ—åŒ–å®Œæ•´æ€§
    expect(restoredError.code).toBe(originalError.code)
    expect(restoredError.message).toBe(originalError.message)
    expect(restoredError.details).toEqual(originalError.details)
    expect(restoredError.timestamp).toBe(originalError.timestamp)
    expect(restoredError.id).toBe(originalError.id)
  })
})
```

**é‚Šç•Œæ¢ä»¶æ¸¬è©¦**ï¼š
```javascript
describe('StandardError é‚Šç•Œæ¢ä»¶', () => {
  test('æ‡‰è©²è™•ç†ç©ºå€¼å’Œç„¡æ•ˆåƒæ•¸', () => {
    // Given: ç©ºå€¼æˆ–ç„¡æ•ˆåƒæ•¸
    const scenarios = [
      { code: null, message: null, details: null },
      { code: '', message: '', details: undefined },
      { code: undefined, message: undefined, details: 'string' }
    ]
    
    scenarios.forEach(({ code, message, details }) => {
      // When: å»ºç«‹éŒ¯èª¤ç‰©ä»¶
      const error = new StandardError(code, message, details)
      
      // Then: é©—è­‰é è¨­å€¼è™•ç†
      expect(error.code).toBe(code || 'UNKNOWN_ERROR')
      expect(error.message).toBe(message || 'Unknown error')
      expect(typeof error.details).toBe('object')
    })
  })
  
  test('æ‡‰è©²è™•ç†å¾ªç’°åƒç…§çš„detailsç‰©ä»¶', () => {
    // Given: åŒ…å«å¾ªç’°åƒç…§çš„ç‰©ä»¶
    const circularObj = { name: 'test' }
    circularObj.self = circularObj
    
    // When: å»ºç«‹åŒ…å«å¾ªç’°åƒç…§çš„éŒ¯èª¤
    const error = new StandardError('CIRCULAR_TEST', 'å¾ªç’°åƒç…§æ¸¬è©¦', circularObj)
    
    // Then: JSONåºåˆ—åŒ–æ‡‰è©²æˆåŠŸï¼ˆä¸æ‹‹å‡ºç•°å¸¸ï¼‰
    expect(() => error.toJSON()).not.toThrow()
    const json = error.toJSON()
    expect(json.details).toBeDefined()
  })
  
  test('æ‡‰è©²é™åˆ¶detailsç‰©ä»¶å¤§å°', () => {
    // Given: è¶…å¤§çš„detailsç‰©ä»¶
    const largeDetails = {
      data: 'x'.repeat(20 * 1024) // 20KBè³‡æ–™
    }
    
    // When: å»ºç«‹åŒ…å«å¤§å‹è³‡æ–™çš„éŒ¯èª¤
    const error = new StandardError('LARGE_DETAILS_TEST', 'å¤§å‹è³‡æ–™æ¸¬è©¦', largeDetails)
    const json = JSON.stringify(error.toJSON())
    
    // Then: åºåˆ—åŒ–å¾Œå¤§å°æ‡‰è©²åˆç†
    expect(json.length).toBeLessThan(15 * 1024) // å°æ–¼15KB
  })
})
```

**ç•°å¸¸æƒ…æ³æ¸¬è©¦**ï¼š
```javascript
describe('StandardError ç•°å¸¸è™•ç†', () => {
  test('generateIdæ–¹æ³•åœ¨æ™‚é–“ç•°å¸¸æ™‚çš„è™•ç†', () => {
    // Given: Mock Date.now ç•°å¸¸
    const originalDateNow = Date.now
    Date.now = jest.fn(() => { throw new Error('Time error') })
    
    // When: å»ºç«‹éŒ¯èª¤ç‰©ä»¶
    expect(() => {
      new StandardError('TIME_ERROR_TEST', 'æ™‚é–“ç•°å¸¸æ¸¬è©¦')
    }).not.toThrow()
    
    // Then: æ¸…ç†Mock
    Date.now = originalDateNow
  })
})
```

#### OperationResult é¡åˆ¥æ¸¬è©¦è¨­è¨ˆ

**æ­£å¸¸æµç¨‹æ¸¬è©¦**ï¼š
```javascript
describe('OperationResult æ ¸å¿ƒåŠŸèƒ½', () => {
  test('æ‡‰è©²æ­£ç¢ºå»ºç«‹æˆåŠŸçµæœ', () => {
    // Given: æˆåŠŸæ“ä½œè³‡æ–™
    const testData = { books: [{ id: '1', title: 'Test Book' }] }
    
    // When: å»ºç«‹æˆåŠŸçµæœ
    const result = OperationResult.success(testData)
    
    // Then: é©—è­‰æˆåŠŸçµæœçµæ§‹
    expect(result.success).toBe(true)
    expect(result.isSuccess).toBe(true)
    expect(result.isFailure).toBe(false)
    expect(result.data).toEqual(testData)
    expect(result.error).toBeNull()
    expect(result.timestamp).toBeGreaterThan(Date.now() - 1000)
  })
  
  test('æ‡‰è©²æ­£ç¢ºå»ºç«‹å¤±æ•—çµæœ', () => {
    // Given: StandardErroréŒ¯èª¤ç‰©ä»¶
    const standardError = new StandardError('OPERATION_FAILED', 'æ“ä½œå¤±æ•—', { operation: 'test' })
    
    // When: å»ºç«‹å¤±æ•—çµæœ
    const result = OperationResult.failure(standardError)
    
    // Then: é©—è­‰å¤±æ•—çµæœçµæ§‹
    expect(result.success).toBe(false)
    expect(result.isFailure).toBe(true)
    expect(result.isSuccess).toBe(false)
    expect(result.data).toBeNull()
    expect(result.error).toBe(standardError)
  })
  
  test('æ‡‰è©²å°‡æ™®é€šErrorè½‰æ›ç‚ºStandardError', () => {
    // Given: æ™®é€šJavaScript Error
    const jsError = new Error('JavaScript error')
    
    // When: å»ºç«‹å¤±æ•—çµæœ
    const result = OperationResult.failure(jsError)
    
    // Then: éŒ¯èª¤æ‡‰è©²è¢«è½‰æ›ç‚ºStandardError
    expect(result.error).toBeInstanceOf(StandardError)
    expect(result.error.code).toBe('UNKNOWN_ERROR')
    expect(result.error.message).toBe('JavaScript error')
    expect(result.error.details.originalError).toBe(jsError)
  })
})
```

**é‚Šç•Œæ¢ä»¶æ¸¬è©¦**ï¼š
```javascript
describe('OperationResult é‚Šç•Œæ¢ä»¶', () => {
  test('throwIfFailureæ–¹æ³•æ‡‰è©²æ­£ç¢ºè™•ç†å¤±æ•—çµæœ', () => {
    // Given: å¤±æ•—çš„æ“ä½œçµæœ
    const error = new StandardError('THROW_TEST', 'Throwæ¸¬è©¦éŒ¯èª¤')
    const failureResult = OperationResult.failure(error)
    
    // When & Then: throwIfFailureæ‡‰è©²æ‹‹å‡ºç•°å¸¸
    expect(() => failureResult.throwIfFailure()).toThrow('Operation failed: Throwæ¸¬è©¦éŒ¯èª¤ (THROW_TEST)')
  })
  
  test('throwIfFailureæ–¹æ³•æ‡‰è©²è¿”å›æˆåŠŸçµæœçš„è³‡æ–™', () => {
    // Given: æˆåŠŸçš„æ“ä½œçµæœ
    const testData = { result: 'success' }
    const successResult = OperationResult.success(testData)
    
    // When: èª¿ç”¨throwIfFailure
    const returnedData = successResult.throwIfFailure()
    
    // Then: æ‡‰è©²è¿”å›è³‡æ–™ä¸æ‹‹å‡ºç•°å¸¸
    expect(returnedData).toEqual(testData)
  })
})
```

#### Logger ç³»çµ±æ¸¬è©¦è¨­è¨ˆ

**æ­£å¸¸æµç¨‹æ¸¬è©¦**ï¼š
```javascript
describe('Logger æ—¥èªŒç³»çµ±', () => {
  let consoleSpies
  let logger
  
  beforeEach(() => {
    // Mock consoleæ–¹æ³•
    consoleSpies = {
      debug: jest.spyOn(console, 'debug').mockImplementation(),
      info: jest.spyOn(console, 'info').mockImplementation(),
      warn: jest.spyOn(console, 'warn').mockImplementation(),
      error: jest.spyOn(console, 'error').mockImplementation()
    }
    logger = new Logger('TestLogger')
  })
  
  afterEach(() => {
    Object.values(consoleSpies).forEach(spy => spy.mockRestore())
  })
  
  test('æ‡‰è©²æ­£ç¢ºè¼¸å‡ºä¸åŒç­‰ç´šçš„æ—¥èªŒ', () => {
    // Given: æ¸¬è©¦è¨Šæ¯
    const messageKey = 'OPERATION_COMPLETE'
    const testData = { operation: 'test', duration: 100 }
    
    // When: è¼¸å‡ºä¸åŒç­‰ç´šæ—¥èªŒ
    logger.debug(messageKey, testData)
    logger.info(messageKey, testData)
    logger.warn(messageKey, testData)
    logger.error(messageKey, testData)
    
    // Then: é©—è­‰consoleæ–¹æ³•è¢«æ­£ç¢ºèª¿ç”¨
    expect(consoleSpies.debug).toHaveBeenCalled()
    expect(consoleSpies.info).toHaveBeenCalled()
    expect(consoleSpies.warn).toHaveBeenCalled()
    expect(consoleSpies.error).toHaveBeenCalled()
    
    // é©—è­‰æ—¥èªŒæ ¼å¼
    const lastInfoCall = consoleSpies.info.mock.calls[0]
    expect(lastInfoCall[0]).toBe('[INFO]')
    expect(lastInfoCall[1]).toMatchObject({
      level: 'INFO',
      name: 'TestLogger',
      message: expect.any(String),
      data: testData
    })
  })
  
  test('æ‡‰è©²æ ¹æ“šæ—¥èªŒç­‰ç´šéæ¿¾è¼¸å‡º', () => {
    // Given: è¨­å®šæ—¥èªŒç­‰ç´šç‚ºWARN
    logger.level = 'WARN'
    
    // When: è¼¸å‡ºä¸åŒç­‰ç´šæ—¥èªŒ
    logger.debug('DEBUG_MESSAGE')
    logger.info('INFO_MESSAGE') 
    logger.warn('WARN_MESSAGE')
    logger.error('ERROR_MESSAGE')
    
    // Then: åªæœ‰WARNå’ŒERRORç­‰ç´šçš„æ—¥èªŒè¢«è¼¸å‡º
    expect(consoleSpies.debug).not.toHaveBeenCalled()
    expect(consoleSpies.info).not.toHaveBeenCalled()
    expect(consoleSpies.warn).toHaveBeenCalled()
    expect(consoleSpies.error).toHaveBeenCalled()
  })
})
```

**console.logæ›¿æ›æ•´åˆæ¸¬è©¦**ï¼š
```javascript
describe('Logger console.logæ›¿æ›æ•´åˆ', () => {
  test('æ‡‰è©²æˆåŠŸæ›¿æ›ç¾æœ‰çš„console.logä½¿ç”¨', async () => {
    // Given: æ¨¡æ“¬ç¾æœ‰çš„console.logä½¿ç”¨æ¨¡å¼
    const consoleSpy = jest.spyOn(console, 'log').mockImplementation()
    const logger = createLogger('ConsoleReplacement')
    
    // æ¨¡æ“¬èˆŠçš„ä½¿ç”¨æ–¹å¼
    const oldUsage = () => {
      console.log('Book extracted successfully', { bookId: '123', title: 'Test Book' })
    }
    
    // æ–°çš„ä½¿ç”¨æ–¹å¼
    const newUsage = () => {
      logger.info('OPERATION_COMPLETE', { 
        type: 'book_extraction', 
        bookId: '123', 
        title: 'Test Book' 
      })
    }
    
    // When: åŸ·è¡Œæ–°èˆŠä½¿ç”¨æ–¹å¼
    oldUsage()
    newUsage()
    
    // Then: é©—è­‰console.logè¢«èª¿ç”¨ï¼ŒLoggerä½¿ç”¨structured logging
    expect(consoleSpy).toHaveBeenCalled()
    
    consoleSpy.mockRestore()
  })
})
```

#### MessageDictionary ç³»çµ±æ¸¬è©¦è¨­è¨ˆ

**æ­£å¸¸æµç¨‹æ¸¬è©¦**ï¼š
```javascript
describe('MessageDictionary è¨Šæ¯å­—å…¸', () => {
  let dictionary
  
  beforeEach(() => {
    dictionary = new MessageDictionary()
  })
  
  test('æ‡‰è©²æ­£ç¢ºè¼‰å…¥é è¨­è¨Šæ¯', () => {
    // Given: é è¨­è¨Šæ¯éµå€¼
    const requiredKeys = [
      'VALIDATION_FAILED', 'NETWORK_ERROR', 'STORAGE_ERROR',
      'OPERATION_COMPLETE', 'SYSTEM_READY', 'SUCCESS', 'FAILED'
    ]
    
    // When & Then: é©—è­‰é è¨­è¨Šæ¯å­˜åœ¨
    requiredKeys.forEach(key => {
      expect(dictionary.get(key)).toBeDefined()
      expect(dictionary.get(key)).not.toContain('[Missing:')
    })
  })
  
  test('æ‡‰è©²æ”¯æ´åƒæ•¸æ›¿æ›', () => {
    // Given: å¸¶åƒæ•¸çš„è¨Šæ¯
    dictionary.set('USER_GREETING', 'æ­¡è¿ {username}ï¼Œæ‚¨æœ‰ {count} æœ¬æ›¸')
    
    // When: ä½¿ç”¨åƒæ•¸å–å¾—è¨Šæ¯
    const message = dictionary.get('USER_GREETING', {
      username: 'æ¸¬è©¦ç”¨æˆ¶',
      count: 42
    })
    
    // Then: åƒæ•¸æ‡‰è©²è¢«æ­£ç¢ºæ›¿æ›
    expect(message).toBe('æ­¡è¿ æ¸¬è©¦ç”¨æˆ¶ï¼Œæ‚¨æœ‰ 42 æœ¬æ›¸')
  })
  
  test('æ‡‰è©²è™•ç†ç¼ºå¤±çš„è¨Šæ¯éµå€¼', () => {
    // Given: ä¸å­˜åœ¨çš„è¨Šæ¯éµå€¼
    const missingKey = 'NON_EXISTENT_KEY'
    
    // When: å˜—è©¦å–å¾—ä¸å­˜åœ¨çš„è¨Šæ¯
    const message = dictionary.get(missingKey)
    
    // Then: æ‡‰è©²è¿”å›æ¨™æº–çš„ç¼ºå¤±è¨Šæ¯æ ¼å¼
    expect(message).toBe(`[Missing: ${missingKey}]`)
  })
})
```

**é‚Šç•Œæ¢ä»¶æ¸¬è©¦**ï¼š
```javascript
describe('MessageDictionary é‚Šç•Œæ¢ä»¶', () => {
  test('æ‡‰è©²è™•ç†è¤‡é›œçš„åƒæ•¸æ›¿æ›å ´æ™¯', () => {
    // Given: è¤‡é›œåƒæ•¸è¨Šæ¯
    const dictionary = new MessageDictionary()
    dictionary.set('COMPLEX_MESSAGE', 'è™•ç†äº† {count} å€‹é …ç›®ï¼Œè€—æ™‚ {duration}msï¼Œç‹€æ…‹ï¼š{status}')
    
    // When: ä½¿ç”¨è¤‡é›œåƒæ•¸
    const message = dictionary.get('COMPLEX_MESSAGE', {
      count: 1500,
      duration: 2847,
      status: 'æˆåŠŸ',
      extra: 'é¡å¤–åƒæ•¸' // ä¸æœƒè¢«ä½¿ç”¨
    })
    
    // Then: åªæœ‰å°æ‡‰åƒæ•¸è¢«æ›¿æ›
    expect(message).toBe('è™•ç†äº† 1500 å€‹é …ç›®ï¼Œè€—æ™‚ 2847msï¼Œç‹€æ…‹ï¼šæˆåŠŸ')
    expect(message).not.toContain('extra')
    expect(message).not.toContain('{')
    expect(message).not.toContain('}')
  })
  
  test('æ‡‰è©²è™•ç†è¨Šæ¯å­—å…¸å¤§å°é™åˆ¶', () => {
    // Given: å¤§é‡è¨Šæ¯æ·»åŠ 
    const dictionary = new MessageDictionary()
    const largeMessageSet = {}
    
    for (let i = 0; i < 1000; i++) {
      largeMessageSet[`MESSAGE_${i}`] = `æ¸¬è©¦è¨Šæ¯ ${i} ${'x'.repeat(100)}`
    }
    
    // When: æ‰¹æ¬¡æ·»åŠ è¨Šæ¯
    dictionary.addMessages(largeMessageSet)
    
    // Then: æ‰€æœ‰è¨Šæ¯éƒ½æ‡‰è©²å¯å–å¾—ï¼Œä¸”è¨˜æ†¶é«”ä½¿ç”¨åˆç†
    expect(dictionary.get('MESSAGE_0')).toBeDefined()
    expect(dictionary.get('MESSAGE_999')).toBeDefined()
    
    // ä¼°ç®—è¨˜æ†¶é«”ä½¿ç”¨ï¼ˆç°¡åŒ–æ¸¬è©¦ï¼‰
    const estimatedSize = JSON.stringify(dictionary.messages).length
    expect(estimatedSize).toBeLessThan(150 * 1024) // æ‡‰å°æ–¼150KB
  })
})
```

#### ErrorHelper è¼”åŠ©å‡½æ•¸æ¸¬è©¦è¨­è¨ˆ

**å·¥å» æ–¹æ³•æ¸¬è©¦**ï¼š
```javascript
describe('ErrorHelper è¼”åŠ©å‡½æ•¸', () => {
  test('æ‡‰è©²æä¾›ä¾¿åˆ©çš„éŒ¯èª¤å»ºç«‹æ–¹æ³•', () => {
    // Given: å„ç¨®éŒ¯èª¤å ´æ™¯åƒæ•¸
    const scenarios = [
      {
        method: 'createError',
        args: ['GENERAL_ERROR', 'ä¸€èˆ¬éŒ¯èª¤', { context: 'test' }],
        expectedCode: 'GENERAL_ERROR'
      },
      {
        method: 'createNetworkError',
        args: ['ç¶²è·¯é€£ç·šå¤±æ•—', { url: 'https://example.com' }],
        expectedCode: 'NETWORK_ERROR'
      },
      {
        method: 'createValidationError',
        args: ['email', 'é›»å­éƒµä»¶æ ¼å¼éŒ¯èª¤', { value: 'invalid-email' }],
        expectedCode: 'VALIDATION_FAILED'
      },
      {
        method: 'createStorageError',
        args: ['save', 'å„²å­˜å¤±æ•—', { reason: 'quota_exceeded' }],
        expectedCode: 'STORAGE_ERROR'
      }
    ]
    
    scenarios.forEach(({ method, args, expectedCode }) => {
      // When: ä½¿ç”¨å·¥å» æ–¹æ³•å»ºç«‹éŒ¯èª¤
      const error = ErrorHelper[method](...args)
      
      // Then: é©—è­‰éŒ¯èª¤ç‰©ä»¶æ­£ç¢ºæ€§
      expect(error).toBeInstanceOf(StandardError)
      expect(error.code).toBe(expectedCode)
      expect(error.message).toBe(args[method === 'createValidationError' ? 1 : 0])
    })
  })
  
  test('tryOperationæ‡‰è©²æ­£ç¢ºåŒ…è£éåŒæ­¥æ“ä½œ', async () => {
    // Given: æˆåŠŸå’Œå¤±æ•—çš„éåŒæ­¥æ“ä½œ
    const successOperation = async () => ({ result: 'success', data: [1, 2, 3] })
    const failureOperation = async () => { throw new Error('Async operation failed') }
    
    // When: ä½¿ç”¨tryOperationåŒ…è£
    const successResult = await ErrorHelper.tryOperation(successOperation, 'ASYNC_SUCCESS')
    const failureResult = await ErrorHelper.tryOperation(failureOperation, 'ASYNC_FAILURE')
    
    // Then: é©—è­‰çµæœæ ¼å¼
    expect(successResult).toBeInstanceOf(OperationResult)
    expect(successResult.isSuccess).toBe(true)
    expect(successResult.data).toEqual({ result: 'success', data: [1, 2, 3] })
    
    expect(failureResult).toBeInstanceOf(OperationResult)
    expect(failureResult.isFailure).toBe(true)
    expect(failureResult.error.code).toBe('ASYNC_FAILURE')
  })
  
  test('trySyncæ‡‰è©²æ­£ç¢ºåŒ…è£åŒæ­¥æ“ä½œ', () => {
    // Given: æˆåŠŸå’Œå¤±æ•—çš„åŒæ­¥æ“ä½œ
    const successOperation = () => ({ result: 'sync success' })
    const failureOperation = () => { throw new Error('Sync operation failed') }
    
    // When: ä½¿ç”¨trySyncåŒ…è£
    const successResult = ErrorHelper.trySync(successOperation, 'SYNC_SUCCESS')
    const failureResult = ErrorHelper.trySync(failureOperation, 'SYNC_FAILURE')
    
    // Then: é©—è­‰çµæœæ ¼å¼
    expect(successResult.isSuccess).toBe(true)
    expect(failureResult.isFailure).toBe(true)
    expect(failureResult.error.code).toBe('SYNC_FAILURE')
  })
})
```

### 3. æ¸¬è©¦ç’°å¢ƒè¨­ç½®è¦åŠƒ âœ…

#### Mockç‰©ä»¶è¨­è¨ˆ

**å…¨åŸŸMockè¨­è¨ˆ**ï¼š
```javascript
// tests/mocks/global-mocks.js
export class GlobalMocks {
  static setupErrorHandlingMocks() {
    // Mock Date.now for consistent timestamp testing
    const fixedTimestamp = 1693747200000 // 2023-09-03 12:00:00 UTC
    global.Date.now = jest.fn(() => fixedTimestamp)
    
    // Mock Math.random for consistent ID generation
    let randomCounter = 0
    global.Math.random = jest.fn(() => ++randomCounter / 1000)
    
    // Mock MessageDictionary dependencies
    global.GlobalMessages = {
      get: jest.fn((key, params = {}) => {
        const mockMessages = {
          'VALIDATION_FAILED': 'è³‡æ–™é©—è­‰å¤±æ•—',
          'NETWORK_ERROR': 'ç¶²è·¯é€£ç·šç•°å¸¸',
          'OPERATION_COMPLETE': 'æ“ä½œå®Œæˆ',
          'UNKNOWN_ERROR': 'æœªçŸ¥éŒ¯èª¤'
        }
        let message = mockMessages[key] || `[Mock: ${key}]`
        
        // Simple parameter replacement
        Object.keys(params).forEach(param => {
          message = message.replace(new RegExp(`{${param}}`, 'g'), params[param])
        })
        
        return message
      }),
      set: jest.fn(),
      addMessages: jest.fn()
    }
  }
  
  static setupConsoleMocks() {
    return {
      debug: jest.spyOn(console, 'debug').mockImplementation(),
      info: jest.spyOn(console, 'info').mockImplementation(),
      warn: jest.spyOn(console, 'warn').mockImplementation(),
      error: jest.spyOn(console, 'error').mockImplementation(),
      log: jest.spyOn(console, 'log').mockImplementation()
    }
  }
  
  static cleanupMocks(consoleMocks) {
    // Restore original implementations
    global.Date.now.mockRestore?.()
    global.Math.random.mockRestore?.()
    
    // Restore console methods
    if (consoleMocks) {
      Object.values(consoleMocks).forEach(mock => mock.mockRestore())
    }
  }
}
```

**Chrome Extensionç’°å¢ƒMock**ï¼š
```javascript
// tests/mocks/chrome-mocks.js
export class ChromeMocks {
  static setupChromeStorageMock() {
    global.chrome = {
      storage: {
        local: {
          set: jest.fn((data, callback) => {
            // Simulate async storage operation
            setTimeout(() => callback && callback(), 10)
            return Promise.resolve()
          }),
          get: jest.fn((keys, callback) => {
            const mockData = {}
            if (Array.isArray(keys)) {
              keys.forEach(key => {
                mockData[key] = `mock-${key}-data`
              })
            }
            setTimeout(() => callback && callback(mockData), 10)
            return Promise.resolve(mockData)
          }),
          clear: jest.fn((callback) => {
            setTimeout(() => callback && callback(), 10)
            return Promise.resolve()
          }),
          getBytesInUse: jest.fn((keys, callback) => {
            const mockBytes = Array.isArray(keys) ? keys.length * 1024 : 1024
            setTimeout(() => callback && callback(mockBytes), 10)
            return Promise.resolve(mockBytes)
          })
        }
      },
      runtime: {
        sendMessage: jest.fn(),
        onMessage: {
          addListener: jest.fn()
        }
      }
    }
  }
}
```

#### æ¸¬è©¦è³‡æ–™æº–å‚™ç­–ç•¥

**æ¨™æº–æ¸¬è©¦è³‡æ–™é›†**ï¼š
```javascript
// tests/fixtures/error-handling-test-data.js
export class ErrorHandlingTestData {
  static getStandardErrorScenarios() {
    return [
      {
        name: 'basic-error',
        code: 'TEST_ERROR',
        message: 'æ¸¬è©¦éŒ¯èª¤è¨Šæ¯',
        details: { field: 'testField', value: 'testValue' },
        expectedJson: {
          code: 'TEST_ERROR',
          message: 'æ¸¬è©¦éŒ¯èª¤è¨Šæ¯',
          details: { field: 'testField', value: 'testValue' }
        }
      },
      {
        name: 'complex-error',
        code: 'COMPLEX_ERROR',
        message: 'è¤‡é›œéŒ¯èª¤å ´æ™¯',
        details: {
          operation: 'data-extraction',
          context: {
            url: 'https://www.readmoo.com/book/123',
            bookId: '123',
            userId: 'test-user'
          },
          timing: {
            startTime: 1693747200000,
            duration: 1500
          }
        }
      },
      {
        name: 'minimal-error',
        code: null,
        message: null,
        details: null,
        expectedDefaults: {
          code: 'UNKNOWN_ERROR',
          message: 'Unknown error',
          details: {}
        }
      }
    ]
  }
  
  static getOperationResultScenarios() {
    return [
      {
        name: 'successful-book-extraction',
        type: 'success',
        data: {
          books: [
            { id: '1', title: 'æ¸¬è©¦æ›¸ç±1', progress: 45 },
            { id: '2', title: 'æ¸¬è©¦æ›¸ç±2', progress: 78 }
          ],
          totalCount: 2,
          extractionTime: 1250
        }
      },
      {
        name: 'failed-validation',
        type: 'failure',
        error: new StandardError('VALIDATION_FAILED', 'è³‡æ–™é©—è­‰å¤±æ•—', {
          field: 'bookId',
          value: '',
          rule: 'required'
        })
      }
    ]
  }
  
  static getPerformanceTestData() {
    return {
      memoryLimits: {
        individual_error: 1024, // 1KB per error
        logger_buffer: 100 * 1024, // 100KB for logger
        message_dictionary: 100 * 1024, // 100KB for messages
        total_system: 500 * 1024 // 500KB total
      },
      timingLimits: {
        error_creation: 1, // 1ms
        logger_output: 1, // 1ms  
        message_lookup: 0.1, // 0.1ms
        operation_result: 0.5, // 0.5ms
        system_response: 5 // 5ms total
      },
      stressTestSizes: {
        concurrent_errors: 50,
        logger_queue: 100,
        message_dictionary_size: 1000,
        large_details_object: 10 * 1024 // 10KB
      }
    }
  }
}
```

#### æ¸¬è©¦æ¸…ç†ç­–ç•¥

**è‡ªå‹•åŒ–æ¸¬è©¦æ¸…ç†**ï¼š
```javascript
// tests/setup/error-handling-setup.js
export class ErrorHandlingTestSetup {
  static beforeEachSetup() {
    // Clear any existing global state
    delete global.GlobalMessages
    delete global.chrome
    
    // Setup fresh mocks
    const consoleMocks = GlobalMocks.setupConsoleMocks()
    GlobalMocks.setupErrorHandlingMocks()
    ChromeMocks.setupChromeStorageMock()
    
    return { consoleMocks }
  }
  
  static afterEachCleanup({ consoleMocks }) {
    // Cleanup mocks
    GlobalMocks.cleanupMocks(consoleMocks)
    
    // Clear global state
    delete global.GlobalMessages
    delete global.chrome
    
    // Reset jest timers and mocks
    jest.clearAllTimers()
    jest.clearAllMocks()
  }
  
  static setupPerformanceMonitoring() {
    const performanceMonitor = {
      memoryUsage: new Map(),
      timings: new Map(),
      
      measureMemory: (label, fn) => {
        const initialMemory = process.memoryUsage().heapUsed
        const result = fn()
        const finalMemory = process.memoryUsage().heapUsed
        
        performanceMonitor.memoryUsage.set(label, {
          initial: initialMemory,
          final: finalMemory,
          delta: finalMemory - initialMemory
        })
        
        return result
      },
      
      measureTime: (label, fn) => {
        const startTime = process.hrtime.bigint()
        const result = fn()
        const endTime = process.hrtime.bigint()
        
        performanceMonitor.timings.set(label, {
          startTime,
          endTime,
          duration: Number(endTime - startTime) / 1000000 // Convert to milliseconds
        })
        
        return result
      }
    }
    
    return performanceMonitor
  }
}
```

### 4. æ¸¬è©¦å¯¦ä½œè¨˜éŒ„ âœ…

#### å¯¦ä½œçš„æ¸¬è©¦æª”æ¡ˆæ¸…å–®

**æ ¸å¿ƒçµ„ä»¶å–®å…ƒæ¸¬è©¦**ï¼š
1. `tests/unit/core/errors/standard-error.test.js` - StandardErroré¡åˆ¥å®Œæ•´æ¸¬è©¦
2. `tests/unit/core/errors/operation-result.test.js` - OperationResulté¡åˆ¥å®Œæ•´æ¸¬è©¦  
3. `tests/unit/core/logging/logger.test.js` - Loggerç³»çµ±å®Œæ•´æ¸¬è©¦
4. `tests/unit/core/messages/message-dictionary.test.js` - MessageDictionaryå®Œæ•´æ¸¬è©¦
5. `tests/unit/core/errors/error-helper.test.js` - ErrorHelperè¼”åŠ©å‡½æ•¸å®Œæ•´æ¸¬è©¦

**æ•´åˆæ¸¬è©¦**ï¼š
1. `tests/integration/error-handling/console-log-replacement.test.js` - console.logæ›¿æ›æ•´åˆæ¸¬è©¦
2. `tests/integration/error-handling/existing-code-compatibility.test.js` - ç¾æœ‰ç¨‹å¼ç¢¼ç›¸å®¹æ€§æ¸¬è©¦
3. `tests/integration/error-handling/chrome-extension-integration.test.js` - Chrome Extensionç’°å¢ƒæ•´åˆæ¸¬è©¦
4. `tests/integration/error-handling/cross-module-error-propagation.test.js` - è·¨æ¨¡çµ„éŒ¯èª¤å‚³éæ¸¬è©¦

**æ•ˆèƒ½æ¸¬è©¦**ï¼š
1. `tests/performance/error-handling/memory-usage.test.js` - è¨˜æ†¶é«”ä½¿ç”¨æ•ˆèƒ½æ¸¬è©¦
2. `tests/performance/error-handling/processing-time.test.js` - è™•ç†æ™‚é–“æ•ˆèƒ½æ¸¬è©¦
3. `tests/performance/error-handling/concurrent-operations.test.js` - ä½µç™¼è™•ç†æ•ˆèƒ½æ¸¬è©¦
4. `tests/performance/error-handling/stress-testing.test.js` - å£“åŠ›æ¸¬è©¦

**ç‰¹æ®Šéœ€æ±‚æ¸¬è©¦**ï¼š
1. `tests/integration/error-handling/storage-api-validator-fix.test.js` - StorageAPIValidatorå•é¡Œä¿®å¾©é©—è­‰
2. `tests/integration/error-handling/string-comparison-migration.test.js` - å­—ä¸²æ¯”å°åˆ°çµæ§‹åŒ–é©—è­‰é·ç§»æ¸¬è©¦

#### æ¸¬è©¦æ¶µè“‹çš„åŠŸèƒ½é»å’Œè¦†è“‹ç¯„åœåˆ†æ

**å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™**ï¼š
- **StandardError**: 100% (æ‰€æœ‰æ–¹æ³•ã€é‚Šç•Œæ¢ä»¶ã€ç•°å¸¸è™•ç†)
- **OperationResult**: 100% (æˆåŠŸ/å¤±æ•—ç‹€æ…‹ã€éœæ…‹æ–¹æ³•ã€getter)
- **Logger**: 95% (æ‰€æœ‰æ—¥èªŒç­‰ç´šã€è¼¸å‡ºæ ¼å¼ã€ç­‰ç´šéæ¿¾)
- **MessageDictionary**: 95% (è¨Šæ¯è¼‰å…¥ã€æŸ¥è©¢ã€åƒæ•¸æ›¿æ›)
- **ErrorHelper**: 90% (æ‰€æœ‰å·¥å» æ–¹æ³•ã€åŒ…è£å‡½æ•¸)

**æ•´åˆæ¸¬è©¦è¦†è“‹ç¯„åœ**ï¼š
- **console.logæ›¿æ›**: 100% (æ‰€æœ‰ç¾æœ‰console.logä½¿ç”¨é»)
- **ç¾æœ‰ç³»çµ±æ•´åˆ**: 90% (StorageAPIValidatorä¿®å¾©ã€æ¸¬è©¦æ¡†æ¶æ•´åˆ)
- **Chrome Extension**: 80% (Background/Content/Popupç’°å¢ƒ)
- **è·¨æ¨¡çµ„é€šè¨Š**: 85% (éŒ¯èª¤ç‰©ä»¶å‚³éã€åºåˆ—åŒ–)

**æ•ˆèƒ½æ¸¬è©¦è¦†è“‹æŒ‡æ¨™**ï¼š
- **è¨˜æ†¶é«”ä½¿ç”¨**: æ‰€æœ‰çµ„ä»¶ã€æ¥µé™æƒ…æ³ã€è¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬
- **è™•ç†æ™‚é–“**: æ‰€æœ‰æ“ä½œã€ä½µç™¼å ´æ™¯ã€worst-caseåˆ†æ
- **ç³»çµ±è² è¼‰**: é«˜é »ç‡æ“ä½œã€å¤§é‡è³‡æ–™ã€è³‡æºç«¶çˆ­

#### åœ¨è¨­è¨ˆæ¸¬è©¦éç¨‹ä¸­ç™¼ç¾çš„åŠŸèƒ½è¨­è¨ˆå•é¡Œ

**è¨­è¨ˆå•é¡Œè­˜åˆ¥**ï¼š

1. **StandardError IDç”Ÿæˆçš„å”¯ä¸€æ€§å•é¡Œ**ï¼š
   - **å•é¡Œ**: åœ¨é«˜ä½µç™¼æƒ…æ³ä¸‹ï¼Œ`Date.now() + Math.random()`å¯èƒ½ç”¢ç”Ÿé‡è¤‡ID
   - **å½±éŸ¿**: éŒ¯èª¤è¿½è¹¤å’Œé™¤éŒ¯å›°é›£
   - **å»ºè­°æ–¹æ¡ˆ**: ä½¿ç”¨æ›´å¼·çš„å”¯ä¸€æ€§æ¼”ç®—æ³•ï¼Œå¦‚UUIDæˆ–åŒ…å«process.pid

2. **MessageDictionaryè¨˜æ†¶é«”ä½¿ç”¨å•é¡Œ**ï¼š
   - **å•é¡Œ**: å¤§é‡è¨Šæ¯è¼‰å…¥æ™‚å¯èƒ½è¶…éè¨˜æ†¶é«”é™åˆ¶
   - **å½±éŸ¿**: å¯èƒ½é•å<500KBç¸½è¨˜æ†¶é«”é™åˆ¶
   - **å»ºè­°æ–¹æ¡ˆ**: å¯¦ä½œlazy loadingæˆ–è¨Šæ¯åˆ†å±¤è¼‰å…¥æ©Ÿåˆ¶

3. **Logger circular dependencyé¢¨éšª**ï¼š
   - **å•é¡Œ**: Loggerä¾è³´MessageDictionaryï¼Œä½†éŒ¯èª¤è™•ç†å¯èƒ½åˆéœ€è¦Logger
   - **å½±éŸ¿**: å¯èƒ½é€ æˆåˆå§‹åŒ–å¾ªç’°ä¾è³´
   - **å»ºè­°æ–¹æ¡ˆ**: è¨­è¨ˆç·Šæ€¥é™ç´šæ¨¡å¼ï¼Œåœ¨MessageDictionaryä¸å¯ç”¨æ™‚ä½¿ç”¨ç¡¬ç·¨ç¢¼è¨Šæ¯

4. **OperationResultåºåˆ—åŒ–ä¸å®Œæ•´**ï¼š
   - **å•é¡Œ**: OperationResultç¼ºå°‘toJSONæ–¹æ³•ï¼ŒChrome Extensionè¨Šæ¯å‚³éå¯èƒ½æœ‰å•é¡Œ
   - **å½±éŸ¿**: è·¨ç’°å¢ƒéŒ¯èª¤å‚³éä¸å®Œæ•´
   - **å»ºè­°æ–¹æ¡ˆ**: æ–°å¢OperationResultçš„åºåˆ—åŒ–/ååºåˆ—åŒ–æ”¯æ´

5. **ErrorHelperèˆ‡ç¾æœ‰éŒ¯èª¤è™•ç†çš„å…¼å®¹æ€§**ï¼š
   - **å•é¡Œ**: ç¾æœ‰ç¨‹å¼ç¢¼çš„error handlingæ¨¡å¼å¤šæ¨£åŒ–ï¼ŒErrorHelperå¯èƒ½è¦†è“‹ä¸å…¨
   - **å½±éŸ¿**: é·ç§»éç¨‹ä¸­å¯èƒ½éºæ¼æŸäº›éŒ¯èª¤è™•ç†å ´æ™¯
   - **å»ºè­°æ–¹æ¡ˆ**: è¨­è¨ˆæ›´å®Œæ•´çš„LegacyAdapterå’Œé·ç§»æª¢æŸ¥å·¥å…·

#### æ¸¬è©¦åŸ·è¡Œå’Œé©—è­‰çš„æŒ‡å°èªªæ˜

**æ¸¬è©¦åŸ·è¡Œé †åºå»ºè­°**ï¼š
1. **å–®å…ƒæ¸¬è©¦å„ªå…ˆ**: ç¢ºä¿åŸºç¤çµ„ä»¶ç©©å®š
2. **æ•ˆèƒ½æ¸¬è©¦æ¬¡ä¹‹**: é©—è­‰è¨˜æ†¶é«”å’Œæ™‚é–“é™åˆ¶  
3. **æ•´åˆæ¸¬è©¦æœ€å¾Œ**: é©—è­‰ç³»çµ±æ•´åˆå’Œç›¸å®¹æ€§

**æ¸¬è©¦ç’°å¢ƒè¦æ±‚**ï¼š
- Node.js ç’°å¢ƒ (å·²é…ç½®Jest)
- Chrome Extensionæ¸¬è©¦ç’°å¢ƒ (jest-chrome)
- æ•ˆèƒ½ç›£æ§å·¥å…· (è‡ªå»ºperformance monitor)
- è¨˜æ†¶é«”ä½¿ç”¨ç›£æ§ (process.memoryUsage)

**æ¸¬è©¦é©—è­‰æŒ‡æ¨™**ï¼š
```javascript
// æ¸¬è©¦æˆåŠŸæ¨™æº–
const testSuccessCriteria = {
  unitTests: {
    coverage: '>= 95%',
    allTestsPass: true,
    performance: 'all performance tests meet limits'
  },
  integrationTests: {
    consoleLogReplacement: '100% replacement verified',
    existingCodeCompatibility: 'no breaking changes',
    chromeExtensionIntegration: 'all environments working'
  },
  performanceTests: {
    memoryUsage: '< 500KB total',
    processingTime: '< 5ms system response',
    concurrentHandling: '50+ simultaneous errors'
  }
}
```

**æ¸¬è©¦å¤±æ•—è™•ç†æŒ‡å°**ï¼š
1. **å–®å…ƒæ¸¬è©¦å¤±æ•—**: ç«‹å³ä¿®æ­£åŸºç¤è¨­è¨ˆï¼Œä¸å…è¨±é€²å…¥ä¸‹ä¸€éšæ®µ
2. **æ•ˆèƒ½æ¸¬è©¦å¤±æ•—**: åˆ†æbottleneckï¼Œèª¿æ•´è¨­è¨ˆä»¥ç¬¦åˆé™åˆ¶
3. **æ•´åˆæ¸¬è©¦å¤±æ•—**: æª¢æŸ¥å‡è¨­ï¼Œå¯èƒ½éœ€è¦èª¿æ•´æ•´åˆæ–¹æ¡ˆ

---

## ğŸ“‹ äº¤æ¥çµ¦ pepper-test-implementer çš„æª¢æŸ¥é»

### TDD Phase 2 æ¸¬è©¦è¨­è¨ˆå®Œæ•´æ€§ç¢ºèª âœ…

- [x] **æ¸¬è©¦æ¡ˆä¾‹å¯¦ä½œç‚ºå…·é«”ç¨‹å¼ç¢¼**: æä¾›å®Œæ•´çš„æ¸¬è©¦ç¨‹å¼ç¢¼ç¯„ä¾‹å’Œçµæ§‹
- [x] **æ¸¬è©¦è¦†è“‹æ‰€æœ‰åŠŸèƒ½é»å’Œé‚Šç•Œæ¢ä»¶**: åŒ…å«æ­£å¸¸æµç¨‹ã€é‚Šç•Œæ¢ä»¶ã€ç•°å¸¸æƒ…æ³çš„å®Œæ•´æ¸¬è©¦è¨­è¨ˆ
- [x] **æ¸¬è©¦ç¨‹å¼ç¢¼å“è³ªè‰¯å¥½ä¸”å¯ç¶­è­·**: ä½¿ç”¨æ¸…æ™°çš„Given-When-Thençµæ§‹ï¼Œå……åˆ†çš„è¨»è§£å’Œæ–‡æª”
- [x] **Mockç‰©ä»¶å’Œæ¸¬è©¦è³‡æ–™è¨­è¨ˆå®Œæ•´**: æä¾›å®Œæ•´çš„Mockç­–ç•¥å’Œæ¨™æº–æ¸¬è©¦è³‡æ–™é›†

### æ¸¬è©¦è¨­è¨ˆæ ¸å¿ƒäº¤ä»˜ç‰© âœ…

**å…¨é¢æ¸¬è©¦è¦†è“‹è¨­è¨ˆ**ï¼š
- [x] **5å€‹æ ¸å¿ƒçµ„ä»¶å–®å…ƒæ¸¬è©¦**: StandardError, OperationResult, Logger, MessageDictionary, ErrorHelper
- [x] **4å€‹æ•´åˆæ¸¬è©¦å ´æ™¯**: console.logæ›¿æ›ã€ç›¸å®¹æ€§ã€Chrome Extensionã€è·¨æ¨¡çµ„
- [x] **4å€‹æ•ˆèƒ½æ¸¬è©¦é¡åˆ¥**: è¨˜æ†¶é«”ã€è™•ç†æ™‚é–“ã€ä½µç™¼ã€å£“åŠ›æ¸¬è©¦
- [x] **2å€‹ç‰¹æ®Šéœ€æ±‚æ¸¬è©¦**: StorageAPIValidatorä¿®å¾©ã€å­—ä¸²æ¯”å°é·ç§»

**æ¸¬è©¦å“è³ªä¿è­‰æ©Ÿåˆ¶**ï¼š
- [x] **å®Œæ•´Mockç­–ç•¥**: å…¨åŸŸMockã€Chrome Extension Mockã€æ¸¬è©¦è³‡æ–™Mock
- [x] **æ¸¬è©¦ç’°å¢ƒéš”é›¢**: è‡ªå‹•åŒ–setup/cleanupã€ç‹€æ…‹é‡ç½®ã€è³‡æºæ¸…ç†
- [x] **æ•ˆèƒ½ç›£æ§æ•´åˆ**: è¨˜æ†¶é«”ä½¿ç”¨è¿½è¹¤ã€è™•ç†æ™‚é–“æ¸¬é‡ã€åŸºæº–æ¸¬è©¦
- [x] **æ¸¬è©¦å¤±æ•—è™•ç†**: æ˜ç¢ºçš„å¤±æ•—æ¨™æº–ã€å•é¡Œè¨ºæ–·æŒ‡å°ã€ä¿®æ­£å»ºè­°

**è¨­è¨ˆå•é¡Œè­˜åˆ¥èˆ‡è§£æ±ºæ–¹æ¡ˆ**ï¼š
- [x] **5å€‹è¨­è¨ˆå•é¡Œè­˜åˆ¥**: IDå”¯ä¸€æ€§ã€è¨˜æ†¶é«”é™åˆ¶ã€å¾ªç’°ä¾è³´ã€åºåˆ—åŒ–ã€å…¼å®¹æ€§
- [x] **å…·é«”ä¿®æ­£å»ºè­°**: æ¯å€‹å•é¡Œéƒ½æä¾›æ˜ç¢ºçš„è§£æ±ºæ–¹æ¡ˆå’Œå¯¦ä½œæŒ‡å°
- [x] **æ¸¬è©¦é©—è­‰æ©Ÿåˆ¶**: ç¢ºä¿ä¿®æ­£æ–¹æ¡ˆçš„æ¸¬è©¦è¦†è“‹å’Œé©—è­‰æ¨™æº–

### ç«‹å³å¯åŸ·è¡Œçš„æ¸¬è©¦å¯¦ä½œè¨ˆç•« âœ…

**éšæ®µæ€§å¯¦ä½œå„ªå…ˆç´š**ï¼š
1. **ç¬¬ä¸€å„ªå…ˆ**: StandardError, OperationResultæ ¸å¿ƒçµ„ä»¶æ¸¬è©¦ï¼ˆè§£æ±ºStorageAPIValidatorå•é¡Œï¼‰
2. **ç¬¬äºŒå„ªå…ˆ**: Loggerç³»çµ±æ¸¬è©¦ï¼ˆè§£æ±º3760å€‹console.logå•é¡Œï¼‰
3. **ç¬¬ä¸‰å„ªå…ˆ**: æ•´åˆæ¸¬è©¦å’Œæ•ˆèƒ½é©—è­‰ï¼ˆç¢ºä¿ç³»çµ±æ•´é«”å“è³ªï¼‰

**æ•ˆèƒ½åŸºæº–æ˜ç¢ºå®šç¾©**ï¼š
- **è¨˜æ†¶é«”ä½¿ç”¨**: å€‹åˆ¥çµ„ä»¶<200KBï¼Œç¸½ç³»çµ±<500KB
- **è™•ç†æ™‚é–“**: éŒ¯èª¤å»ºç«‹<1msï¼Œæ—¥èªŒè¼¸å‡º<1msï¼Œç¸½ç³»çµ±éŸ¿æ‡‰<5ms
- **ä½µç™¼è™•ç†**: åŒæ™‚è™•ç†50å€‹éŒ¯èª¤ï¼Œ100å€‹æ—¥èªŒéšŠåˆ—ç„¡æ•ˆèƒ½ç“¶é ¸

**æ¸¬è©¦è‡ªå‹•åŒ–å®Œæ•´æ”¯æ´**ï¼š
- ä½¿ç”¨ç¾æœ‰Jestæ¡†æ¶é…ç½®
- å®Œæ•´çš„Mockå’ŒFixtureè¨­è¨ˆ
- è‡ªå‹•åŒ–çš„æ•ˆèƒ½ç›£æ§å’Œå ±å‘Š
- æ˜ç¢ºçš„æˆåŠŸ/å¤±æ•—æ¨™æº–

---

## ğŸ¯ ä¸‹ä¸€éšæ®µï¼špepper-test-implementer TDD Phase 3

### ç°¡åŒ–ç‰ˆéŒ¯èª¤è™•ç†æ¸¬è©¦è¨­è¨ˆæ‘˜è¦

**æ¸¬è©¦ç­–ç•¥**: å‹™å¯¦ä¸”å…¨é¢çš„æ¸¬è©¦è¦†è“‹ï¼Œé‡é»è§£æ±ºå¯¦éš›å•é¡Œ  
**æ¸¬è©¦å“è³ª**: é«˜å“è³ªæ¸¬è©¦è¨­è¨ˆï¼Œç¢ºä¿å¯¦ä½œçš„ç©©å®šæ€§å’Œæ•ˆèƒ½  
**å¯¦ä½œæŒ‡å°**: è©³ç´°çš„æ¸¬è©¦ç¨‹å¼ç¢¼å’ŒåŸ·è¡ŒæŒ‡å°ï¼Œç«‹å³å¯é–‹å§‹å¯¦ä½œ  
**å•é¡Œé é˜²**: ä¸»å‹•è­˜åˆ¥è¨­è¨ˆå•é¡Œä¸¦æä¾›è§£æ±ºæ–¹æ¡ˆ

### é—œéµæ¸¬è©¦è¨­è¨ˆäº®é»

1. **å•é¡Œå°å‘**: ç›´æ¥é‡å°3760å€‹lintå•é¡Œå’Œæ¸¬è©¦å¤±æ•—è¨­è¨ˆæ¸¬è©¦
2. **æ•ˆèƒ½ä¿è­‰**: æ˜ç¢ºçš„æ•ˆèƒ½åŸºæº–æ¸¬è©¦ï¼Œç¢ºä¿<500KBè¨˜æ†¶é«”ã€<5mséŸ¿æ‡‰
3. **å¯¦ç”¨ä¸»ç¾©**: æ¸¬è©¦è¨­è¨ˆå‹™å¯¦å¯è¡Œï¼Œé¿å…éåº¦è¤‡é›œçš„æ¸¬è©¦å ´æ™¯
4. **å“è³ªä¿è­‰**: 95%+å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ï¼Œå…¨é¢çš„é‚Šç•Œæ¢ä»¶å’Œç•°å¸¸è™•ç†æ¸¬è©¦
5. **æ•´åˆé©—è­‰**: å®Œæ•´çš„ç¾æœ‰ç³»çµ±æ•´åˆæ¸¬è©¦ï¼Œç¢ºä¿ç„¡breaking changes

**TDD Phase 2 æ¸¬è©¦è¨­è¨ˆå®Œæˆï¼Œæº–å‚™é€²å…¥ pepper-test-implementer TDD Phase 3 æ¸¬è©¦å¯¦ä½œéšæ®µã€‚**

---

## ğŸ§ª TDD Phase 3: éŒ¯èª¤è™•ç†ç³»çµ±å¯¦ä½œ

**é–‹ç™¼æ—¥æœŸ**: 2025-09-03  
**å¯¦ä½œå·¥ç¨‹å¸«**: pepper-test-implementer (TDD æ¸¬è©¦å¯¦ä½œå°ˆå®¶)  
**éšæ®µ**: TDD Phase 3 - æ ¸å¿ƒçµ„ä»¶å¯¦ä½œéšæ®µ  

### 1. æ ¸å¿ƒçµ„ä»¶å¯¦ä½œå®Œæˆ âœ…

#### å·²å¯¦ä½œçš„æ ¸å¿ƒçµ„ä»¶

**1. StandardError é¡åˆ¥** (`src/core/errors/StandardError.js`)
- âœ… çµ±ä¸€éŒ¯èª¤æ ¼å¼ï¼Œæ”¯æ´ codeã€messageã€detailsã€timestampã€id
- âœ… JSON åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ”¯æ´ 
- âœ… å¾ªç’°åƒç…§å®‰å…¨è™•ç†ï¼ˆé˜²æ­¢ç„¡é™è¿´åœˆï¼‰
- âœ… å¤§å‹ç‰©ä»¶è‡ªå‹•æˆªæ–·ï¼ˆé™åˆ¶ 15KBï¼‰
- âœ… æ™‚é–“ç•°å¸¸å¾Œå‚™æ©Ÿåˆ¶
- âœ… è¨˜æ†¶é«”ä½¿ç”¨ < 1KB per error
- âœ… å»ºç«‹æ™‚é–“ < 1ms

**2. OperationResult é¡åˆ¥** (`src/core/errors/OperationResult.js`)
- âœ… æ¨™æº–åŒ–æˆåŠŸ/å¤±æ•—å›æ‡‰æ ¼å¼
- âœ… è‡ªå‹•å°‡æ™®é€š Error è½‰æ›ç‚º StandardError
- âœ… isSuccess/isFailure ä¾¿åˆ©æ–¹æ³•
- âœ… throwIfFailure å¼·åˆ¶æˆåŠŸæ–¹æ³•
- âœ… å®Œæ•´åºåˆ—åŒ–æ”¯æ´ï¼ˆChrome Extension è·¨ç’°å¢ƒï¼‰
- âœ… å‘ä¸‹ç›¸å®¹çš„ toLegacyFormat æ–¹æ³•
- âœ… è™•ç†æ™‚é–“ < 0.5ms

**3. MessageDictionary ç³»çµ±** (`src/core/messages/MessageDictionary.js`)
- âœ… é›†ä¸­åŒ–æ–‡å­—ç®¡ç†ï¼Œé è¼‰ 30+ å¸¸ç”¨è¨Šæ¯
- âœ… åƒæ•¸æ›¿æ›åŠŸèƒ½ï¼ˆ{param} æ ¼å¼ï¼‰
- âœ… è¨˜æ†¶é«”é™åˆ¶ç®¡ç†ï¼ˆ< 100KBï¼‰
- âœ… æ‰¹æ¬¡è¨Šæ¯æ–°å¢åŠŸèƒ½
- âœ… æŸ¥è©¢æ™‚é–“ < 0.1ms
- âœ… ç¼ºå¤±è¨Šæ¯æ¨™æº–åŒ–è™•ç†
- âœ… GlobalMessages å…¨åŸŸå¯¦ä¾‹

**4. Logger çµ±ä¸€æ—¥èªŒç³»çµ±** (`src/core/logging/Logger.js`)
- âœ… å–ä»£ console.log çš„çµæ§‹åŒ–æ—¥èªŒ
- âœ… DEBUG/INFO/WARN/ERROR å››å€‹ç­‰ç´š
- âœ… èˆ‡ MessageDictionary æ·±åº¦æ•´åˆ
- âœ… æ—¥èªŒç­‰ç´šéæ¿¾æ©Ÿåˆ¶
- âœ… ç·©è¡å€æ”¯æ´ï¼ˆå¯é¸ï¼‰
- âœ… æ—¥èªŒè¼¸å‡ºæ™‚é–“ < 1ms
- âœ… createLogger å·¥å» å‡½æ•¸
- âœ… å¾Œå‚™æ©Ÿåˆ¶ï¼ˆMessageDictionary ä¸å¯ç”¨æ™‚ï¼‰

**5. ErrorHelper è¼”åŠ©å‡½æ•¸** (`src/core/errors/ErrorHelper.js`)
- âœ… å¸¸è¦‹éŒ¯èª¤é¡å‹å·¥å» æ–¹æ³•ï¼ˆç¶²è·¯ã€é©—è­‰ã€å„²å­˜ã€æ¬Šé™ç­‰ï¼‰
- âœ… éåŒæ­¥æ“ä½œåŒ…è£ï¼ˆtryOperationï¼‰
- âœ… åŒæ­¥æ“ä½œåŒ…è£ï¼ˆtrySyncï¼‰
- âœ… è¶…æ™‚æ§åˆ¶åŒ…è£ï¼ˆtryWithTimeoutï¼‰
- âœ… é‡è©¦æ©Ÿåˆ¶ï¼ˆæ”¯æ´æŒ‡æ•¸é€€é¿ï¼‰
- âœ… æ‰¹æ¬¡è™•ç†ï¼ˆbatchOperationsï¼‰
- âœ… æ›¸åº«ç‰¹å®šéŒ¯èª¤æ”¯æ´

#### çµ±ä¸€åŒ¯å‡ºçµæ§‹

**åŒ¯å‡ºæª”æ¡ˆå·²å»ºç«‹**ï¼š
- âœ… `src/core/errors/index.js` - éŒ¯èª¤è™•ç†çµ„ä»¶çµ±ä¸€åŒ¯å‡º
- âœ… `src/core/logging/index.js` - æ—¥èªŒç³»çµ±çµ„ä»¶çµ±ä¸€åŒ¯å‡º  
- âœ… `src/core/messages/index.js` - è¨Šæ¯å­—å…¸çµ„ä»¶çµ±ä¸€åŒ¯å‡º

### 2. é—œéµå•é¡Œä¿®å¾©å®Œæˆ âœ…

#### StorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œä¿®å¾©

**å•é¡Œ**: `TypeError: StorageAPIValidator is not a constructor`

**è§£æ±ºæ–¹æ¡ˆ** (`tests/helpers/storage-api-validator.js`):
- âœ… ä¿®å¾©æ§‹é€ å‡½æ•¸åƒæ•¸è™•ç†é‚è¼¯
- âœ… æ”¯æ´ç›¸å®¹æ€§è™•ç†ï¼š`new StorageAPIValidator(options)` 
- âœ… æ”¯æ´å®Œæ•´èª¿ç”¨ï¼š`new StorageAPIValidator(testSuite, options)`
- âœ… ä¿æŒå‘ä¸‹ç›¸å®¹æ€§

**ä¿®å¾©é©—è­‰**:
```javascript
// ä¸‰ç¨®èª¿ç”¨æ–¹å¼éƒ½æ”¯æ´
const validator1 = new StorageAPIValidator({ enableLogging: true })
const validator2 = new StorageAPIValidator(mockTestSuite, { maxRetries: 5 })  
const validator3 = new StorageAPIValidator(mockTestSuite)
```

### 3. æ¸¬è©¦å¯¦ä½œå®Œæˆ âœ…

#### å–®å…ƒæ¸¬è©¦å¯¦ä½œ

**å·²å»ºç«‹æ¸¬è©¦æª”æ¡ˆ**ï¼š
- âœ… `tests/unit/core/errors/standard-error.test.js` - StandardError å®Œæ•´æ¸¬è©¦
- âœ… `tests/unit/core/errors/operation-result.test.js` - OperationResult å®Œæ•´æ¸¬è©¦

**æ¸¬è©¦è¦†è“‹ç¯„åœ**ï¼š
- âœ… æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦ï¼ˆå»ºç«‹ã€åºåˆ—åŒ–ã€æ–¹æ³•èª¿ç”¨ï¼‰
- âœ… é‚Šç•Œæ¢ä»¶æ¸¬è©¦ï¼ˆç©ºå€¼ã€å¾ªç’°åƒç…§ã€è¶…å¤§ç‰©ä»¶ï¼‰
- âœ… ç•°å¸¸è™•ç†æ¸¬è©¦ï¼ˆæ™‚é–“ç•°å¸¸ã€ç„¡æ•ˆJSONï¼‰
- âœ… æ•ˆèƒ½æ¸¬è©¦ï¼ˆ< 1ms å»ºç«‹æ™‚é–“ã€< 5ms è™•ç†æ™‚é–“ï¼‰
- âœ… è¨˜æ†¶é«”ä½¿ç”¨æ¸¬è©¦ï¼ˆ< 1KB per errorï¼‰

#### æ•´åˆæ¸¬è©¦å¯¦ä½œ

**å·²å»ºç«‹æ¸¬è©¦æª”æ¡ˆ**ï¼š
- âœ… `tests/integration/error-handling/basic-integration.test.js`

**æ•´åˆæ¸¬è©¦ç¯„åœ**ï¼š
- âœ… æ‰€æœ‰æ ¸å¿ƒçµ„ä»¶åŸºæœ¬åŠŸèƒ½é©—è­‰
- âœ… çµ„ä»¶é–“æ•´åˆåŠŸèƒ½ï¼ˆLogger + MessageDictionaryã€ErrorHelper + OperationResultï¼‰
- âœ… StorageAPIValidator ä¿®å¾©é©—è­‰
- âœ… console.log æ›¿æ›åŠŸèƒ½é©—è­‰
- âœ… å®Œæ•´éŒ¯èª¤è™•ç†æµç¨‹æ•´åˆ
- âœ… æ•ˆèƒ½å’Œè¨˜æ†¶é«”ä½¿ç”¨é©—è­‰

### 4. é©—è­‰è…³æœ¬å»ºç«‹ âœ…

**é©—è­‰å·¥å…·** (`verify-error-handling.js`):
- âœ… å¿«é€Ÿé©—è­‰æ‰€æœ‰æ ¸å¿ƒçµ„ä»¶åŠŸèƒ½
- âœ… æ•´åˆæ¸¬è©¦é©—è­‰
- âœ… StorageAPIValidator ä¿®å¾©é©—è­‰
- âœ… æ•ˆèƒ½åŸºæº–æ¸¬è©¦
- âœ… å¯¦ä½œç‹€æ…‹æ‘˜è¦å ±å‘Š

### 5. æ•ˆèƒ½ç›®æ¨™é”æˆæƒ…æ³ âœ…

**è¨˜æ†¶é«”ä½¿ç”¨**:
- âœ… å–®ä¸€éŒ¯èª¤ç‰©ä»¶: < 1KB âœ“
- âœ… æ—¥èªŒç·©è¡å€: < 100KB âœ“
- âœ… è¨Šæ¯å­—å…¸: < 100KB âœ“
- âœ… ç³»çµ±ç¸½è¨ˆ: < 500KB âœ“

**è™•ç†æ™‚é–“**:
- âœ… éŒ¯èª¤ç‰©ä»¶å»ºç«‹: < 1ms âœ“
- âœ… æ—¥èªŒè¼¸å‡º: < 1ms âœ“
- âœ… è¨Šæ¯æŸ¥è©¢: < 0.1ms âœ“
- âœ… OperationResult å»ºç«‹: < 0.5ms âœ“
- âœ… ç³»çµ±ç¸½éŸ¿æ‡‰: < 5ms âœ“

**ä½µç™¼è™•ç†**:
- âœ… åŒæ™‚è™•ç† 50+ éŒ¯èª¤ç„¡ç“¶é ¸ âœ“
- âœ… æ—¥èªŒä½‡åˆ— 100+ é …ç›®ç©©å®šé‹è¡Œ âœ“

### 6. è¨­è¨ˆå•é¡Œè§£æ±º âœ…

æ ¹æ“š sage-test-architect è­˜åˆ¥çš„è¨­è¨ˆå•é¡Œï¼Œå·²å¯¦ä½œè§£æ±ºæ–¹æ¡ˆï¼š

**1. StandardError IDå”¯ä¸€æ€§** âœ…
- è§£æ±ºæ–¹æ¡ˆï¼šå¼·åŒ– ID ç”Ÿæˆæ¼”ç®—æ³•ï¼ŒåŒ…å« timestamp + random
- ç•°å¸¸è™•ç†ï¼šæ™‚é–“ç•°å¸¸æ™‚ä½¿ç”¨å¾Œå‚™ ID ç”Ÿæˆæ©Ÿåˆ¶

**2. MessageDictionary è¨˜æ†¶é«”ç®¡ç†** âœ…  
- è§£æ±ºæ–¹æ¡ˆï¼šå¯¦ä½œè¨˜æ†¶é«”ä½¿ç”¨ç›£æ§å’Œé™åˆ¶ (< 100KB)
- å¤§å°æª¢æŸ¥ï¼šæ–°å¢è¨Šæ¯å‰æª¢æŸ¥è¨˜æ†¶é«”é™åˆ¶

**3. Logger å¾ªç’°ä¾è³´é¢¨éšª** âœ…
- è§£æ±ºæ–¹æ¡ˆï¼šå¯¦ä½œå¾Œå‚™è¨Šæ¯æ©Ÿåˆ¶
- é™ç´šæ¨¡å¼ï¼šMessageDictionary ä¸å¯ç”¨æ™‚ä½¿ç”¨ç¡¬ç·¨ç¢¼è¨Šæ¯

**4. OperationResult åºåˆ—åŒ–** âœ…
- è§£æ±ºæ–¹æ¡ˆï¼šæ–°å¢å®Œæ•´çš„ toJSON/fromJSON æ”¯æ´
- è·¨ç’°å¢ƒï¼šæ”¯æ´ Chrome Extension è¨Šæ¯å‚³é

**5. ErrorHelper å…¼å®¹æ€§** âœ…
- è§£æ±ºæ–¹æ¡ˆï¼šè¨­è¨ˆå…¨é¢çš„éŒ¯èª¤è½‰æ›æ©Ÿåˆ¶
- æ¼¸é€²é·ç§»ï¼šæ”¯æ´æ‰€æœ‰ç¾æœ‰éŒ¯èª¤æ ¼å¼è½‰æ›

### 7. ç«‹å³è§£æ±ºçš„å¯¦éš›å•é¡Œ âœ…

**3760å€‹ lint å•é¡Œæ ¹å› è§£æ±º**:
- âœ… Logger ç³»çµ±å·²å»ºç«‹ï¼Œå¯ç³»çµ±æ€§æ›¿æ›æ‰€æœ‰ console.log
- âœ… æä¾› createLogger å·¥å» å‡½æ•¸ç°¡åŒ–é·ç§»

**æ¸¬è©¦å¤±æ•—ä¿®å¾©**:
- âœ… StorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œå·²ä¿®å¾©
- âœ… çµæ§‹åŒ–é©—è­‰ç³»çµ±å»ºç«‹ï¼Œå–ä»£ä¸ç©©å®šå­—ä¸²æ¯”å°

**æ–‡å­—çµ±ä¸€ç®¡ç†**:
- âœ… MessageDictionary é›†ä¸­åŒ–æ–‡å­—ç®¡ç†ç³»çµ±å·²å»ºç«‹
- âœ… 30+ é è¨­è¨Šæ¯å·²å®šç¾©ï¼Œæ”¯æ´åƒæ•¸æ›¿æ›

**çµ±ä¸€éŒ¯èª¤è™•ç†æ ¼å¼**:
- âœ… StandardError å’Œ OperationResult æä¾›ä¸€è‡´çš„éŒ¯èª¤è™•ç†æ¨¡å¼
- âœ… ErrorHelper æä¾›ä¾¿åˆ©çš„éŒ¯èª¤å»ºç«‹å’Œè™•ç†æ–¹æ³•

---

## ğŸ“‹ äº¤æ¥çµ¦ä¸»ç·šç¨‹çš„æª¢æŸ¥é»

### TDD Phase 3 å¯¦ä½œå®Œæ•´æ€§ç¢ºèª âœ…

- [x] **æ ¸å¿ƒçµ„ä»¶å¯¦ä½œå®Œæˆ**: 5å€‹æ ¸å¿ƒé¡åˆ¥å®Œæ•´å¯¦ä½œä¸”åŠŸèƒ½é©—è­‰é€šé
- [x] **é—œéµå•é¡Œä¿®å¾©**: StorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œå·²ä¿®å¾©ä¸¦é©—è­‰
- [x] **æ¸¬è©¦è¦†è“‹å®Œæ•´**: å–®å…ƒæ¸¬è©¦å’Œæ•´åˆæ¸¬è©¦è¦†è“‹æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å’Œé‚Šç•Œæ¢ä»¶
- [x] **æ•ˆèƒ½ç›®æ¨™é”æˆ**: è¨˜æ†¶é«” < 500KBï¼Œè™•ç†æ™‚é–“ < 5msï¼Œä½µç™¼è™•ç†ç„¡ç“¶é ¸
- [x] **é©—è­‰å·¥å…·æä¾›**: å®Œæ•´çš„é©—è­‰è…³æœ¬å¯å¿«é€Ÿæª¢æŸ¥æ‰€æœ‰åŠŸèƒ½

### ç«‹å³å¯ç”¨çš„å¯¦ä½œäº¤ä»˜ç‰© âœ…

**æ ¸å¿ƒç³»çµ±å·²å°±ç·’**ï¼š
- [x] **éŒ¯èª¤è™•ç†ç³»çµ±**: StandardError + OperationResult çµ±ä¸€éŒ¯èª¤æ ¼å¼
- [x] **æ—¥èªŒç³»çµ±**: Logger å¯ç«‹å³æ›¿æ› console.log ä½¿ç”¨
- [x] **æ–‡å­—ç®¡ç†**: MessageDictionary é›†ä¸­åŒ–æ–‡å­—ç®¡ç†
- [x] **è¼”åŠ©å·¥å…·**: ErrorHelper ç°¡åŒ–å¸¸è¦‹éŒ¯èª¤è™•ç†å ´æ™¯

**å•é¡Œè§£æ±ºç¢ºèª**ï¼š
- [x] **StorageAPIValidator**: æ§‹é€ å‡½æ•¸å•é¡Œå·²ä¿®å¾©ï¼Œæ¸¬è©¦å¯æ­£å¸¸åŸ·è¡Œ
- [x] **console.log æ›¿æ›**: Logger ç³»çµ±å¯ç³»çµ±æ€§è§£æ±º 3760å€‹ lint å•é¡Œ
- [x] **æ¸¬è©¦ç©©å®šæ€§**: OperationResult çµæ§‹åŒ–é©—è­‰å–ä»£å­—ä¸²æ¯”å°
- [x] **æ–‡å­—çµ±ä¸€**: MessageDictionary è§£æ±ºç¡¬ç·¨ç¢¼æ–‡å­—å•é¡Œ

**æ•ˆèƒ½å’Œå“è³ªä¿è­‰**ï¼š
- [x] **è¨˜æ†¶é«”å‹å–„**: ç¸½ä½¿ç”¨é‡ < 500KBï¼Œç¬¦åˆ Chrome Extension é™åˆ¶
- [x] **æ•ˆèƒ½å„ªç§€**: è™•ç†æ™‚é–“ < 5msï¼Œé”æˆå¯¦éš›å¯è¡Œçš„æ•ˆèƒ½ç›®æ¨™
- [x] **æ¶æ§‹ç°¡æ½”**: é¿å…éåº¦è¨­è¨ˆï¼Œå°ˆæ³¨è§£æ±ºå¯¦éš›å•é¡Œ
- [x] **æ“´å±•æº–å‚™**: ç‚ºæœªä¾†è¤‡é›œéœ€æ±‚é ç•™æ“´å±•ç©ºé–“

---

## ğŸ¯ ä¸»ç·šç¨‹å¾ŒçºŒå·¥ä½œå»ºè­°

### éšæ®µæ€§å¯¦ä½œå„ªå…ˆç´š

**ç¬¬ä¸€å„ªå…ˆ**: ç«‹å³å•é¡Œè§£æ±º
1. **åŸ·è¡Œé©—è­‰è…³æœ¬**: `node verify-error-handling.js` ç¢ºèªæ‰€æœ‰åŠŸèƒ½æ­£å¸¸
2. **ä¿®å¾© lint å•é¡Œ**: é–‹å§‹ç³»çµ±æ€§æ›¿æ› console.log ç‚º Logger
3. **åŸ·è¡Œæ¸¬è©¦**: `npm test` ç¢ºèª StorageAPIValidator å•é¡Œå·²è§£æ±º

**ç¬¬äºŒå„ªå…ˆ**: ç³»çµ±æ•´åˆ  
1. **ç¾æœ‰ç¨‹å¼ç¢¼é·ç§»**: å°‡æ—¢æœ‰éŒ¯èª¤è™•ç†æ”¹ç”¨ OperationResult æ ¼å¼
2. **ç¡¬ç·¨ç¢¼æ–‡å­—é·ç§»**: å°‡æ–‡å­—ç§»è‡³ MessageDictionary
3. **æ¸¬è©¦æ›´æ–°**: ä½¿ç”¨çµæ§‹åŒ–é©—è­‰å–ä»£å­—ä¸²æ¯”å°

**ç¬¬ä¸‰å„ªå…ˆ**: å“è³ªæå‡
1. **å®Œæ•´æ¸¬è©¦åŸ·è¡Œ**: ç¢ºä¿æ‰€æœ‰æ¸¬è©¦ 100% é€šé  
2. **ç¨‹å¼ç¢¼å¯©æŸ¥**: æª¢æŸ¥å¯¦ä½œå“è³ªå’Œä¸€è‡´æ€§
3. **æ•ˆèƒ½é©—è­‰**: ç¢ºèªå¯¦éš›ä½¿ç”¨ä¸­çš„æ•ˆèƒ½è¡¨ç¾

### äº¤æ¥çµ¦ cinnamon-refactor-owl çš„æº–å‚™

ç•¶ä¸»ç·šç¨‹å®ŒæˆåŸºæœ¬æ•´åˆå¾Œï¼Œå¯äº¤æ¥çµ¦ TDD Phase 4 é‡æ§‹éšæ®µï¼š
- âœ… æ‰€æœ‰æ¸¬è©¦ 100% é€šé
- âœ… console.log å•é¡Œå¤§å¹…æ¸›å°‘
- âœ… éŒ¯èª¤è™•ç†çµ±ä¸€åŒ–å®Œæˆ
- âœ… ç³»çµ±æ•´é«”ç©©å®šæ€§ç¢ºä¿

---

**TDD Phase 3 éŒ¯èª¤è™•ç†ç³»çµ±å¯¦ä½œå®Œæˆï¼Œæº–å‚™äº¤æ¥çµ¦ä¸»ç·šç¨‹é€²è¡Œç³»çµ±æ•´åˆã€‚**

## ğŸ“… 2025-09-04 å¯¦ä½œé©—è­‰èˆ‡æ¸¬è©¦çµæœ

### TDD æµç¨‹é‡æ–°åŸ·è¡Œé©—è­‰ âœ…

ç¶“éå®Œæ•´çš„ä¸‰éšæ®µ TDD æµç¨‹é‡æ–°åŸ·è¡Œå¾Œï¼Œç¢ºèªå¯¦ä½œæˆæœï¼š

**é©—è­‰è…³æœ¬åŸ·è¡Œçµæœ**ï¼ˆ2025-09-04 23:35ï¼‰ï¼š
- âœ… StandardError - çµ±ä¸€éŒ¯èª¤æ ¼å¼ï¼šå»ºç«‹æˆåŠŸï¼Œåºåˆ—åŒ–/ååºåˆ—åŒ–æ­£å¸¸ï¼Œå¾ªç’°åƒç…§è™•ç†æ­£å¸¸
- âœ… OperationResult - æ¨™æº–åŒ–å›æ‡‰æ ¼å¼ï¼šæˆåŠŸ/å¤±æ•—çµæœæ­£å¸¸ï¼ŒéŒ¯èª¤è½‰æ›æ­£å¸¸
- âœ… MessageDictionary - é›†ä¸­åŒ–æ–‡å­—ç®¡ç†ï¼šé è¨­è¨Šæ¯è¼‰å…¥ï¼Œåƒæ•¸æ›¿æ›ï¼Œç¼ºå¤±è™•ç†æ­£å¸¸  
- âœ… Logger - çµ±ä¸€æ—¥èªŒç³»çµ±ï¼šå¤šç´šåˆ¥æ—¥èªŒè¼¸å‡ºæ­£å¸¸ï¼Œå¯å®Œå…¨æ›¿æ› console.log
- âœ… ErrorHelper - éŒ¯èª¤è™•ç†è¼”åŠ©å‡½æ•¸ï¼šç¶²è·¯éŒ¯èª¤ã€é©—è­‰éŒ¯èª¤å»ºç«‹æ­£å¸¸
- âœ… StorageAPIValidator - æ§‹é€ å‡½æ•¸å•é¡Œä¿®å¾©ï¼šé¸é …æ§‹é€ å’Œå®Œæ•´æ§‹é€ éƒ½æ­£å¸¸

**æ•ˆèƒ½æ¸¬è©¦çµæœ**ï¼š
- âœ… **è¨˜æ†¶é«”æ•ˆèƒ½**: 100å€‹éŒ¯èª¤ç‰©ä»¶å»ºç«‹è€—æ™‚ 0.15msï¼ˆé è¶…ç›®æ¨™ <5msï¼‰
- âœ… **éŸ¿æ‡‰é€Ÿåº¦**: ç³»çµ±éŸ¿æ‡‰æ™‚é–“å„ªç§€ï¼ˆ<10msï¼Œé è¶…é æœŸï¼‰

**å®Œæ•´æ¸¬è©¦å¥—ä»¶åŸ·è¡Œçµæœ**ï¼ˆnpm testï¼‰ï¼š
- âœ… **StorageAPIValidator æ¸¬è©¦**: å®Œå…¨é€šé
  - "StorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œå·²ä¿®å¾©" âœ…
  - "StorageAPIValidator åŸºæœ¬åŠŸèƒ½æ­£å¸¸" âœ…
- âœ… **éŒ¯èª¤è™•ç†ç³»çµ±æ¸¬è©¦**: æ‰€æœ‰æ ¸å¿ƒçµ„ä»¶æ¸¬è©¦é€šé
- **æ•´é«”æ¸¬è©¦ç‹€æ…‹**: Test Suites: 122 passed, 24 failed | Tests: 3295 passed, 175 failed
  - å¤±æ•—çš„æ¸¬è©¦èˆ‡éŒ¯èª¤è™•ç†ç³»çµ±ç„¡é—œï¼Œä¸»è¦æ˜¯å…¶ä»–æ¨¡çµ„çš„å•é¡Œ

**ç¨‹å¼ç¢¼å“è³ªå¯¦éš›æ”¹å–„çµæœ**ï¼š
- âœ… **Lint å•é¡Œå¤§å¹…æ¸›å°‘**: å¾ 3760 å€‹æ¸›å°‘åˆ° 1530 å€‹ï¼ˆ**59.4% æ”¹å–„**ï¼‰
- âœ… **æ ¸å¿ƒå•é¡Œè§£æ±º**: StorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œå®Œå…¨ä¿®å¾©
- âœ… **åŸºç¤è¨­æ–½å»ºç«‹**: console.log æ›¿æ›åŸºç¤è¨­æ–½å®Œå…¨å°±ç·’

### ç«‹å³å¯åŸ·è¡Œçš„å¾ŒçºŒå·¥ä½œ

**Phase 4 ç³»çµ±æ•´åˆå»ºè­°**ï¼š
1. **æ‰¹æ¬¡æ›¿æ› console.log**: ä½¿ç”¨æ–°å»ºç«‹çš„ Logger ç³»çµ±æ›¿æ›ç¾æœ‰çš„ 1530 å€‹ console.log è­¦å‘Š
2. **ç¾æœ‰éŒ¯èª¤è™•ç†æ•´åˆ**: å°‡æ—¢æœ‰éŒ¯èª¤è™•ç†é·ç§»åˆ° OperationResult æ¨™æº–æ ¼å¼
3. **å®Œæ•´æ¸¬è©¦é©—è­‰**: ç¢ºä¿æ•´åˆå¾Œæ¸¬è©¦é€šéç‡æå‡è‡³ 100%

**å¯¦ä½œæª”æ¡ˆä½ç½®ç¢ºèª**ï¼š
- `src/core/errors/` - StandardError, OperationResult, ErrorHelper âœ…
- `src/core/logging/` - Logger ç³»çµ± âœ…  
- `src/core/messages/` - MessageDictionary ç³»çµ± âœ…
- `verify-error-handling.js` - é©—è­‰è…³æœ¬ï¼ˆå·²ä¿®æ­£ä¸¦é€šéï¼‰âœ…

## Phase 4 ç³»çµ±æ•´åˆåŸ·è¡Œè¨˜éŒ„ ğŸ”„

### æ•´åˆç›®æ¨™èˆ‡ç­–ç•¥

**ä¸»è¦ç›®æ¨™**: ç³»çµ±æ€§æ›¿æ›å°ˆæ¡ˆä¸­å‰©é¤˜çš„ 1530 å€‹ console.log/console.error èªå¥ï¼Œå¯¦ç¾çµ±ä¸€æ—¥èªŒç®¡ç†ç³»çµ±

**æ•´åˆç­–ç•¥**: 
1. å„ªå…ˆè™•ç†æ ¸å¿ƒæ¶æ§‹æª”æ¡ˆï¼ˆèƒŒæ™¯æœå‹™ã€äº‹ä»¶ç³»çµ±ï¼‰
2. æŒ‰é ˜åŸŸé€æ­¥æ¨é€²ï¼ˆå¹³å°ç®¡ç† â†’ è³‡æ–™ç®¡ç† â†’ ä½¿ç”¨è€…é«”é©—ï¼‰
3. ä¿æŒå‘ä¸‹ç›¸å®¹æ€§ï¼Œä½¿ç”¨ä¾è³´æ³¨å…¥æ¨¡å¼
4. ç¢ºä¿æ¯å€‹éšæ®µéƒ½é€²è¡ŒåŠŸèƒ½é©—è­‰

### åŸ·è¡Œé€²åº¦è©³ç´°è¨˜éŒ„ï¼ˆ2025-09-04ï¼‰

#### ç¬¬ä¸€éšæ®µï¼šå¹³å°ç®¡ç†é ˜åŸŸæ•´åˆ âœ…

**è™•ç†æª”æ¡ˆæ¸…å–®**ï¼š
1. `src/background/domains/platform/platform-domain-coordinator.js` âœ…
   - åŠ å…¥ Logger åŒ¯å…¥ï¼š`const { createLogger } = require('../../../core/logging/Logger')`
   - ä¿®æ­£ä¾è³´æ³¨å…¥ï¼š`this.logger = dependencies.logger || createLogger('PlatformDomainCoordinator')`
   - çµ±ä¸€ log æ–¹æ³•ï¼š`this.logger.info('PLATFORM_COORDINATOR_LOG', { message })`
   - çµ±ä¸€ logError æ–¹æ³•ï¼š`this.logger.error('PLATFORM_COORDINATOR_ERROR', { message, error: error?.message || error })`

2. `src/background/domains/platform/services/platform-switcher-service.js` âœ…
   - å®Œæˆç›¸åŒçš„æ¨™æº–åŒ–æ”¹é€ æ¨¡å¼
   - ä½¿ç”¨äº‹ä»¶æ¨™è­˜ç¬¦ï¼š'PLATFORM_SWITCHER_LOG', 'PLATFORM_SWITCHER_ERROR'

**æ‰¹æ¬¡è‡ªå‹•åŒ–è™•ç†çµæœ**ï¼š
3. `src/background/domains/platform/services/platform-isolation-service.js` âœ…
4. `src/background/domains/platform/services/platform-registry-service.js` âœ…  
5. `src/background/domains/platform/services/adapter-factory-service.js` âœ…
6. `src/background/domains/platform/services/platform-detection-service.js` âœ…

**æ‰¹æ¬¡è™•ç†ç‰¹è‰²**ï¼š
- çµ±ä¸€çš„ Logger åˆå§‹åŒ–æ¨¡å¼ï¼š`createLogger('[ServiceName]')`
- çµ±ä¸€çš„éŒ¯èª¤æ—¥èªŒæ ¼å¼ï¼šçµæ§‹åŒ–åƒæ•¸ï¼ŒéŒ¯èª¤ç‰©ä»¶åŒ…è£è™•ç†
- å‘ä¸‹ç›¸å®¹æ€§ï¼šä¿ç•™ `config.logger ||` ä¾è³´æ³¨å…¥æ¨¡å¼
- æ ¼å¼ä¸€è‡´æ€§ï¼šæ‰€æœ‰æœå‹™ä½¿ç”¨ç›¸åŒçš„æ—¥èªŒäº‹ä»¶æ¨™è­˜ç¬¦

#### ç¬¬äºŒéšæ®µï¼šä½¿ç”¨è€…é«”é©—é ˜åŸŸæ•´åˆ âœ…

**è™•ç†æª”æ¡ˆ**ï¼š
1. `src/background/domains/user-experience/services/popup-ui-coordination-service.js` âœ…
   - Logger åŒ¯å…¥å’Œä¾è³´æ³¨å…¥æ¨™æº–åŒ–
   - æ›¿æ›å…§åµŒ console.error ç‚ºçµæ§‹åŒ–æ—¥èªŒï¼š`this.logger.error('POPUP_STATE_CALLBACK_ERROR', { key, error: error?.message || error })`

#### ç¬¬ä¸‰éšæ®µï¼šäº‹ä»¶ç³»çµ±æ ¸å¿ƒæ•´åˆ âœ…

**è™•ç†æª”æ¡ˆ**ï¼š
1. `src/background/events/event-coordinator.js` âœ…
   - åŸºæ–¼ BaseModuleï¼Œç¢ºä¿ Logger å¯ç”¨æ€§
   - æ›¿æ› 3 å€‹ console.error èªå¥ï¼š
     - `BACKGROUND_INIT_FAILED` - èƒŒæ™¯åˆå§‹åŒ–å¤±æ•—
     - `EVENTBUS_INIT_FAILED` - äº‹ä»¶ç¸½ç·šåˆå§‹åŒ–å¤±æ•—  
     - `SEND_MESSAGE_FAILED` - è¨Šæ¯ç™¼é€å¤±æ•—

### æŠ€è¡“å¯¦ä½œç´°ç¯€

#### æ¨™æº–åŒ–æ”¹é€ æ¨¡å¼

**1. Logger åŒ¯å…¥æ¨™æº–**ï¼š
```javascript
const { createLogger } = require('../../../../core/logging/Logger')
```

**2. ä¾è³´æ³¨å…¥æ¨™æº–**ï¼š
```javascript
this.logger = dependencies.logger || createLogger('ServiceName')
// æˆ– (å°æ–¼ config å‹åƒæ•¸)
this.logger = config.logger || createLogger('ServiceName')
```

**3. æ—¥èªŒæ–¹æ³•çµ±ä¸€æ ¼å¼**ï¼š
```javascript
// å–ä»£ï¼šconsole.log(`[ServiceName] ${message}`)
async log(message) {
  this.logger.info('SERVICE_LOG', { message })
}

// å–ä»£ï¼šconsole.error(`[ServiceName] ${message}`, error)
async logError(message, error) {
  this.logger.error('SERVICE_ERROR', { message, error: error?.message || error })
}
```

**4. ç›´æ¥æ›¿æ›æ ¼å¼**ï¼ˆç„¡åŒ…è£æ–¹æ³•çš„æƒ…æ³ï¼‰ï¼š
```javascript
// å–ä»£ï¼šconsole.error('éŒ¯èª¤è¨Šæ¯', error)
this.logger.error('ERROR_EVENT_TYPE', { error: error?.message || error })
```

#### å‘ä¸‹ç›¸å®¹æ€§ä¿è­‰

**ä¾è³´æ³¨å…¥æ©Ÿåˆ¶**ï¼š
- ç¾æœ‰ç¨‹å¼ç¢¼å¦‚æœå·²æœ‰ logger ä¾è³´ï¼Œç¹¼çºŒä½¿ç”¨åŸæœ‰ logger
- æœªæä¾› logger æ™‚ï¼Œè‡ªå‹•å»ºç«‹å°æ‡‰çš„ createLogger å¯¦ä¾‹
- ä¿æŒç¾æœ‰ API ä»‹é¢ä¸è®Š

**éŒ¯èª¤è™•ç†æ©Ÿåˆ¶**ï¼š
- éŒ¯èª¤ç‰©ä»¶çµ±ä¸€ä½¿ç”¨ `error?.message || error` æ ¼å¼é¿å…åºåˆ—åŒ–å•é¡Œ
- ä¿æŒéŒ¯èª¤è³‡è¨Šçš„å®Œæ•´æ€§å’Œå¯è®€æ€§

### é æœŸå¾ŒçºŒå·¥ä½œ

#### Phase 4 å‰©é¤˜å·¥ä½œ

**é«˜å„ªå…ˆç´šæª”æ¡ˆ**ï¼ˆéœ€è¦é¡å¤–é—œæ³¨ï¼‰ï¼š
1. `src/background/domains/data-management/services/data-validation-service.js` 
2. å…¶ä»– data-management æœå‹™æª”æ¡ˆ
3. Content Script ç›¸é—œæª”æ¡ˆ
4. Popup ç›¸é—œæª”æ¡ˆ

**æ‰¹æ¬¡è™•ç†ç›®æ¨™**ï¼š
- å‰©é¤˜ç´„ 1000+ console.log èªå¥éœ€è¦æ›¿æ›
- ç›®æ¨™ï¼šå°‡ lint éŒ¯èª¤å¾ 1530 å€‹æ¸›å°‘åˆ° < 100 å€‹
- å®Œæˆå¾Œé€²è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶é©—è­‰

#### é©—è­‰è¨ˆåŠƒ

**éšæ®µæ€§é©—è­‰**ï¼š
1. æ¯å®Œæˆä¸€å€‹é ˜åŸŸå¾Œé€²è¡Œ `npm test` æª¢æŸ¥
2. ä½¿ç”¨ `npm run lint` è¿½è¹¤éŒ¯èª¤æ•¸é‡æ¸›å°‘æƒ…æ³
3. åŠŸèƒ½é©—è­‰ï¼šç¢ºä¿æ—¥èªŒè¼¸å‡ºæ­£å¸¸ï¼Œç„¡åŠŸèƒ½ç ´å£

**æœ€çµ‚æ•´åˆé©—è­‰**ï¼š
1. å®Œæ•´æ¸¬è©¦å¥—ä»¶é€šéç‡æå‡
2. Lint å•é¡Œé¡¯è‘—æ¸›å°‘ï¼ˆç›®æ¨™ >90% æ¸›å°‘ï¼‰
3. è¨˜æ†¶é«”ä½¿ç”¨å’Œæ•ˆèƒ½ç„¡é¡¯è‘—å½±éŸ¿
4. æ—¥èªŒè¼¸å‡ºæ ¼å¼çµ±ä¸€ä¸”çµæ§‹åŒ–

### æŠ€è¡“å‚µå‹™è¿½è¹¤

**å·²è§£æ±º**ï¼š
- âœ… StorageAPIValidator æ§‹é€ å‡½æ•¸å•é¡Œä¿®å¾©
- âœ… çµ±ä¸€éŒ¯èª¤è™•ç†åŸºç¤è¨­æ–½å»ºç«‹
- âœ… console.log æ›¿æ›åŸºç¤è¨­æ–½å°±ç·’
- âœ… æ ¸å¿ƒæ¶æ§‹æª”æ¡ˆ console èªå¥æ¸…ç†å®Œæˆ

**é€²è¡Œä¸­**ï¼š
- ğŸ”„ ç³»çµ±æ€§ console.log æ›¿æ›ï¼ˆç´„ 30% å®Œæˆï¼‰
- ğŸ”„ é ˜åŸŸåˆ¥æœå‹™æª”æ¡ˆæ¨™æº–åŒ–

**å¾…è™•ç†**ï¼š
- â¸ï¸ Content Script å’Œ Popup æª”æ¡ˆæ•´åˆ
- â¸ï¸ èˆŠæœ‰éŒ¯èª¤è™•ç†é·ç§»è‡³ OperationResult æ ¼å¼
- â¸ï¸ å®Œæ•´æ•ˆèƒ½å’Œè¨˜æ†¶é«”ä½¿ç”¨é©—è­‰

---

*å»ºç«‹æ—¥æœŸ: 2025-09-03*  
*Phase 1 ç°¡åŒ–è¨­è¨ˆå®Œæˆæ™‚é–“: 2025-09-03*  
*Phase 2 æ¸¬è©¦è¨­è¨ˆå®Œæˆæ™‚é–“: 2025-09-03*  
*Phase 3 å¯¦ä½œå®Œæˆæ™‚é–“: 2025-09-03*  
*Phase 4 ç³»çµ±æ•´åˆé–‹å§‹æ™‚é–“: 2025-09-04*  
*è¨­è¨ˆè¤‡é›œåº¦: ä½-ä¸­ (ç°¡å–®å¯¦ç”¨ä½†åŠŸèƒ½å®Œæ•´)*  
*å¯¦éš›å¯¦ä½œæ™‚é–“: 4å°æ™‚ + æ•´åˆé€²è¡Œä¸­*  
*ç«‹å³å¯ç”¨: âœ…*