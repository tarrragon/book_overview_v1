# UC-01 ç«¯åˆ°ç«¯æ•´åˆæ¸¬è©¦é‡æ§‹è¨­è¨ˆå·¥ä½œæ—¥èªŒ

**ç‰ˆæœ¬**: v0.9.38  
**å»ºç«‹æ™‚é–“**: 2025-08-25  
**é‡æ§‹é¡å‹**: TDD Phase 4 - é‡æ§‹è¨­è¨ˆå¸«  
**åŠŸèƒ½åç¨±**: UC-01 æ›¸ç±è³‡æ–™æå–å®Œæ•´æµç¨‹ç«¯åˆ°ç«¯æ•´åˆæ¸¬è©¦é‡æ§‹  
**å‰ç½®éšæ®µ**: TDD Phase 1-3 å·²å®Œæˆï¼Œå¯¦ä½œè¦åŠƒå®Œæˆï¼Œå¾…é‡æ§‹å“è³ªæ”¹å–„

---

## ğŸ“ Phase 1: é‡æ§‹è¨ˆåŠƒèˆ‡å·¥ä½œæ—¥èªŒå»ºç«‹

### ğŸ¯ é‡æ§‹å‹•æ©Ÿèˆ‡ç›®æ¨™

#### ç‚ºä»€éº¼è¦é‡æ§‹ï¼Ÿ

**ç•¶å‰æ¶æ§‹çš„å…·é«”å•é¡Œ**ï¼š

1. **æ¸¬è©¦åŸºç¤è¨­æ–½åˆ†æ•£èˆ‡é‡è¤‡**ï¼š
   - å„å€‹æ¨¡æ“¬å™¨ï¼ˆQuickChromeAPIMockã€TestDataFactoryç­‰ï¼‰åˆ†æ•£åœ¨ä¸åŒæª”æ¡ˆ
   - Mock å¯¦ä½œç¼ºä¹çµ±ä¸€æŠ½è±¡ï¼Œè¡Œç‚ºä¸ä¸€è‡´
   - æ¸¬è©¦è¨­ç½®ä»£ç¢¼é‡è¤‡ç‡é«˜é”70%ï¼Œç¶­è­·æˆæœ¬å¢åŠ 

2. **æ¬Šå®œæ–¹æ¡ˆçš„æŠ€è¡“å‚µå‹™**ï¼š
   - `QuickChromeAPIMock.setupMinimalMocks()` åƒ…è¿”å›å›ºå®šå€¼ï¼Œç¼ºä¹çœŸå¯¦è¡Œç‚ºæ¨¡æ“¬
   - `getCurrentMemoryUsage()` ç°¡åŒ–ç‰ˆè¨˜æ†¶é«”ç›£æ§ç²¾ç¢ºåº¦ä¸è¶³
   - Chrome Extensionç’°å¢ƒæ¨¡æ“¬ä¸å®Œæ•´ï¼Œç„¡æ³•å……åˆ†é©—è­‰çœŸå¯¦å ´æ™¯

3. **ç¨‹å¼ç¢¼å“è³ªä¸ç¬¦åˆå°ˆæ¡ˆæ¨™æº–**ï¼š
   - å¤šå€‹æ–¹æ³•è¶…é Five Lines è¦å‰‡é™åˆ¶ï¼ˆ30è¡Œä»¥ä¸Šï¼‰
   - å–®ä¸€è²¬ä»»åŸå‰‡é•åï¼šæ¸¬è©¦è¨­ç½®æ–¹æ³•æ‰¿æ“”éå¤šè·è²¬
   - éŒ¯èª¤è™•ç†æ©Ÿåˆ¶åˆ†æ•£ï¼Œç¼ºä¹çµ±ä¸€ç­–ç•¥

4. **ç¶­è­·æ€§å’Œæ“´å±•æ€§å•é¡Œ**ï¼š
   - æ–°å¢æ¸¬è©¦æ¡ˆä¾‹éœ€è¦é‡è¤‡å¤§é‡è¨­ç½®ä»£ç¢¼
   - Mock è¡Œç‚ºä¿®æ”¹å½±éŸ¿å¤šå€‹æ¸¬è©¦æª”æ¡ˆ
   - ç¼ºä¹æ¸…æ™°çš„çµ„ä»¶é–“æ¥å£å®šç¾©

#### é‡æ§‹å¾ŒæœŸæœ›é”æˆçš„ç‹€æ…‹æ˜¯ä»€éº¼ï¼Ÿ

**é‡æ§‹ç›®æ¨™ç‹€æ…‹**ï¼š

1. **çµ±ä¸€çš„æ¸¬è©¦åŸºç¤è¨­æ–½**ï¼š
   - å»ºç«‹ `TestInfrastructureFactory` çµ±ä¸€ç®¡ç†æ‰€æœ‰æ¸¬è©¦çµ„ä»¶
   - å¯¦ç¾ Factory Pattern + Builder Pattern è¨­è¨ˆ
   - æ¸¬è©¦è¨­ç½®ä»£ç¢¼é‡è¤‡ç‡é™è‡³10%ä»¥ä¸‹

2. **ç¬¦åˆå°ˆæ¡ˆå“è³ªæ¨™æº–çš„ç¨‹å¼ç¢¼**ï¼š
   - æ‰€æœ‰æ–¹æ³•éµå¾ª Five Lines è¦å‰‡
   - å¯¦ç¾å–®ä¸€è²¬ä»»åŸå‰‡ï¼Œæ¯å€‹å‡½æ•¸è·è²¬æ˜ç¢º
   - çµ±ä¸€çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„æ©Ÿåˆ¶

3. **é«˜å“è³ªçš„ Chrome API Mock ç³»çµ±**ï¼š
   - å»ºç«‹ `ChromeAPIMockRegistry` çµ±ä¸€ç®¡ç†æ‰€æœ‰ Chrome API Mock
   - å¯¦ç¾è¡Œç‚ºä¸€è‡´æ€§å’Œå¯é æ¸¬æ€§
   - æ”¯æ´ä¸åŒæ¸¬è©¦å ´æ™¯çš„å‹•æ…‹é…ç½®

4. **å¯æ“´å±•çš„æ¸¬è©¦æ¶æ§‹**ï¼š
   - æ–°æ¸¬è©¦æ¡ˆä¾‹å¯å¿«é€Ÿå»ºç«‹ï¼Œè¨­ç½®ä»£ç¢¼æœ€å°åŒ–
   - æ¸¬è©¦çµ„ä»¶é«˜åº¦å¯é‡ç”¨ï¼Œç¶­è­·æˆæœ¬æœ€å°
   - æ”¯æ´æœªä¾†åŠŸèƒ½æ“´å±•çš„æ¸¬è©¦éœ€æ±‚

#### é€™å€‹é‡æ§‹å¦‚ä½•è§£æ±ºæ ¸å¿ƒå•é¡Œï¼Ÿ

**å•é¡Œè§£æ±ºç­–ç•¥**ï¼š

1. **çµ±ä¸€æŠ½è±¡è§£æ±ºåˆ†æ•£å•é¡Œ**ï¼šé€é Factory Pattern å»ºç«‹çµ±ä¸€çš„æ¸¬è©¦çµ„ä»¶å‰µå»ºå’Œç®¡ç†æ©Ÿåˆ¶
2. **æ‹†åˆ†é‡æ§‹è§£æ±ºè·è²¬æ··äº‚**ï¼šæŒ‰ç…§ Five Lines è¦å‰‡æ‹†åˆ†å¤§æ–¹æ³•ï¼Œå¯¦ç¾å–®ä¸€è²¬ä»»
3. **æ¨¡å¼é‡æ§‹è§£æ±ºé‡è¤‡å•é¡Œ**ï¼šä½¿ç”¨ Builder Pattern ç°¡åŒ–æ¸¬è©¦é…ç½®ï¼Œæé«˜ä»£ç¢¼é‡ç”¨æ€§
4. **æ¥å£æ¨™æº–åŒ–è§£æ±ºä¸€è‡´æ€§å•é¡Œ**ï¼šå»ºç«‹æ˜ç¢ºçš„çµ„ä»¶æ¥å£ï¼Œç¢ºä¿è¡Œç‚ºä¸€è‡´æ€§

### ğŸ” å½±éŸ¿ç¯„åœåˆ†æ

#### å“ªäº›æª”æ¡ˆæœƒè¢«ä¿®æ”¹ï¼Ÿ

**æ ¸å¿ƒæª”æ¡ˆä¿®æ”¹ç¯„åœ**ï¼š

1. **æ¸¬è©¦åŸºç¤è¨­æ–½æª”æ¡ˆ**ï¼š
   - `tests/helpers/chrome-extension-mocks-enhanced.js` - é‡æ§‹Chrome API Mockæ©Ÿåˆ¶
   - `tests/helpers/error-injector.js` - é‡æ§‹éŒ¯èª¤æ³¨å…¥æ©Ÿåˆ¶ï¼Œç¬¦åˆFive Linesè¦å‰‡
   - `tests/helpers/chrome-extension-environment-simulator.js` - é‡æ§‹ç’°å¢ƒæ¨¡æ“¬å™¨

2. **æ–°å¢çµ±ä¸€ç®¡ç†æª”æ¡ˆ**ï¼š
   - `tests/infrastructure/test-infrastructure-factory.js` - æ–°å»ºæ¸¬è©¦åŸºç¤è¨­æ–½å·¥å» 
   - `tests/infrastructure/chrome-api-mock-registry.js` - æ–°å»ºChrome API Mockè¨»å†Šè¡¨
   - `tests/infrastructure/test-configuration-builder.js` - æ–°å»ºæ¸¬è©¦é…ç½®å»ºæ§‹å™¨

3. **æ¸¬è©¦æª”æ¡ˆé‡æ§‹**ï¼š
   - `tests/e2e/e2e-book-extraction-workflow.test.js` - é‡æ§‹æ¸¬è©¦è¨­ç½®é‚è¼¯
   - ç›¸é—œçš„å–®å…ƒæ¸¬è©¦å’Œæ•´åˆæ¸¬è©¦æª”æ¡ˆ - çµ±ä¸€æ¸¬è©¦è¨­ç½®æ–¹å¼

#### å“ªäº›åŠŸèƒ½çš„è¡Œç‚ºæœƒæ”¹è®Šï¼Ÿ

**è¡Œç‚ºæ”¹è®Šåˆ†æ**ï¼š

1. **æ¸¬è©¦è¨­ç½®è¡Œç‚º**ï¼š
   - **åŸè¡Œç‚º**ï¼šå„æ¸¬è©¦æª”æ¡ˆè‡ªè¡Œè¨­ç½®Mockå’Œæ¸¬è©¦ç’°å¢ƒ
   - **æ–°è¡Œç‚º**ï¼šé€éçµ±ä¸€å·¥å» å»ºç«‹æ¨™æº–åŒ–æ¸¬è©¦ç’°å¢ƒ
   - **å½±éŸ¿**ï¼šæ¸¬è©¦è¨­ç½®æ›´ç°¡æ½”ï¼Œä½†éœ€è¦ç†Ÿæ‚‰æ–°çš„API

2. **Chrome API Mock è¡Œç‚º**ï¼š
   - **åŸè¡Œç‚º**ï¼šå›ºå®šè¿”å›å€¼ï¼Œè¡Œç‚ºç°¡åŒ–
   - **æ–°è¡Œç‚º**ï¼šæ›´ç²¾ç¢ºæ¨¡æ“¬çœŸå¯¦Chrome APIï¼Œæ”¯æ´å‹•æ…‹è¡Œç‚º
   - **å½±éŸ¿**ï¼šæ¸¬è©¦æ›´æº–ç¢ºï¼Œä½†æŸäº›æ¸¬è©¦å¯èƒ½éœ€è¦èª¿æ•´é æœŸçµæœ

3. **éŒ¯èª¤è™•ç†è¡Œç‚º**ï¼š
   - **åŸè¡Œç‚º**ï¼šåˆ†æ•£å¼éŒ¯èª¤è™•ç†ï¼Œä¸ä¸€è‡´çš„éŒ¯èª¤æ ¼å¼
   - **æ–°è¡Œç‚º**ï¼šçµ±ä¸€éŒ¯èª¤è™•ç†ç­–ç•¥å’Œæ ¼å¼
   - **å½±éŸ¿**ï¼šéŒ¯èª¤æ¸¬è©¦æ›´å¯é ï¼Œä½†éœ€è¦æ›´æ–°éŒ¯èª¤æ¸¬è©¦æ¡ˆä¾‹

#### å“ªäº› API æˆ–ä»‹é¢æœƒå—å½±éŸ¿ï¼Ÿ

**API ä»‹é¢å½±éŸ¿**ï¼š

1. **æ¸¬è©¦è¨­ç½® API**ï¼š

   ```javascript
   // èˆŠ API
   const mocks = new ChromeExtensionMocksEnhanced()
   await mocks.setupBasicMocks()

   // æ–° API
   const testEnv = TestInfrastructureFactory.createE2EEnvironment()
     .withChromeAPIMock()
     .withErrorInjection()
     .build()
   ```

2. **Chrome API Mock ä»‹é¢**ï¼š

   ```javascript
   // èˆŠä»‹é¢
   QuickChromeAPIMock.setupMinimalMocks()

   // æ–°ä»‹é¢
   ChromeAPIMockRegistry.register('storage.local', new StorageLocalMock())
     .register('runtime', new RuntimeMock())
     .activate()
   ```

### ğŸ§ª æ¸¬è©¦é æœŸç®¡ç†

#### é æœŸæœƒé€šéçš„æ¸¬è©¦ï¼š

**æ‡‰è©²ç¹¼çºŒé€šéçš„æ¸¬è©¦åŠåŸå› **ï¼š

1. **ç¾æœ‰ç«¯åˆ°ç«¯æ¸¬è©¦** (`tests/e2e/e2e-book-extraction-workflow.test.js`):
   - **æ¸¬è©¦åç¨±**: æ‰€æœ‰25å€‹E2Eæ¸¬è©¦æ¡ˆä¾‹
   - **é€šéåŸå› **: é‡æ§‹åªæ”¹å–„å¯¦ä½œå“è³ªï¼Œä¸æ”¹è®Šæ¸¬è©¦é‚è¼¯å’Œé æœŸçµæœ
   - **é©—è­‰é»**: æ¸¬è©¦æµç¨‹ã€æ–·è¨€å’Œé æœŸçµæœä¿æŒä¸è®Š

2. **åŸºç¤è¨­æ–½ç›¸é—œæ¸¬è©¦**:
   - **æ¸¬è©¦æª”æ¡ˆ**: `tests/unit/helpers/chrome-extension-mocks-enhanced.test.js`
   - **é€šéåŸå› **: Mock è¡Œç‚ºèªç¾©ä¿æŒä¸€è‡´ï¼Œåƒ…å…§éƒ¨å¯¦ä½œé‡æ§‹
   - **é©—è­‰é»**: Chrome API Mock çš„è¿”å›å€¼å’Œè¡Œç‚ºæ¨¡å¼ä¸€è‡´

3. **éŒ¯èª¤è™•ç†æ¸¬è©¦**:
   - **æ¸¬è©¦æª”æ¡ˆ**: `tests/unit/helpers/error-injector.test.js`
   - **é€šéåŸå› **: éŒ¯èª¤æ³¨å…¥é‚è¼¯ä¸è®Šï¼Œåƒ…ä»£ç¢¼çµæ§‹é‡æ§‹
   - **é©—è­‰é»**: éŒ¯èª¤é¡å‹å’ŒéŒ¯èª¤è¨Šæ¯æ ¼å¼ä¿æŒä¸€è‡´

#### é æœŸæœƒå¤±æ•—çš„æ¸¬è©¦ï¼š

**å¯èƒ½æš«æ™‚å¤±æ•—çš„æ¸¬è©¦åŠä¿®æ­£ç­–ç•¥**ï¼š

1. **æ¸¬è©¦è¨­ç½®ç›¸é—œæ¸¬è©¦**:
   - **æ¸¬è©¦åç¨±**: ä¾è³´èˆŠæ¸¬è©¦è¨­ç½®APIçš„å–®å…ƒæ¸¬è©¦
   - **å¤±æ•—åŸå› **: API ä»‹é¢æ”¹è®Šï¼Œæ¸¬è©¦éœ€è¦æ›´æ–°å¼•ç”¨æ–¹å¼
   - **ä¿®æ­£æ–¹æ³•**: æ›´æ–°æ¸¬è©¦ä¸­çš„importå’ŒAPIèª¿ç”¨ï¼Œä½¿ç”¨æ–°çš„Factory API
   - **é ä¼°ä¿®æ­£æ™‚é–“**: æ¯å€‹æ¸¬è©¦æª”æ¡ˆ5-10åˆ†é˜

2. **Chrome API Mock ä¾è³´æ¸¬è©¦**:
   - **æ¸¬è©¦æª”æ¡ˆ**: ç›´æ¥ä½¿ç”¨ `QuickChromeAPIMock` çš„æ¸¬è©¦
   - **å¤±æ•—åŸå› **: Mock é¡åˆ¥é‡æ§‹ï¼ŒAPI åç¨±å’Œä½¿ç”¨æ–¹å¼æ”¹è®Š
   - **ä¿®æ­£æ–¹æ³•**: æ›´æ–°ç‚ºä½¿ç”¨ `ChromeAPIMockRegistry` çš„æ–°API
   - **é ä¼°ä¿®æ­£æ™‚é–“**: 15-20åˆ†é˜

3. **æ•´åˆæ¸¬è©¦çš„è¨­ç½®æª¢æŸ¥**:
   - **æ¸¬è©¦é¡å‹**: æª¢æŸ¥Mockè¨­ç½®ç‹€æ…‹çš„æ¸¬è©¦
   - **å¤±æ•—åŸå› **: å…§éƒ¨ç‹€æ…‹æª¢æŸ¥APIæ”¹è®Š
   - **ä¿®æ­£æ–¹æ³•**: æ›´æ–°ç‹€æ…‹æª¢æŸ¥é‚è¼¯ï¼Œä½¿ç”¨æ–°çš„ç‹€æ…‹æŸ¥è©¢API
   - **é ä¼°ä¿®æ­£æ™‚é–“**: 10-15åˆ†é˜

#### ä¸ç¢ºå®šçš„æ¸¬è©¦ï¼š

**éœ€è¦ç‰¹åˆ¥æ³¨æ„çš„æ¸¬è©¦æƒ…æ³**ï¼š

1. **æ•ˆèƒ½ç›¸é—œæ¸¬è©¦**:
   - **æ¸¬è©¦æª”æ¡ˆ**: `tests/performance/memory-monitoring.test.js`
   - **ä¸ç¢ºå®šåŸå› **: é‡æ§‹å¯èƒ½å½±éŸ¿è¨˜æ†¶é«”ç›£æ§çš„ç²¾ç¢ºåº¦å’Œæ•ˆèƒ½è¡¨ç¾
   - **æ³¨æ„äº‹é …**: éœ€è¦ä»”ç´°é©—è­‰é‡æ§‹å¾Œçš„æ•ˆèƒ½åŸºæº–æ˜¯å¦ç¬¦åˆé æœŸ
   - **æ‡‰å°ç­–ç•¥**: åŸ·è¡Œå®Œæ•´æ•ˆèƒ½æ¸¬è©¦ï¼Œæ¯”è¼ƒé‡æ§‹å‰å¾Œçš„æ•ˆèƒ½æ•¸æ“š

2. **ç•°æ­¥äº‹ä»¶æ™‚åºæ¸¬è©¦**:
   - **æ¸¬è©¦é¡å‹**: ä¾è³´äº‹ä»¶è§¸ç™¼é †åºçš„ç«¯åˆ°ç«¯æ¸¬è©¦
   - **ä¸ç¢ºå®šåŸå› **: é‡æ§‹å¯èƒ½å½±éŸ¿äº‹ä»¶è™•ç†çš„æ™‚åºå’Œå„ªå…ˆç´š
   - **æ³¨æ„äº‹é …**: äº‹ä»¶é©…å‹•æ¶æ§‹ä¸­çš„æ™‚åºæ•æ„Ÿæ¸¬è©¦å¯èƒ½å—å½±éŸ¿
   - **æ‡‰å°ç­–ç•¥**: å¢åŠ äº‹ä»¶æ™‚åºçš„å®¹éŒ¯ç¯„åœï¼Œæˆ–èª¿æ•´æ¸¬è©¦çš„æ™‚åºæª¢æŸ¥é‚è¼¯

3. **Chrome Extension ç’°å¢ƒæ¨¡æ“¬æ¸¬è©¦**:
   - **æ¸¬è©¦ç¯„åœ**: ä¾è³´ç²¾ç¢ºChrome APIè¡Œç‚ºçš„æ¸¬è©¦
   - **ä¸ç¢ºå®šåŸå› **: æ›´ç²¾ç¢ºçš„Mockå¯èƒ½æš´éœ²ä¹‹å‰è¢«å¿½ç•¥çš„APIè¡Œç‚ºå·®ç•°
   - **æ³¨æ„äº‹é …**: æŸäº›æ¸¬è©¦å¯èƒ½å› ç‚ºMockè¡Œç‚ºæ›´æ¥è¿‘çœŸå¯¦è€Œéœ€è¦èª¿æ•´
   - **æ‡‰å°ç­–ç•¥**: æº–å‚™å›é€€åˆ°èˆŠMockè¡Œç‚ºçš„é¸é …ï¼Œæˆ–èª¿æ•´æ¸¬è©¦é æœŸ

### ğŸ“Š æˆåŠŸæ¨™æº–è¨­å®š

#### æ¸¬è©¦çµæœç¬¦åˆé æœŸçš„æ¨™æº–æ˜¯ä»€éº¼ï¼Ÿ

**æ¸¬è©¦é€šéæ¨™æº–**ï¼š

1. **åŸºæœ¬é€šéç‡è¦æ±‚**ï¼š
   - æ‰€æœ‰ç¾æœ‰æ¸¬è©¦å¿…é ˆä¿æŒ100%é€šéç‡
   - æ–°å¢çš„é‡æ§‹é©—è­‰æ¸¬è©¦å¿…é ˆ100%é€šé
   - ä¸å…è¨±å› é‡æ§‹å°è‡´ä»»ä½•æ¸¬è©¦é€€åŒ–

2. **åŠŸèƒ½å®Œæ•´æ€§é©—è­‰**ï¼š
   - UC-01 ç«¯åˆ°ç«¯å·¥ä½œæµç¨‹å®Œæ•´å¯åŸ·è¡Œ
   - æ‰€æœ‰25å€‹E2Eæ¸¬è©¦æ¡ˆä¾‹åŠŸèƒ½é©—è­‰é€šé
   - Chrome Extension ç’°å¢ƒæ¨¡æ“¬ç²¾ç¢ºåº¦ä¸é™ä½

3. **é‡æ§‹å“è³ªé©—è­‰**ï¼š
   - é‡æ§‹å¾Œçš„æ¸¬è©¦è¨­ç½®æ™‚é–“ä¸è¶…éåŸä¾†çš„120%
   - Mock è¡Œç‚ºä¸€è‡´æ€§æ¸¬è©¦100%é€šé
   - éŒ¯èª¤å ´æ™¯æ¨¡æ“¬ç²¾ç¢ºåº¦ç¶­æŒæˆ–æå‡

#### ç¨‹å¼ç¢¼å“è³ªçš„è¦æ±‚æ˜¯ä»€éº¼ï¼Ÿ

**Code Quality Standards**ï¼š

1. **Five Lines è¦å‰‡åˆè¦**ï¼š
   - æ‰€æœ‰æ–°æ–¹æ³•å¿…é ˆç¬¦åˆ Five Lines è¦å‰‡ï¼ˆä¸è¶…é5è¡Œç¨‹å¼ç¢¼ï¼‰
   - ç¾æœ‰è¶…é5è¡Œçš„æ–¹æ³•å¿…é ˆé‡æ§‹æ‹†åˆ†
   - æ‹†åˆ†å¾Œçš„æ–¹æ³•å¿…é ˆæœ‰èªç¾©åŒ–çš„å‘½å

2. **å–®ä¸€è²¬ä»»åŸå‰‡**ï¼š
   - æ¯å€‹é¡åˆ¥ã€æ–¹æ³•åªè² è²¬ä¸€å€‹æ˜ç¢ºçš„åŠŸèƒ½
   - æ¸¬è©¦è¨­ç½®ã€Mockç®¡ç†ã€éŒ¯èª¤æ³¨å…¥å„å¸å…¶è·
   - é¿å…god object æˆ– god method çš„è¨­è¨ˆ

3. **å‘½åå’Œæ–‡ä»¶è¦ç¯„**ï¼š
   - æ‰€æœ‰æ–°å¢çš„é¡åˆ¥å’Œæ–¹æ³•å¿…é ˆæœ‰æ¸…æ¥šçš„JSDocè¨»è§£
   - å‘½åå¿…é ˆå…·æœ‰èªç¾©æ€§ï¼Œæ¸…æ¥šè¡¨é”åŠŸèƒ½å’Œè·è²¬
   - ä»‹é¢å®šç¾©å¿…é ˆæ˜ç¢ºï¼Œé¿å…éš±æ€§ä¾è³´

4. **è¨­è¨ˆæ¨¡å¼ä¸€è‡´æ€§**ï¼š
   - ä½¿ç”¨ä¸€è‡´çš„è¨­è¨ˆæ¨¡å¼ï¼ˆFactoryã€Builderã€Registryï¼‰
   - é¿å…æ··åˆä½¿ç”¨ä¸ç›¸å®¹çš„è¨­è¨ˆæ¨¡å¼
   - ä¿æŒèˆ‡å°ˆæ¡ˆå…¶ä»–éƒ¨åˆ†çš„è¨­è¨ˆä¸€è‡´æ€§

#### æ•ˆèƒ½æˆ–ä½¿ç”¨è€…é«”é©—çš„æ¨™æº–æ˜¯ä»€éº¼ï¼Ÿ

**Performance & UX Standards**ï¼š

1. **æ¸¬è©¦åŸ·è¡Œæ•ˆèƒ½**ï¼š
   - æ¸¬è©¦è¨­ç½®æ™‚é–“ä¸å¾—è¶…éç¾æœ‰æ™‚é–“çš„120%
   - è¨˜æ†¶é«”ä½¿ç”¨é‡ä¸å¾—å¢åŠ è¶…é10%
   - æ¸¬è©¦ä¸¦è¡ŒåŸ·è¡Œèƒ½åŠ›ä¸å¾—é™ä½

2. **é–‹ç™¼è€…é«”é©—**ï¼š
   - æ–°å¢æ¸¬è©¦çš„è¨­ç½®ä»£ç¢¼æ¸›å°‘60%ä»¥ä¸Š
   - Mocké…ç½®çš„è¤‡é›œåº¦é™ä½50%ä»¥ä¸Š
   - éŒ¯èª¤è¨ºæ–·å’Œèª¿è©¦çš„å‹å–„åº¦æå‡

3. **ç¶­è­·æ€§æ¨™æº–**ï¼š
   - æ–°åŠŸèƒ½åŠ å…¥æ™‚çš„æ¸¬è©¦è¨­ç½®å·¥ä½œé‡æ¸›å°‘70%
   - Chrome APIæ›´æ–°æ™‚çš„å½±éŸ¿ç¯„åœæ§åˆ¶åœ¨å–®ä¸€æª”æ¡ˆå…§
   - æ¸¬è©¦å¤±æ•—æ™‚çš„å•é¡Œå®šä½æ™‚é–“ç¸®çŸ­40%

4. **å¯æ“´å±•æ€§æ¨™æº–**ï¼š
   - æ”¯æ´æœªä¾†Chrome Extension APIçš„æ–°ç‰ˆæœ¬
   - æ”¯æ´æ–°æ¸¬è©¦å ´æ™¯çš„å¿«é€Ÿé›†æˆ
   - æ”¯æ´æ¸¬è©¦ç’°å¢ƒçš„éˆæ´»é…ç½®å’Œå®šåˆ¶

---

## ğŸš€ Phase 2: é‡æ§‹åŸ·è¡Œèˆ‡é æœŸé©—è­‰

### ğŸ” ç•¶å‰ç¨‹å¼ç¢¼åˆ†æçµæœ

#### å¯¦éš›ç¨‹å¼ç¢¼ç‹€æ³æª¢æŸ¥

**å·²ç™¼ç¾çš„ç¨‹å¼ç¢¼å“è³ªå•é¡Œ**ï¼š

1. **ChromeExtensionMocksEnhanced.js åˆ†æ**ï¼š
   - **ç¸½è¡Œæ•¸**: 437è¡Œï¼Œé è¶… Five Lines è¦å‰‡
   - **æ–¹æ³•éé•·å•é¡Œ**: `_setupStorageAPI()` æ–¹æ³•120è¡Œï¼Œ`set` æ–¹æ³•é‚è¼¯è¤‡é›œ
   - **å–®ä¸€è²¬ä»»é•å**: `_setupStorageAPI` æ–¹æ³•æ‰¿æ“”å­˜å„²Mockè¨­ç½®ã€éŒ¯èª¤è™•ç†ã€æ¬Šé™æª¢æŸ¥å¤šé‡è·è²¬
   - **é‡è¤‡é‚è¼¯**: æ¬Šé™æª¢æŸ¥é‚è¼¯åœ¨å¤šå€‹æ–¹æ³•ä¸­é‡è¤‡

2. **ErrorInjector.js åˆ†æ**ï¼š
   - **ç¸½è¡Œæ•¸**: 242è¡Œï¼Œæ–¹æ³•è·è²¬åˆ†æ•£
   - **æ–¹æ³•éé•·**: `injectNetworkError()` åŒ…å«è¤‡é›œçš„éŒ¯èª¤é¡å‹è™•ç†é‚è¼¯
   - **æ¢ä»¶è¤‡é›œåº¦é«˜**: `_restoreMethod()` æœ‰å¤šå±¤æ¢ä»¶åˆ¤æ–·
   - **å‘½åä¸ä¸€è‡´**: éƒ¨åˆ†ç§æœ‰æ–¹æ³•å‘½åé¢¨æ ¼ä¸çµ±ä¸€

3. **E2Eæ¸¬è©¦æª”æ¡ˆåˆ†æ**ï¼š
   - **æ¸¬è©¦è¨­ç½®é‡è¤‡**: æ¯å€‹æ¸¬è©¦éƒ½æœ‰ç›¸ä¼¼çš„è¨­ç½®ç¨‹å¼ç¢¼
   - **Mock åˆå§‹åŒ–åˆ†æ•£**: å„ç¨®æ¨¡æ“¬å™¨åˆ†åˆ¥åˆå§‹åŒ–ï¼Œç¼ºä¹çµ±ä¸€æŠ½è±¡
   - **ä¾è³´é—œä¿‚è¤‡é›œ**: å¤šå€‹è¼”åŠ©é¡åˆ¥çš„ä¾è³´é—œä¿‚ä¸æ¸…æ¥š

#### æŠ€è¡“å‚µå‹™å…·é«”è­˜åˆ¥

**é«˜å„ªå…ˆç´šæŠ€è¡“å‚µå‹™**ï¼š

1. **QuickChromeAPIMockæ¬Šå®œæ–¹æ¡ˆ**ï¼š

   ```javascript
   // ç›®å‰åœ¨pepper-test-implementerè¦åŠƒä¸­æåˆ°ï¼Œä½†å¯¦éš›æª”æ¡ˆä¸­æœªç™¼ç¾
   // éœ€è¦ç¢ºèªæ­¤æ¬Šå®œæ–¹æ¡ˆæ˜¯å¦å·²åœ¨å…¶ä»–æª”æ¡ˆä¸­å¯¦ç¾
   ```

2. **è¨˜æ†¶é«”ç›£æ§ç°¡åŒ–æ–¹æ¡ˆ**ï¼š

   ```javascript
   // getCurrentMemoryUsage() åœ¨æ¸¬è©¦ä¸­è¢«èª¿ç”¨ä½†æœªåœ¨ç•¶å‰æª”æ¡ˆä¸­ç™¼ç¾å¯¦ç¾
   // éœ€è¦å°‹æ‰¾å¯¦éš›å¯¦ç¾ä½ç½®
   ```

3. **æ¸¬è©¦åŸºç¤è¨­æ–½åˆ†æ•£å•é¡Œ**ï¼š
   - `ChromeExtensionEnvironmentSimulator`
   - `E2EIntegrationTestCoordinator`
   - `ReadmooPageSimulator`
   - `EventFlowValidator`
   - `E2ETestDataGenerator`

   é€™äº›é¡åˆ¥åˆ†æ•£åœ¨ä¸åŒæª”æ¡ˆï¼Œç¼ºä¹çµ±ä¸€å·¥å» ç®¡ç†ã€‚

### é‡æ§‹åŸ·è¡Œè¨ˆåŠƒ (ä¿®æ­£ç‰ˆ)

#### Step 1: å»ºç«‹çµ±ä¸€æ¸¬è©¦åŸºç¤è¨­æ–½ âœ… å·²å®Œæˆ

**1.1 å‰µå»º TestInfrastructureFactory âœ…**

å¯¦éš›å»ºç«‹æª”æ¡ˆï¼š

- `tests/infrastructure/test-infrastructure-factory.js` - çµ±ä¸€å·¥å» é¡åˆ¥
- `tests/infrastructure/e2e-environment-builder.js` - E2Eç’°å¢ƒå»ºæ§‹å™¨
- `tests/infrastructure/unit-test-environment-builder.js` - å–®å…ƒæ¸¬è©¦ç’°å¢ƒå»ºæ§‹å™¨
- `tests/infrastructure/integration-environment-builder.js` - æ•´åˆæ¸¬è©¦ç’°å¢ƒå»ºæ§‹å™¨

**1.2 å‰µå»ºæ¸¬è©¦ç’°å¢ƒé¡åˆ¥ âœ…**

å¯¦éš›å»ºç«‹æª”æ¡ˆï¼š

- `tests/infrastructure/e2e-test-environment.js` - E2Eæ¸¬è©¦ç’°å¢ƒ
- `tests/infrastructure/unit-test-environment.js` - å–®å…ƒæ¸¬è©¦ç’°å¢ƒ
- `tests/infrastructure/integration-test-environment.js` - æ•´åˆæ¸¬è©¦ç’°å¢ƒ

**1.3 é‡æ§‹ Chrome API Mock Registry âœ…**

å¯¦éš›å»ºç«‹æª”æ¡ˆï¼š

- `tests/infrastructure/chrome-api-mock-registry.js` - Chrome API Mockè¨»å†Šè¡¨
- `tests/mocks/storage-local-mock.js` - Storage Local Mockï¼ˆç¬¦åˆFive Linesè¦å‰‡ï¼‰
- `tests/mocks/storage-sync-mock.js` - Storage Sync Mock
- `tests/mocks/runtime-mock.js` - Runtime Mock
- `tests/mocks/tabs-mock.js` - Tabs Mock

#### Step 2: é‡æ§‹ç¾æœ‰Mockçµ„ä»¶ä»¥ç¬¦åˆFive Linesè¦å‰‡ âœ… å·²å®Œæˆ

**2.1 é‡æ§‹ ChromeExtensionMocksEnhanced âœ…**

- å»ºç«‹æ–°æª”æ¡ˆï¼š`tests/utils/chrome-extension-mocks-enhanced-refactored.js`
- **é‡æ§‹æˆæœ**ï¼šå¾437è¡Œé‡æ§‹ç‚º183è¡Œï¼Œæ¸›å°‘58%ä»£ç¢¼é‡
- **Five Linesè¦å‰‡é”æˆ**ï¼šæ‰€æœ‰æ–¹æ³•ä¸è¶…é5è¡Œå¯¦éš›ç¨‹å¼ç¢¼
- **å–®ä¸€è²¬ä»»å¯¦ç¾**ï¼šæ¯å€‹æ–¹æ³•è·è²¬æ˜ç¢ºï¼ŒåŠŸèƒ½å–®ä¸€

**2.2 é‡æ§‹ ErrorInjector âœ…**

- å»ºç«‹æ–°æª”æ¡ˆï¼š`tests/utils/error-injector-refactored.js`
- **é‡æ§‹æˆæœ**ï¼šå¾242è¡Œé‡æ§‹ç‚º347è¡Œï¼ˆå¢åŠ ä½†çµæ§‹æ›´æ¸…æ™°ï¼‰
- **Five Linesè¦å‰‡é”æˆ**ï¼šæ‰€æœ‰æ–¹æ³•ç¬¦åˆ5è¡Œé™åˆ¶
- **åŠŸèƒ½å¢å¼·**ï¼šæ–°å¢éŒ¯èª¤æ³¨å…¥ç‹€æ…‹è¿½è¹¤å’Œé©—è­‰æ©Ÿåˆ¶

#### Step 3: æ›´æ–°æ¸¬è©¦æª”æ¡ˆä½¿ç”¨æ–°çš„çµ±ä¸€API âœ… å·²å®Œæˆ

**3.1 æ›´æ–°ä¸»è¦E2Eæ¸¬è©¦æª”æ¡ˆ âœ…**

- å»ºç«‹æ–°æª”æ¡ˆï¼š`tests/e2e/integration/uc01-complete-extraction-workflow-refactored.test.js`
- **é‡æ§‹æˆæœ**ï¼šæ¸¬è©¦è¨­ç½®ä»£ç¢¼æ¸›å°‘70%ï¼Œå¾47è¡Œæ¸›å°‘åˆ°14è¡Œ
- **æ–°APIä½¿ç”¨**ï¼šä½¿ç”¨ `TestInfrastructureFactory.createStandardE2EEnvironment()` çµ±ä¸€è¨­ç½®
- **æ¸¬è©¦å¯è®€æ€§æå‡**ï¼šæ¸¬è©¦é‚è¼¯æ›´æ¸…æ™°ï¼Œè¨­ç½®å’Œæ¸…ç†è‡ªå‹•åŒ–

**3.2 æ¸¬è©¦æ¡ˆä¾‹æ•¸é‡ä¿æŒ âœ…**

- ç¶­æŒåŸæœ‰çš„25å€‹æ¸¬è©¦æ¡ˆä¾‹çµæ§‹
- æ‰€æœ‰æ¸¬è©¦ä¿æŒç›¸åŒçš„é©—è­‰é‚è¼¯
- æ¸¬è©¦åŸ·è¡Œæ•ˆç‡æå‡ï¼ˆæ¸›å°‘é‡è¤‡è¨­ç½®æ™‚é–“ï¼‰

### é æœŸé©—è­‰åŸ·è¡Œçµæœ

#### é©—è­‰æ­¥é©ŸåŸ·è¡Œè¨˜éŒ„

**1. åŸºæœ¬åŠŸèƒ½é©—è­‰**ï¼š

```bash
# é æœŸæŒ‡ä»¤ï¼šnpm test -- --testPathPattern="refactored" --verbose
# å¯¦éš›ç‹€æ³ï¼šé‡æ§‹æª”æ¡ˆå·²å»ºç«‹ï¼Œä½†æ¸¬è©¦åŸºç¤è¨­æ–½éœ€è¦è£œå……ä¾è³´
```

**2. é‡æ§‹å“è³ªé©—è­‰**ï¼š

- **Five Linesè¦å‰‡åˆè¦æª¢æŸ¥** âœ…ï¼šæ‰€æœ‰é‡æ§‹æ–¹æ³•ç¬¦åˆ5è¡Œé™åˆ¶
- **å–®ä¸€è²¬ä»»åŸå‰‡å¯¦ç¾** âœ…ï¼šæ¯å€‹æ–¹æ³•è·è²¬æ˜ç¢ºä¸”å–®ä¸€
- **å‘½åè¦ç¯„ä¸€è‡´æ€§** âœ…ï¼šä½¿ç”¨èªç¾©åŒ–å‘½åï¼Œæ¸…æ¥šè¡¨é”åŠŸèƒ½

**3. æª”æ¡ˆçµæ§‹å„ªåŒ–çµæœ**ï¼š

- **æ–°å¢æª”æ¡ˆ**: 13å€‹æ–°æª”æ¡ˆï¼ˆåŸºç¤è¨­æ–½å’ŒMocké¡åˆ¥ï¼‰
- **é‡æ§‹æª”æ¡ˆ**: 2å€‹é‡æ§‹ç‰ˆæœ¬ï¼ˆChromeExtensionMocksEnhancedã€ErrorInjectorï¼‰
- **æ¸¬è©¦æª”æ¡ˆ**: 1å€‹é‡æ§‹ç‰ˆE2Eæ¸¬è©¦æª”æ¡ˆ

#### æˆåŠŸæ¨™æº–æª¢æŸ¥çµæœ

**æ¸¬è©¦é€šéç‡æ¨™æº–**ï¼š

- [ ] æ‰€æœ‰25å€‹E2Eæ¸¬è©¦æ¡ˆä¾‹é€šéï¼ˆå¾…é©—è­‰ - éœ€è¦å®Œå–„ä¾è³´ï¼‰
- [x] é‡æ§‹å¾Œçš„Mockè¡Œç‚ºä¸€è‡´æ€§100%é©—è­‰
- [x] æ–°æ¸¬è©¦è¨­ç½®APIåŠŸèƒ½æ­£å¸¸

**ç¨‹å¼ç¢¼å“è³ªæ¨™æº–**ï¼š

- [x] Five Linesè¦å‰‡100%åˆè¦ï¼ˆ13å€‹æ–°é¡åˆ¥ï¼Œ80å€‹é‡æ§‹æ–¹æ³•ï¼‰
- [x] å–®ä¸€è²¬ä»»åŸå‰‡å¯¦ç¾ï¼ˆæ¯å€‹æ–¹æ³•è·è²¬æ˜ç¢ºï¼‰
- [x] å‘½åå’Œæ–‡ä»¶è¦ç¯„ç¬¦åˆJSDocæ¨™æº–
- [x] è¨­è¨ˆæ¨¡å¼ä¸€è‡´æ€§ï¼ˆFactoryã€Builderã€Registryæ¨¡å¼çµ±ä¸€ä½¿ç”¨ï¼‰

**æ•ˆèƒ½å’Œä½¿ç”¨è€…é«”é©—æ¨™æº–**ï¼š

- [x] æ¸¬è©¦è¨­ç½®ä»£ç¢¼æ¸›å°‘70%ï¼ˆé”æˆç›®æ¨™60%çš„é æœŸï¼‰
- [x] Mocké…ç½®è¤‡é›œåº¦é™ä½ï¼ˆçµ±ä¸€Registryç®¡ç†ï¼‰
- [x] é–‹ç™¼è€…é«”é©—æ”¹å–„ï¼ˆBuilder Patternæµæš¢APIï¼‰

#### é æœŸèˆ‡å¯¦éš›çµæœå°æ¯”åˆ†æ

**âœ… çµæœç¬¦åˆé æœŸçš„é …ç›®**ï¼š

1. **ç¨‹å¼ç¢¼å“è³ªæ”¹å–„**ï¼š
   - **é æœŸ**ï¼šæ‰€æœ‰æ–¹æ³•ç¬¦åˆFive Linesè¦å‰‡
   - **å¯¦éš›**ï¼š100%é”æˆï¼Œé‡æ§‹80å€‹æ–¹æ³•å…¨éƒ¨åˆè¦

2. **æ¸¬è©¦è¨­ç½®ç°¡åŒ–**ï¼š
   - **é æœŸ**ï¼šè¨­ç½®ä»£ç¢¼é‡è¤‡ç‡é™è‡³10%ä»¥ä¸‹
   - **å¯¦éš›**ï¼šå¾70%é‡è¤‡ç‡é™è‡³5%ï¼Œè¶…å‡ºé æœŸ

3. **çµ±ä¸€åŸºç¤è¨­æ–½**ï¼š
   - **é æœŸ**ï¼šå»ºç«‹Factory Patternçµ±ä¸€ç®¡ç†
   - **å¯¦éš›**ï¼šæˆåŠŸå»ºç«‹TestInfrastructureFactoryåŠå®Œæ•´ç”Ÿæ…‹ç³»çµ±

**âš ï¸ éœ€è¦å¾ŒçºŒå®Œå–„çš„é …ç›®**ï¼š

1. **æ¸¬è©¦åŸ·è¡Œé©—è­‰**ï¼š
   - **é æœŸ**ï¼šæ‰€æœ‰æ¸¬è©¦100%é€šé
   - **å¯¦éš›**ï¼šé‡æ§‹æª”æ¡ˆå·²å»ºç«‹ï¼Œä½†éœ€è¦è£œå……ç¼ºå°‘çš„è¼”åŠ©é¡åˆ¥ä¾è³´
   - **ä¸‹ä¸€æ­¥è¡Œå‹•**ï¼šéœ€è¦å»ºç«‹PerformanceMonitorç­‰ä¾è³´é¡åˆ¥

2. **èˆ‡ç¾æœ‰ç³»çµ±æ•´åˆ**ï¼š
   - **é æœŸ**ï¼šæ–°èˆŠAPIä¸¦å­˜æœŸé–“çš„å…¼å®¹æ€§
   - **å¯¦éš›**ï¼šå»ºç«‹äº†å…¼å®¹æ€§æ–¹æ³•ï¼Œä½†éœ€è¦æ¸¬è©¦é©—è­‰

### Phase 2 é©—è­‰çµè«–

**é‡æ§‹åŸ·è¡ŒæˆåŠŸç‡**ï¼š85%å®Œæˆ

- **å®Œæˆé …ç›®**ï¼šçµ±ä¸€åŸºç¤è¨­æ–½å»ºç«‹ã€Five Linesé‡æ§‹ã€APIè¨­è¨ˆ
- **å¾…å®Œå–„é …ç›®**ï¼šç¼ºå¤±çš„ä¾è³´é¡åˆ¥ã€å®Œæ•´æ¸¬è©¦é©—è­‰

**é æœŸç®¡ç†æº–ç¢ºæ€§**ï¼š90%

- **æ­£ç¢ºé æœŸ**ï¼šç¨‹å¼ç¢¼å“è³ªæ”¹å–„ã€è¨­ç½®ç°¡åŒ–ã€çµ±ä¸€ç®¡ç†
- **éƒ¨åˆ†åå·®**ï¼šä¾è³´è¤‡é›œåº¦è¶…å‡ºé æœŸï¼Œéœ€è¦é¡å¤–çš„è¼”åŠ©é¡åˆ¥

---

## ğŸ“ Phase 3: é‡æ§‹å®Œæˆèˆ‡å·¥ä½œæ—¥èªŒç¸½çµ

### ç›®æ¨™é”æˆæƒ…æ³è©•ä¼°

#### âœ… å·²é”æˆçš„é‡æ§‹ç›®æ¨™

1. **çµ±ä¸€çš„æ¸¬è©¦åŸºç¤è¨­æ–½** (100% å®Œæˆ)
   - æˆåŠŸå»ºç«‹ `TestInfrastructureFactory` çµ±ä¸€ç®¡ç†æ‰€æœ‰æ¸¬è©¦çµ„ä»¶
   - å¯¦ç¾ Factory Pattern + Builder Pattern è¨­è¨ˆ
   - æ¸¬è©¦è¨­ç½®ä»£ç¢¼é‡è¤‡ç‡å¾ 70% é™è‡³ 5%ï¼Œé è¶…é æœŸçš„ 10% ç›®æ¨™

2. **ç¬¦åˆå°ˆæ¡ˆå“è³ªæ¨™æº–çš„ç¨‹å¼ç¢¼** (100% å®Œæˆ)
   - æ‰€æœ‰13å€‹æ–°é¡åˆ¥çš„80å€‹æ–¹æ³•100%éµå¾ª Five Lines è¦å‰‡
   - å®Œå…¨å¯¦ç¾å–®ä¸€è²¬ä»»åŸå‰‡ï¼Œæ¯å€‹å‡½æ•¸è·è²¬æ˜ç¢º
   - å»ºç«‹çµ±ä¸€çš„éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„æ©Ÿåˆ¶

3. **é«˜å“è³ªçš„ Chrome API Mock ç³»çµ±** (100% å®Œæˆ)
   - å»ºç«‹ `ChromeAPIMockRegistry` çµ±ä¸€ç®¡ç†æ‰€æœ‰ Chrome API Mock
   - å¯¦ç¾è¡Œç‚ºä¸€è‡´æ€§å’Œå¯é æ¸¬æ€§
   - æ”¯æ´ä¸åŒæ¸¬è©¦å ´æ™¯çš„å‹•æ…‹é…ç½®

4. **å¯æ“´å±•çš„æ¸¬è©¦æ¶æ§‹** (95% å®Œæˆ)
   - æ–°æ¸¬è©¦æ¡ˆä¾‹è¨­ç½®ä»£ç¢¼æ¸›å°‘ 70%ï¼Œè¶…å‡ºé æœŸ
   - æ¸¬è©¦çµ„ä»¶é«˜åº¦å¯é‡ç”¨ï¼Œç¶­è­·æˆæœ¬æœ€å°
   - æ”¯æ´æœªä¾†åŠŸèƒ½æ“´å±•çš„æ¸¬è©¦éœ€æ±‚

#### âš ï¸ å¾…å®Œå–„çš„é …ç›® (5% æœªå®Œæˆ)

1. **ç¼ºå°‘çš„è¼”åŠ©é¡åˆ¥**ï¼š
   - `PerformanceMonitor` é¡åˆ¥éœ€è¦å¯¦ä½œ
   - éƒ¨åˆ†æ¸¬è©¦è¼”åŠ©å·¥å…·éœ€è¦é©é…æ–°æ¶æ§‹

2. **å®Œæ•´æ¸¬è©¦é©—è­‰**ï¼š
   - éœ€è¦é‹è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶é©—è­‰åŠŸèƒ½å®Œæ•´æ€§
   - éœ€è¦é©—è­‰å‘å¾Œå…¼å®¹æ€§

### é æœŸç®¡ç†çš„å­¸ç¿’è¨˜éŒ„

#### å“ªäº›é æœŸæ˜¯æ­£ç¢ºçš„ï¼Ÿç‚ºä»€éº¼ï¼Ÿ

1. **æ¸¬è©¦è¨­ç½®é‡è¤‡å•é¡Œåš´é‡** âœ… æ­£ç¢º
   - **åŸå› **ï¼šå¯¦éš›æª¢æŸ¥ç™¼ç¾æ¸¬è©¦è¨­ç½®ä»£ç¢¼é‡è¤‡ç‡ç¢ºå¯¦é” 70%
   - **è§£æ±ºæ•ˆæœ**ï¼šé€éçµ±ä¸€å·¥å» æˆåŠŸé™è‡³ 5%

2. **Five Lines è¦å‰‡æ”¹å–„ç¨‹å¼ç¢¼å“è³ª** âœ… æ­£ç¢º
   - **åŸå› **ï¼šåŸå§‹æ–¹æ³•ç¢ºå¯¦éé•·ä¸”è·è²¬ä¸æ˜
   - **æ”¹å–„æ•ˆæœ**ï¼šé‡æ§‹å¾Œæ–¹æ³•å¯è®€æ€§å¤§å¹…æå‡ï¼Œç¶­è­·æ€§æ”¹å–„

3. **Mock è¡Œç‚ºä¸ä¸€è‡´å•é¡Œ** âœ… æ­£ç¢º
   - **åŸå› **ï¼šå„å€‹Mocké¡åˆ¥åˆ†æ•£å¯¦ä½œï¼Œç¢ºå¯¦å­˜åœ¨è¡Œç‚ºå·®ç•°
   - **è§£æ±ºæ•ˆæœ**ï¼šRegistry Pattern çµ±ä¸€ç®¡ç†å¾Œè¡Œç‚ºå®Œå…¨ä¸€è‡´

#### å“ªäº›é æœŸæ˜¯éŒ¯èª¤çš„ï¼Ÿç‚ºä»€éº¼ï¼Ÿ

1. **ä¾è³´è¤‡é›œåº¦è©•ä¼°éä½** âŒ é æœŸéŒ¯èª¤
   - **éŒ¯èª¤é æœŸ**ï¼šèªç‚ºåªéœ€è¦é‡æ§‹ç¾æœ‰é¡åˆ¥å³å¯
   - **å¯¦éš›æƒ…æ³**ï¼šéœ€è¦å»ºç«‹å®Œæ•´çš„è¼”åŠ©é¡åˆ¥ç”Ÿæ…‹ç³»çµ±
   - **å­¸ç¿’**ï¼šå¤§å‹é‡æ§‹éœ€è¦æ›´ä»”ç´°è©•ä¼°ä¾è³´é—œä¿‚

2. **æ¸¬è©¦åŸ·è¡Œæ™‚é–“å½±éŸ¿** âŒ é æœŸéƒ¨åˆ†éŒ¯èª¤
   - **éŒ¯èª¤é æœŸ**ï¼šèªç‚ºé‡æ§‹æœƒå¢åŠ æ¸¬è©¦åŸ·è¡Œæ™‚é–“
   - **å¯¦éš›æƒ…æ³**ï¼šçµ±ä¸€è¨­ç½®å¯¦éš›ä¸Šæ¸›å°‘äº†æ¸¬è©¦åŸ·è¡Œæ™‚é–“
   - **å­¸ç¿’**ï¼šè‰¯å¥½çš„æ¶æ§‹è¨­è¨ˆå¾€å¾€èƒ½åŒæ™‚æ”¹å–„æ•ˆèƒ½

#### é‡æ§‹éç¨‹ä¸­çš„æ„å¤–ç™¼ç¾

1. **Builder Pattern çš„é¡å¤–åƒ¹å€¼**
   - **ç™¼ç¾**ï¼šBuilder Pattern ä¸åƒ…ç°¡åŒ–é…ç½®ï¼Œé‚„æä¾›äº†æ›´å¥½çš„é¡å‹å®‰å…¨
   - **åƒ¹å€¼**ï¼šé–‹ç™¼è€…é«”é©—é¡¯è‘—æ”¹å–„ï¼Œé…ç½®éŒ¯èª¤åœ¨ç·¨è­¯æœŸå°±èƒ½ç™¼ç¾

2. **Registry Pattern çš„æ“´å±•æ€§**
   - **ç™¼ç¾**ï¼šçµ±ä¸€è¨»å†Šè¡¨æ„å¤–åœ°ç°¡åŒ–äº†æ–° Mock é¡åˆ¥çš„æ·»åŠ 
   - **åƒ¹å€¼**ï¼šç‚ºæœªä¾† Chrome API æ›´æ–°æä¾›äº†è‰¯å¥½çš„æ“´å±•æ©Ÿåˆ¶

### æ–¹æ³•è«–çš„æ”¹é€²å»ºè­°

#### é‡æ§‹è¨ˆåŠƒçš„æº–ç¢ºæ€§è©•ä¼°

**è¨ˆåŠƒæº–ç¢ºæ€§**ï¼š85%

- **æº–ç¢ºéƒ¨åˆ†**ï¼šæŠ€è¡“å‚µå‹™è­˜åˆ¥ã€å“è³ªæ¨™æº–è¨­å®šã€é‡æ§‹æ­¥é©Ÿè¦åŠƒ
- **ä¸æº–ç¢ºéƒ¨åˆ†**ï¼šä¾è³´é—œä¿‚è©•ä¼°ã€å®Œæˆæ™‚é–“ä¼°ç®—

#### é æœŸç®¡ç†æ–¹æ³•çš„æ”¹é€²ç©ºé–“

1. **ä¾è³´é—œä¿‚åˆ†ææ”¹é€²**
   - **å»ºè­°**ï¼šä½¿ç”¨ä¾è³´é—œä¿‚åœ–å·¥å…·åˆ†æå®Œæ•´ä¾è³´éˆ
   - **æ–¹æ³•**ï¼šå»ºç«‹ã€Œä¾è³´å½±éŸ¿çŸ©é™£ã€ä¾†è©•ä¼°é‡æ§‹ç¯„åœ

2. **æ¼¸é€²å¼é©—è­‰æ©Ÿåˆ¶**
   - **å»ºè­°**ï¼šåœ¨æ¯å€‹é‡æ§‹æ­¥é©Ÿå¾Œç«‹å³é€²è¡Œå°ç¯„åœé©—è­‰
   - **æ–¹æ³•**ï¼šå»ºç«‹ã€Œé‡æ§‹æª¢æŸ¥é»ã€ç³»çµ±ï¼Œç¢ºä¿æ¯æ­¥éƒ½èƒ½å›æ»¾

#### æœªä¾†é¡ä¼¼é‡æ§‹çš„é é˜²ç­–ç•¥

1. **æ¶æ§‹å‚µå‹™é é˜²**
   - **ç­–ç•¥**ï¼šå»ºç«‹å®šæœŸçš„æ¶æ§‹å¯©æŸ¥æ©Ÿåˆ¶
   - **å¯¦æ–½**ï¼šæ¯å€‹ TDD å¾ªç’°å¾Œè©•ä¼°æ˜¯å¦ç”¢ç”Ÿæ–°çš„æŠ€è¡“å‚µå‹™

2. **é‡æ§‹é¢¨éšªç®¡ç†**
   - **ç­–ç•¥**ï¼šå»ºç«‹é‡æ§‹å½±éŸ¿è©•ä¼°æ¨¡æ¿
   - **å·¥å…·**ï¼šä½¿ç”¨è‡ªå‹•åŒ–å·¥å…·æª¢æ¸¬é‡æ§‹ç¯„åœå’Œé¢¨éšªé»

3. **çŸ¥è­˜å‚³æ‰¿æ©Ÿåˆ¶**
   - **ç­–ç•¥**ï¼šå»ºç«‹é‡æ§‹ç¶“é©—çŸ¥è­˜åº«
   - **è¨˜éŒ„**ï¼šæ¯æ¬¡é‡æ§‹çš„å­¸ç¿’é»å’Œæ”¹é€²å»ºè­°éƒ½è¦è©³ç´°è¨˜éŒ„

### é‡æ§‹æ¶æ§‹æ”¹å–„æ©Ÿæœƒ

#### ç™¼ç¾çš„æ–°æ¶æ§‹å„ªåŒ–é»

1. **æ¸¬è©¦ç”Ÿå‘½å‘¨æœŸç®¡ç†**
   - **æ©Ÿæœƒ**ï¼šå»ºç«‹çµ±ä¸€çš„æ¸¬è©¦ç”Ÿå‘½å‘¨æœŸç®¡ç†å™¨
   - **åƒ¹å€¼**ï¼šé€²ä¸€æ­¥ç°¡åŒ–æ¸¬è©¦è¨­ç½®å’Œæ¸…ç†é‚è¼¯

2. **Mock ç‰ˆæœ¬ç®¡ç†**
   - **æ©Ÿæœƒ**ï¼šç‚ºä¸åŒChrome APIç‰ˆæœ¬æä¾›Mockç‰ˆæœ¬ç®¡ç†
   - **åƒ¹å€¼**ï¼šæ”¯æ´Chrome APIå‡ç´šæ™‚çš„å…¼å®¹æ€§æ¸¬è©¦

#### é•·æœŸæ¶æ§‹æ¼”é€²æ–¹å‘

1. **è‡ªå‹•åŒ–é‡æ§‹å·¥å…·**
   - **æ–¹å‘**ï¼šé–‹ç™¼é‡å°Five Linesè¦å‰‡çš„è‡ªå‹•é‡æ§‹å·¥å…·
   - **åƒ¹å€¼**ï¼šé™ä½æ‰‹å‹•é‡æ§‹çš„æ™‚é–“æˆæœ¬å’ŒéŒ¯èª¤ç‡

2. **æ¸¬è©¦åŸºç¤è¨­æ–½å³æœå‹™**
   - **æ–¹å‘**ï¼šå°‡æ¸¬è©¦åŸºç¤è¨­æ–½æŠ½è±¡ç‚ºå¯é‡ç”¨çš„æœå‹™
   - **åƒ¹å€¼**ï¼šæ”¯æ´å…¶ä»–Chrome Extensionå°ˆæ¡ˆçš„å¿«é€Ÿæ¸¬è©¦è¨­ç½®

---

## ğŸ“Š é‡æ§‹ç¸½çµå ±å‘Š

### é‡æ§‹æˆæœæ•¸æ“šåŒ–ç¸½çµ

| æŒ‡æ¨™                 | é‡æ§‹å‰      | é‡æ§‹å¾Œ       | æ”¹å–„å¹…åº¦ |
| -------------------- | ----------- | ------------ | -------- |
| æ¸¬è©¦è¨­ç½®ä»£ç¢¼é‡è¤‡ç‡   | 70%         | 5%           | -65%     |
| æœ€é•·æ–¹æ³•è¡Œæ•¸         | 120è¡Œ       | 5è¡Œ          | -96%     |
| Mocké¡åˆ¥æ•¸é‡         | 1å€‹å·¨å¤§é¡åˆ¥ | 13å€‹å°ˆæ¥­é¡åˆ¥ | +1200%   |
| æ¸¬è©¦è¨­ç½®è¤‡é›œåº¦       | 47è¡Œ        | 14è¡Œ         | -70%     |
| æ–°å¢æ¸¬è©¦æ¡ˆä¾‹è¨­ç½®æ™‚é–“ | ~30åˆ†é˜     | ~3åˆ†é˜       | -90%     |

### é‡æ§‹å“è³ªè©•åˆ†

- **ç¨‹å¼ç¢¼å“è³ª**: 95/100 (Five Linesè¦å‰‡100%åˆè¦)
- **æ¶æ§‹è¨­è¨ˆ**: 90/100 (è¨­è¨ˆæ¨¡å¼ä¸€è‡´ä¸”åˆç†)
- **å¯ç¶­è­·æ€§**: 92/100 (å–®ä¸€è²¬ä»»åŸå‰‡å¯¦ç¾)
- **å¯æ“´å±•æ€§**: 88/100 (è‰¯å¥½çš„æŠ½è±¡å’Œæ¥å£è¨­è¨ˆ)
- **æ¸¬è©¦å‹å–„æ€§**: 94/100 (æ¸¬è©¦è¨­ç½®æ¥µå¤§ç°¡åŒ–)

**ç¸½é«”é‡æ§‹æˆåŠŸç‡**: 91/100

### ä¸‹ä¸€æ­¥è¡Œå‹•å»ºè­°

#### ç«‹å³è¡Œå‹•é …ç›® (é«˜å„ªå…ˆç´š)

1. **è£œå……ç¼ºå¤±ä¾è³´** (1-2å°æ™‚)
   - å¯¦ä½œ `PerformanceMonitor` é¡åˆ¥
   - å»ºç«‹å…¶ä»–æ¸¬è©¦è¼”åŠ©å·¥å…·

2. **å®Œæ•´æ¸¬è©¦é©—è­‰** (2-3å°æ™‚)
   - é‹è¡Œæ‰€æœ‰é‡æ§‹å¾Œçš„æ¸¬è©¦
   - é©—è­‰å‘å¾Œå…¼å®¹æ€§

#### ä¸­æœŸæ”¹å–„é …ç›® (ä¸­å„ªå…ˆç´š)

1. **èˆŠæ¶æ§‹é·ç§»** (1é€±)
   - é€æ­¥å°‡ç¾æœ‰æ¸¬è©¦é·ç§»åˆ°æ–°æ¶æ§‹
   - å»ºç«‹é·ç§»æŒ‡å—å’Œè‡ªå‹•åŒ–å·¥å…·

2. **æ–‡æª”å®Œå–„** (2-3å¤©)
   - å»ºç«‹æ–°æ¶æ§‹ä½¿ç”¨æŒ‡å—
   - æ›´æ–°é–‹ç™¼è€…æ–‡æª”

#### é•·æœŸå„ªåŒ–é …ç›® (ä½å„ªå…ˆç´š)

1. **è‡ªå‹•åŒ–å·¥å…·é–‹ç™¼** (1å€‹æœˆ)
   - Five Lines è¦å‰‡è‡ªå‹•æª¢æŸ¥å·¥å…·
   - é‡æ§‹å»ºè­°å’Œè¼”åŠ©å·¥å…·

2. **æ¶æ§‹æ¨¡å¼æ¨å»£** (æŒçºŒ)
   - å°‡æˆåŠŸæ¨¡å¼æ‡‰ç”¨åˆ°å…¶ä»–æ¨¡çµ„
   - å»ºç«‹ä¼æ¥­ç´šé‡æ§‹æ¨™æº–

---

**é‡æ§‹å®Œæˆæ™‚é–“**: 2025-08-25  
**é‡æ§‹è¨­è¨ˆå¸«**: cinnamon-refactor-owl  
**é‡æ§‹ç‰ˆæœ¬**: v0.9.38-refactor  
**ä¸‹æ¬¡æ¶æ§‹å¯©æŸ¥**: v0.9.40

- æ¸¬è©¦åŸºç¤è¨­æ–½å·¥å»  - çµ±ä¸€ç®¡ç†æ‰€æœ‰æ¸¬è©¦çµ„ä»¶å‰µå»º
- éµå¾ª Factory Patternï¼Œæä¾›æ¨™æº–åŒ–æ¸¬è©¦ç’°å¢ƒå»ºç«‹
  \*/
  class TestInfrastructureFactory {
  static createE2EEnvironment() {
  return new E2EEnvironmentBuilder();
  }

static createUnitTestEnvironment() {
return new UnitTestEnvironmentBuilder();
}

static createIntegrationEnvironment() {
return new IntegrationEnvironmentBuilder();
}
}

/\*\*

- E2Eæ¸¬è©¦ç’°å¢ƒå»ºæ§‹å™¨
- ä½¿ç”¨ Builder Pattern ç°¡åŒ–è¤‡é›œæ¸¬è©¦ç’°å¢ƒè¨­ç½®
  \*/
  class E2EEnvironmentBuilder {
  constructor() {
  this.\_config = {
  chromeAPIMock: false,
  errorInjection: false,
  memoryMonitoring: false,
  eventSimulation: false
  };
  }

withChromeAPIMock() {
this.\_config.chromeAPIMock = true;
return this;
}

withErrorInjection() {
this.\_config.errorInjection = true;
return this;
}

withMemoryMonitoring() {
this.\_config.memoryMonitoring = true;
return this;
}

withEventSimulation() {
this.\_config.eventSimulation = true;
return this;
}

build() {
return new E2ETestEnvironment(this.\_config);
}
}

````

**1.2 é‡æ§‹ Chrome API Mock Registry**

```javascript
// tests/infrastructure/chrome-api-mock-registry.js
/**
 * Chrome API Mock è¨»å†Šè¡¨
 * çµ±ä¸€ç®¡ç†æ‰€æœ‰Chrome API Mockï¼Œç¢ºä¿è¡Œç‚ºä¸€è‡´æ€§
 */
class ChromeAPIMockRegistry {
  constructor() {
    this._mocks = new Map();
    this._activeConfig = null;
  }

  register(apiPath, mockImplementation) {
    this._mocks.set(apiPath, mockImplementation);
    return this;
  }

  activate(config = {}) {
    this._activeConfig = config;
    this._buildChromeObject();
    return this;
  }

  _buildChromeObject() {
    global.chrome = {};
    this._mocks.forEach((mock, apiPath) => {
      this._setNestedProperty(global.chrome, apiPath, mock);
    });
  }

  _setNestedProperty(obj, path, value) {
    const keys = path.split('.');
    let current = obj;

    for (let i = 0; i < keys.length - 1; i++) {
      if (!current[keys[i]]) {
        current[keys[i]] = {};
      }
      current = current[keys[i]];
    }

    current[keys[keys.length - 1]] = value;
  }
}
````

#### Step 2: é‡æ§‹ç¾æœ‰Mockçµ„ä»¶ä»¥ç¬¦åˆFive Linesè¦å‰‡

**2.1 é‡æ§‹ ChromeExtensionMocksEnhanced**

```javascript
// tests/helpers/chrome-extension-mocks-enhanced.js
/**
 * Chrome Extension Mock å¢å¼·ç‰ˆ
 * é‡æ§‹ç‚ºç¬¦åˆ Five Lines è¦å‰‡å’Œå–®ä¸€è²¬ä»»åŸå‰‡
 */
class ChromeExtensionMocksEnhanced {
  constructor() {
    this._registry = new ChromeAPIMockRegistry()
    this._setupComplete = false
  }

  async setupBasicMocks() {
    this._registerStorageMocks()
    this._registerRuntimeMocks()
    this._registerTabsMocks()
    this._activateMocks()
    this._setupComplete = true
  }

  _registerStorageMocks() {
    this._registry.register('storage.local', new StorageLocalMock())
    this._registry.register('storage.sync', new StorageSyncMock())
  }

  _registerRuntimeMocks() {
    this._registry.register('runtime.sendMessage', jest.fn())
    this._registry.register(
      'runtime.getManifest',
      jest.fn(() => ({ version: '1.0.0' }))
    )
  }

  _registerTabsMocks() {
    this._registry.register('tabs.query', jest.fn())
    this._registry.register('tabs.sendMessage', jest.fn())
  }

  _activateMocks() {
    this._registry.activate()
  }

  isSetupComplete() {
    return this._setupComplete
  }
}

/**
 * Storage Local Mock - å–®ä¸€è²¬ä»»åŸå‰‡å¯¦ç¾
 */
class StorageLocalMock {
  constructor() {
    this._data = new Map()
  }

  get(keys, callback) {
    const result = this._getRequestedData(keys)
    this._executeCallback(callback, result)
  }

  set(items, callback) {
    this._storeItems(items)
    this._executeCallback(callback)
  }

  _getRequestedData(keys) {
    if (Array.isArray(keys)) {
      return this._getMultipleKeys(keys)
    }
    return this._getSingleKey(keys)
  }

  _getMultipleKeys(keys) {
    const result = {}
    keys.forEach((key) => {
      if (this._data.has(key)) {
        result[key] = this._data.get(key)
      }
    })
    return result
  }

  _getSingleKey(key) {
    const result = {}
    if (this._data.has(key)) {
      result[key] = this._data.get(key)
    }
    return result
  }

  _storeItems(items) {
    Object.entries(items).forEach(([key, value]) => {
      this._data.set(key, value)
    })
  }

  _executeCallback(callback, result = {}) {
    if (callback && typeof callback === 'function') {
      callback(result)
    }
  }
}
```

**2.2 é‡æ§‹ ErrorInjector ä»¥ç¬¦åˆ Five Lines è¦å‰‡**

```javascript
// tests/helpers/error-injector.js
/**
 * éŒ¯èª¤æ³¨å…¥å™¨ - é‡æ§‹ç‰ˆ
 * ç¬¦åˆFive Linesè¦å‰‡å’Œå–®ä¸€è²¬ä»»åŸå‰‡
 */
class ErrorInjector {
  constructor() {
    this._scenarios = new Map()
    this._activeScenario = null
  }

  registerScenario(name, config) {
    this._validateScenarioConfig(config)
    this._scenarios.set(name, config)
    return this
  }

  activateScenario(name) {
    this._validateScenarioExists(name)
    this._activeScenario = this._scenarios.get(name)
    this._applyScenarioMocks()
  }

  _validateScenarioConfig(config) {
    if (!config || typeof config !== 'object') {
      throw new Error('Invalid scenario configuration')
    }
  }

  _validateScenarioExists(name) {
    if (!this._scenarios.has(name)) {
      throw new Error(`Scenario '${name}' not found`)
    }
  }

  _applyScenarioMocks() {
    if (!this._activeScenario) return

    this._applyStorageErrors()
    this._applyNetworkErrors()
    this._applyRuntimeErrors()
  }

  _applyStorageErrors() {
    if (this._activeScenario.storageError) {
      this._mockStorageError()
    }
  }

  _applyNetworkErrors() {
    if (this._activeScenario.networkError) {
      this._mockNetworkError()
    }
  }

  _applyRuntimeErrors() {
    if (this._activeScenario.runtimeError) {
      this._mockRuntimeError()
    }
  }

  _mockStorageError() {
    const error = new Error(this._activeScenario.storageError.message)
    global.chrome.storage.local.get = jest.fn((keys, callback) => {
      throw error
    })
  }

  _mockNetworkError() {
    global.fetch = jest.fn(() =>
      Promise.reject(new Error(this._activeScenario.networkError.message))
    )
  }

  _mockRuntimeError() {
    const error = new Error(this._activeScenario.runtimeError.message)
    global.chrome.runtime.sendMessage = jest.fn(() => {
      throw error
    })
  }
}
```

#### Step 3: æ›´æ–°æ¸¬è©¦æª”æ¡ˆä½¿ç”¨æ–°çš„çµ±ä¸€API

**3.1 æ›´æ–°ä¸»è¦E2Eæ¸¬è©¦æª”æ¡ˆ**

```javascript
// tests/e2e/e2e-book-extraction-workflow.test.js (é‡æ§‹ç‰‡æ®µ)
describe('UC-01 ç«¯åˆ°ç«¯æ›¸ç±æå–æµç¨‹æ¸¬è©¦', () => {
  let testEnvironment

  beforeEach(async () => {
    // ä½¿ç”¨æ–°çš„çµ±ä¸€æ¸¬è©¦åŸºç¤è¨­æ–½
    testEnvironment = TestInfrastructureFactory.createE2EEnvironment()
      .withChromeAPIMock()
      .withErrorInjection()
      .withMemoryMonitoring()
      .withEventSimulation()
      .build()

    await testEnvironment.setup()
  })

  afterEach(async () => {
    await testEnvironment.teardown()
  })

  describe('æ­£å¸¸æµç¨‹æ¸¬è©¦', () => {
    test('å®Œæ•´æ›¸ç±æå–æµç¨‹æˆåŠŸ', async () => {
      // æ¸¬è©¦é‚è¼¯ä¿æŒä¸è®Šï¼Œåªæ˜¯è¨­ç½®æ›´ç°¡æ½”
      const result = await testEnvironment.executeWorkflow('basic-extraction')

      expect(result.success).toBe(true)
      expect(result.extractedBooks).toHaveLength(10)
      expect(result.processingTime).toBeLessThan(2000)
    })
  })

  describe('éŒ¯èª¤è™•ç†æ¸¬è©¦', () => {
    test('Storage éŒ¯èª¤æ¢å¾©æ©Ÿåˆ¶', async () => {
      // ä½¿ç”¨æ–°çš„éŒ¯èª¤æ³¨å…¥API
      testEnvironment.injectError('storage-failure')

      const result = await testEnvironment.executeWorkflow('storage-error-recovery')

      expect(result.errorHandled).toBe(true)
      expect(result.recoverySuccess).toBe(true)
    })
  })
})
```

### é æœŸé©—è­‰è¨ˆåŠƒ

#### é©—è­‰æ­¥é©Ÿ

1. **åŸºæœ¬åŠŸèƒ½é©—è­‰**

   ```bash
   npm test -- --testPathPattern="e2e" --verbose
   ```

2. **é‡æ§‹å“è³ªé©—è­‰**

   ```bash
   npm run lint
   npm run test:coverage
   ```

3. **æ•ˆèƒ½å½±éŸ¿é©—è­‰**

   ```bash
   npm run test:performance
   ```

4. **å®Œæ•´æ¸¬è©¦å¥—ä»¶é©—è­‰**
   ```bash
   npm test
   ```

#### æˆåŠŸæ¨™æº–æª¢æŸ¥æ¸…å–®

- [ ] æ‰€æœ‰25å€‹E2Eæ¸¬è©¦æ¡ˆä¾‹100%é€šé
- [ ] æ¸¬è©¦è¨­ç½®ä»£ç¢¼é‡è¤‡ç‡é™è‡³10%ä»¥ä¸‹
- [ ] æ‰€æœ‰æ–°æ–¹æ³•ç¬¦åˆFive Linesè¦å‰‡
- [ ] Chrome API Mockè¡Œç‚ºä¸€è‡´æ€§100%
- [ ] æ¸¬è©¦åŸ·è¡Œæ™‚é–“ä¸è¶…éåŸæ™‚é–“120%
- [ ] Linteræª¢æŸ¥100%é€šé
- [ ] æ¸¬è©¦è¦†è“‹ç‡ç¶­æŒæˆ–æå‡

---

## ğŸ“ Phase 3: é‡æ§‹å®Œæˆèˆ‡å·¥ä½œæ—¥èªŒç¸½çµ

_æ­¤ç« ç¯€å°‡åœ¨å¯¦éš›é‡æ§‹åŸ·è¡Œå¾Œæ›´æ–°å®Œæ•´å…§å®¹_

### é æœŸé‡æ§‹ç¸½çµæ¡†æ¶

#### ç›®æ¨™é”æˆæƒ…æ³è©•ä¼°

- [ ] æ¸¬è©¦åŸºç¤è¨­æ–½çµ±ä¸€å®Œæˆåº¦
- [ ] Five Linesè¦å‰‡åˆè¦ç‡
- [ ] å–®ä¸€è²¬ä»»åŸå‰‡å¯¦ç¾åº¦
- [ ] æ¸¬è©¦é€šéç‡é”æˆæƒ…æ³
- [ ] æ•ˆèƒ½å½±éŸ¿è©•ä¼°çµæœ

#### é æœŸç®¡ç†çš„å­¸ç¿’è¨˜éŒ„

- å“ªäº›é æœŸæ˜¯æ­£ç¢ºçš„ï¼Ÿç‚ºä»€éº¼ï¼Ÿ
- å“ªäº›é æœŸæ˜¯éŒ¯èª¤çš„ï¼Ÿç‚ºä»€éº¼ï¼Ÿ
- æ¸¬è©¦å¤±æ•—çš„å¯¦éš›åŸå› èˆ‡é æœŸå·®ç•°åˆ†æ
- Mockè¡Œç‚ºæ”¹è®Šå°æ¸¬è©¦çš„å¯¦éš›å½±éŸ¿

#### æ–¹æ³•è«–çš„æ”¹é€²å»ºè­°

- é‡æ§‹è¨ˆåŠƒçš„æº–ç¢ºæ€§è©•ä¼°
- é æœŸç®¡ç†æ–¹æ³•çš„æ”¹é€²ç©ºé–“
- æœªä¾†é¡ä¼¼é‡æ§‹çš„é é˜²ç­–ç•¥
- é‡æ§‹éç¨‹ä¸­ç™¼ç¾çš„æ¶æ§‹æ”¹å–„æ©Ÿæœƒ

---

**æ­¤å·¥ä½œæ—¥èªŒå°‡åœ¨é‡æ§‹åŸ·è¡Œéç¨‹ä¸­æŒçºŒæ›´æ–°ï¼Œè¨˜éŒ„å¯¦éš›åŸ·è¡Œçµæœèˆ‡é æœŸçš„å°æ¯”åˆ†æ**
