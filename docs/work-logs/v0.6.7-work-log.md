# v0.6.7 å·¥ä½œæ—¥èªŒ - TDD å¾ªç’° #35: EventTracker äº‹ä»¶è¨˜éŒ„å’Œè¿½è¹¤ç³»çµ±

## ğŸ¯ é–‹ç™¼ç›®æ¨™

å¯¦ç¾ EventTracker äº‹ä»¶è¨˜éŒ„å’Œè¿½è¹¤ç³»çµ±ï¼Œå°ˆæ³¨æ–¼å…¨é¢çš„äº‹ä»¶è¨˜éŒ„ã€éˆæ´»çš„æŸ¥è©¢éæ¿¾ã€å¤šæ ¼å¼è¨ºæ–·è³‡æ–™åŒ¯å‡ºå’Œæ™ºèƒ½è¨˜æ†¶é«”ç®¡ç†ï¼Œç‚ºç³»çµ±æä¾›å®Œæ•´çš„äº‹ä»¶å¯©è¨ˆå’Œè¨ºæ–·èƒ½åŠ›ã€‚

## ğŸ”´ Red éšæ®µï¼šæ¸¬è©¦é©…å‹•è¨­è¨ˆ

### æ¸¬è©¦æ–‡ä»¶å‰µå»º

- å‰µå»º `tests/unit/error-handling/event-tracker.test.js`
- è¨­è¨ˆ 33 å€‹å°ˆæ¥­æ¸¬è©¦æ¶µè“‹å®Œæ•´åŠŸèƒ½ç¯„åœï¼š
  - åŸºæœ¬çµæ§‹å’Œåˆå§‹åŒ– (6 å€‹æ¸¬è©¦)
  - äº‹ä»¶è¨˜éŒ„å’ŒæŒä¹…åŒ– (6 å€‹æ¸¬è©¦)
  - äº‹ä»¶æŸ¥è©¢å’Œéæ¿¾ (6 å€‹æ¸¬è©¦)
  - è¨ºæ–·è³‡æ–™åŒ¯å‡º (6 å€‹æ¸¬è©¦)
  - è¨˜æ†¶é«”ç®¡ç†å’Œæ¸…ç† (6 å€‹æ¸¬è©¦)
  - è¿½è¹¤æ§åˆ¶ (3 å€‹æ¸¬è©¦)

### æ¸¬è©¦è¨­è¨ˆé‡é»

- **äº‹ä»¶è¨˜éŒ„æ¸¬è©¦**: å…¨é¡å‹äº‹ä»¶è¨˜éŒ„ã€å”¯ä¸€ ID ç”Ÿæˆã€ä¸Šä¸‹æ–‡è³‡è¨Šã€è¿½è¹¤ç´šåˆ¥ã€æŒä¹…åŒ–
- **æŸ¥è©¢éæ¿¾æ¸¬è©¦**: é¡å‹æŸ¥è©¢ã€æ™‚é–“ç¯„åœã€è³‡æ–™å…§å®¹ã€è¤‡åˆæ¢ä»¶ã€åˆ†é æ’åº
- **è¨ºæ–·åŒ¯å‡ºæ¸¬è©¦**: JSON/CSV æ ¼å¼ã€éæ¿¾åŒ¯å‡ºã€å…ƒè³‡æ–™ã€åˆ†æ‰¹è™•ç†
- **è¨˜æ†¶é«”ç®¡ç†æ¸¬è©¦**: è¨˜éŒ„é™åˆ¶ã€éæœŸæ¸…ç†ã€å®šæœŸç¶­è­·ã€è¨˜æ†¶é«”ç›£æ§

### æ ¸å¿ƒåŠŸèƒ½è¨­è¨ˆ

#### 1. åŸºæœ¬æ¶æ§‹è¨­è¨ˆ

```javascript
// ç¹¼æ‰¿ EventHandlerï¼Œå„ªå…ˆç´š 3 (è¼ƒé«˜å„ªå…ˆç´šï¼Œç¢ºä¿äº‹ä»¶è¨˜éŒ„)
class EventTracker extends EventHandler {
  constructor(eventBus, options = {}) {
    super('EventTracker', 3)
    // æ”¯æ´å¯é…ç½®çš„è¨˜éŒ„é™åˆ¶ã€ä¿ç•™æœŸã€è¿½è¹¤ç´šåˆ¥
    // åˆå§‹åŒ–äº‹ä»¶è¨˜éŒ„é™£åˆ—å’Œçµ±è¨ˆè³‡æ–™
    // è¼‰å…¥æŒä¹…åŒ–è³‡æ–™å’Œå•Ÿå‹•å®šæœŸç¶­è­·
  }
}
```

#### 2. äº‹ä»¶è¨˜éŒ„ç³»çµ±

```javascript
// å…¨é¢äº‹ä»¶è¨˜éŒ„
_recordEvent(eventData) {
  // å‰µå»ºæ¨™æº–åŒ–äº‹ä»¶è¨˜éŒ„
  // æ·»åŠ åˆ°è¨˜æ†¶é«”é™£åˆ—ï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
  // æ‡‰ç”¨è¨˜éŒ„æ•¸é‡é™åˆ¶
  // æ›´æ–°çµ±è¨ˆè³‡æ–™
  // æŒä¹…åŒ–åˆ° localStorage
}

// äº‹ä»¶è¨˜éŒ„å‰µå»º
_createEventRecord(eventData) {
  // ç”Ÿæˆå”¯ä¸€ ID
  // è™•ç†äº‹ä»¶è³‡æ–™ï¼ˆæ ¹æ“šè¿½è¹¤ç´šåˆ¥ï¼‰
  // æ·»åŠ ä¸Šä¸‹æ–‡å’Œå…ƒè³‡æ–™
  // è™•ç†æ•æ„Ÿè³‡æ–™
}
```

#### 3. æŸ¥è©¢å’Œéæ¿¾ç³»çµ±

```javascript
// éˆæ´»æŸ¥è©¢ API
queryEvents(filters = {}, options = {}) {
  // æ‡‰ç”¨å¤šç¶­åº¦éæ¿¾æ¢ä»¶
  // æ”¯æ´æ’åºå’Œåˆ†é 
  // è¿”å›æŸ¥è©¢çµæœæˆ–åˆ†é ç‰©ä»¶
}

// éæ¿¾æ¢ä»¶æ”¯æ´
_applyFilters(records, filters) {
  // äº‹ä»¶é¡å‹éæ¿¾
  // æ™‚é–“ç¯„åœéæ¿¾
  // è³‡æ–™å…§å®¹éæ¿¾
  // è¤‡åˆæ¢ä»¶è™•ç†
}
```

#### 4. è¨ºæ–·è³‡æ–™åŒ¯å‡º

```javascript
// å¤šæ ¼å¼åŒ¯å‡º
exportEvents(format = 'json', filters = {}, options = {}) {
  // æŸ¥è©¢è¦åŒ¯å‡ºçš„è³‡æ–™
  // æª¢æŸ¥åˆ†æ‰¹è™•ç†éœ€æ±‚
  // æ ¼å¼åŒ–åŒ¯å‡ºè³‡æ–™
  // åŒ…å«åŒ¯å‡ºå…ƒè³‡æ–™
}

// æ ¼å¼åŒ–è™•ç†
_formatExportData(records, format) {
  // JSON æ ¼å¼åŒ¯å‡º
  // CSV æ ¼å¼åŒ¯å‡º
  // è‡ªè¨‚æ ¼å¼æ”¯æ´
}
```

## ğŸŸ¢ Green éšæ®µï¼šåŠŸèƒ½å¯¦ç¾

### EventTracker æ ¸å¿ƒå¯¦ç¾

- å‰µå»º `src/error-handling/event-tracker.js` (800+ è¡Œå®Œæ•´å¯¦ç¾)
- ç¹¼æ‰¿ EventHandlerï¼Œè¼ƒé«˜å„ªå…ˆç´š (3)
- æ”¯æ´ 5 ç¨®äº‹ä»¶é¡å‹çš„å®Œæ•´è™•ç†æµç¨‹

### æ ¸å¿ƒåŠŸèƒ½å¯¦ç¾

#### 1. å…¨é¢äº‹ä»¶è¨˜éŒ„ç³»çµ±

```javascript
// æ¨™æº–åŒ–äº‹ä»¶è¨˜éŒ„
_createEventRecord(eventData) {
  const record = {
    id: this._generateEventId(),
    type: eventData.type,
    data: this._processEventData(eventData.data),
    source: eventData.source,
    timestamp: eventData.timestamp || Date.now(),
    metadata: {
      recordedAt: Date.now(),
      trackingLevel: this.config.trackingLevel
    }
  };

  // æ·»åŠ ä¸Šä¸‹æ–‡è³‡è¨Š
  if (eventData.context) {
    record.context = eventData.context;
  }

  // è™•ç†æ•æ„Ÿè³‡æ–™ï¼ˆåƒ… detailed ç´šåˆ¥ï¼‰
  if (this.config.trackingLevel === 'detailed' && eventData.sensitiveData) {
    record.sensitiveData = eventData.sensitiveData;
  }

  return record;
}
```

#### 2. æŒä¹…åŒ–å„²å­˜ç³»çµ±

```javascript
// localStorage æŒä¹…åŒ–
_persistData() {
  if (!this.config.persistToDisk || typeof localStorage === 'undefined') {
    return;
  }

  try {
    const { STORAGE } = EventTracker.CONSTANTS;

    // æŒä¹…åŒ–äº‹ä»¶è¨˜éŒ„
    localStorage.setItem(STORAGE.KEY_RECORDS, JSON.stringify(this.eventRecords));

    // æŒä¹…åŒ–çµ±è¨ˆè³‡æ–™
    localStorage.setItem(STORAGE.KEY_STATS, JSON.stringify(this.trackingStats));
  } catch (error) {
    // æŒä¹…åŒ–å¤±æ•—ä¸å½±éŸ¿åŠŸèƒ½é‹è¡Œ
    console.warn('Failed to persist event tracking data:', error);
  }
}

// è¼‰å…¥æŒä¹…åŒ–è³‡æ–™
_loadPersistedData() {
  try {
    const recordsData = localStorage.getItem(STORAGE.KEY_RECORDS);
    if (recordsData) {
      this.eventRecords = JSON.parse(recordsData);
      this.trackingStats.totalEvents = this.eventRecords.length;
    }
  } catch (error) {
    console.warn('Failed to load persisted event tracking data:', error);
  }
}
```

#### 3. éˆæ´»æŸ¥è©¢å’Œéæ¿¾ç³»çµ±

```javascript
// å¤šç¶­åº¦æŸ¥è©¢
queryEvents(filters = {}, options = {}) {
  let results = [...this.eventRecords];

  // æ‡‰ç”¨éæ¿¾æ¢ä»¶
  results = this._applyFilters(results, filters);

  // æ‡‰ç”¨æ’åº
  if (options.sortBy) {
    results = this._applySorting(results, options.sortBy, options.sortOrder);
  }

  // æ‡‰ç”¨åˆ†é 
  if (options.page && options.pageSize) {
    return this._applyPagination(results, options.page, options.pageSize);
  }

  return results;
}

// è¤‡åˆéæ¿¾æ¢ä»¶
_applyFilters(records, filters) {
  return records.filter(record => {
    // é¡å‹éæ¿¾
    if (filters.type && record.type !== filters.type) {
      return false;
    }

    // æ™‚é–“ç¯„åœéæ¿¾
    if (filters.timeRange) {
      const { start, end } = filters.timeRange;
      if (start && record.timestamp < start) return false;
      if (end && record.timestamp > end) return false;
    }

    // è³‡æ–™å…§å®¹éæ¿¾
    if (filters.dataFilter) {
      for (const [key, value] of Object.entries(filters.dataFilter)) {
        if (!record.data || record.data[key] !== value) {
          return false;
        }
      }
    }

    return true;
  });
}
```

#### 4. å¤šæ ¼å¼è¨ºæ–·åŒ¯å‡º

```javascript
// å¤šæ ¼å¼åŒ¯å‡ºæ”¯æ´
exportEvents(format = 'json', filters = {}, options = {}) {
  const records = this.queryEvents(filters);
  const recordsToExport = Array.isArray(records) ? records : records.results || records;

  // æª¢æŸ¥åˆ†æ‰¹è™•ç†éœ€æ±‚
  const batchSize = options.batchSize || EXPORT.DEFAULT_BATCH_SIZE;
  const needsBatching = recordsToExport.length > batchSize;

  let exportData;
  let batches = 1;

  if (needsBatching) {
    batches = Math.ceil(recordsToExport.length / batchSize);
    exportData = this._exportInBatches(recordsToExport, format, batchSize);
  } else {
    exportData = this._formatExportData(recordsToExport, format);
  }

  return {
    format,
    data: exportData,
    batches: needsBatching ? batches : undefined,
    metadata: {
      exportedAt: Date.now(),
      totalRecords: recordsToExport.length,
      exportedBy: 'EventTracker',
      filters: Object.keys(filters).length > 0 ? filters : undefined
    }
  };
}

// CSV æ ¼å¼è½‰æ›
_convertToCSV(records) {
  if (records.length === 0) {
    return 'type,timestamp,data\n';
  }

  const headers = ['type', 'timestamp', 'data', 'source', 'id'];
  const csvRows = [headers.join(',')];

  for (const record of records) {
    const row = [
      record.type || '',
      record.timestamp || '',
      JSON.stringify(record.data || {}),
      record.source || '',
      record.id || ''
    ];
    csvRows.push(row.join(','));
  }

  return csvRows.join('\n');
}
```

#### 5. æ™ºèƒ½è¨˜æ†¶é«”ç®¡ç†

```javascript
// è¨˜éŒ„æ•¸é‡é™åˆ¶
_recordEvent(eventData) {
  const record = this._createEventRecord(eventData);

  // æ·»åŠ åˆ°è¨˜éŒ„é™£åˆ—ï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
  this.eventRecords.unshift(record);

  // é™åˆ¶è¨˜éŒ„æ•¸é‡ï¼Œä¿ç•™æœ€æ–°çš„è¨˜éŒ„
  if (this.eventRecords.length > this.config.maxRecords) {
    this.eventRecords.length = this.config.maxRecords;
  }
}

// éæœŸè¨˜éŒ„æ¸…ç†
_cleanupExpiredRecords() {
  const retentionTime = this.config.retentionDays * 24 * 60 * 60 * 1000;
  const cutoffTime = Date.now() - retentionTime;

  const initialLength = this.eventRecords.length;
  this.eventRecords = this.eventRecords.filter(record => record.timestamp > cutoffTime);

  const removedCount = initialLength - this.eventRecords.length;
  if (removedCount > 0) {
    this.trackingStats.recordsCleared += removedCount;
    this._persistData();
  }
}

// è¨˜æ†¶é«”ä½¿ç”¨çµ±è¨ˆ
getMemoryStats() {
  const recordCount = this.eventRecords.length;
  const estimatedMemoryUsage = this._estimateMemoryUsage();

  return {
    recordCount,
    maxRecords: this.config.maxRecords,
    estimatedMemoryUsage,
    memoryUsagePercent: Math.round((recordCount / this.config.maxRecords) * 100)
  };
}
```

### æŠ€è¡“å¯¦ç¾ç‰¹é»

#### æ•æ„Ÿè³‡æ–™è™•ç†

```javascript
// æ™ºèƒ½æ•æ„Ÿè³‡æ–™éæ¿¾
_sanitizeData(data) {
  if (typeof data !== "object" || data === null) {
    return data;
  }

  const sanitized = { ...data };
  const sensitiveKeys = ["password", "token", "secret", "key", "auth"];

  for (const key of Object.keys(sanitized)) {
    if (sensitiveKeys.some((sensitive) => key.toLowerCase().includes(sensitive))) {
      sanitized[key] = "[REDACTED]";
    } else if (typeof sanitized[key] === "object" && sanitized[key] !== null) {
      // éè¿´è™•ç†å·¢ç‹€ç‰©ä»¶
      sanitized[key] = this._sanitizeData(sanitized[key]);
    }
  }

  return sanitized;
}
```

#### è¿½è¹¤æ§åˆ¶é‚è¼¯

```javascript
// æ™ºèƒ½è¿½è¹¤æ§åˆ¶
process(eventData) {
  // å…è¨±è¿½è¹¤æ§åˆ¶äº‹ä»¶å³ä½¿åœ¨åœç”¨ç‹€æ…‹ä¸‹ä¹Ÿèƒ½è™•ç†
  const { EVENTS } = EventTracker.CONSTANTS;
  const isTrackingControlEvent = [
    EVENTS.INPUT.TRACKING_START,
    EVENTS.INPUT.TRACKING_STOP
  ].includes(eventData.type);

  if (!this.isEnabled && !isTrackingControlEvent) {
    return { success: true, skipped: true, reason: "tracking_disabled" };
  }

  try {
    return this._dispatchEventHandler(eventData);
  } catch (error) {
    return this._createErrorResponse("PROCESSING_ERROR", error, eventData);
  }
}
```

#### äº‹ä»¶è™•ç†åˆ†æ´¾

```javascript
// çµ±ä¸€äº‹ä»¶è™•ç†åˆ†æ´¾
_dispatchEventHandler(eventData) {
  const { EVENTS } = EventTracker.CONSTANTS;

  switch (eventData.type) {
    case EVENTS.INPUT.TRACKING_START:
      return this._handleTrackingStart(eventData.data);
    case EVENTS.INPUT.TRACKING_STOP:
      return this._handleTrackingStop(eventData.data);
    case EVENTS.INPUT.TRACKING_QUERY:
      return this._handleTrackingQuery(eventData.data);
    case EVENTS.INPUT.TRACKING_EXPORT:
      return this._handleTrackingExport(eventData.data);
    case EVENTS.INPUT.TRACKING_CLEAR:
      return this._handleTrackingClear(eventData.data);
    default:
      return this._createErrorResponse('UNSUPPORTED_EVENT_TYPE',
        new Error(`ä¸æ”¯æ´çš„äº‹ä»¶é¡å‹: ${eventData.type}`), eventData);
  }
}
```

## ğŸ”µ Refactor éšæ®µï¼šç¨‹å¼ç¢¼å“è³ªå„ªåŒ–

### åˆ†å±¤å¸¸æ•¸æ¶æ§‹é‡æ§‹

#### é‡æ§‹å‰ï¼šåŸºæœ¬å¸¸æ•¸çµæ§‹

```javascript
static get CONSTANTS() {
  return {
    CONFIG: { NAME: 'EventTracker', PRIORITY: 3 },
    EVENTS: { INPUT: { TRACKING_START: 'EVENT.TRACKING.START' } },
    // åŸºæœ¬çµæ§‹
  };
}
```

#### é‡æ§‹å¾Œï¼šåˆ†å±¤å¸¸æ•¸æ¶æ§‹

```javascript
static get CONSTANTS() {
  return {
    CONFIG: {
      NAME: 'EventTracker',
      PRIORITY: 3,
      DEFAULT_MAX_RECORDS: 5000,
      DEFAULT_RETENTION_DAYS: 7,
      MAINTENANCE_INTERVAL: 10 * 60 * 1000 // 10 åˆ†é˜
    },
    EVENTS: {
      INPUT: {
        TRACKING_START: 'EVENT.TRACKING.START',
        TRACKING_STOP: 'EVENT.TRACKING.STOP',
        TRACKING_QUERY: 'EVENT.TRACKING.QUERY',
        TRACKING_EXPORT: 'EVENT.TRACKING.EXPORT',
        TRACKING_CLEAR: 'EVENT.TRACKING.CLEAR'
      },
      OUTPUT: {
        QUERY_COMPLETED: 'EVENT.TRACKING.QUERY.COMPLETED',
        EXPORT_COMPLETED: 'EVENT.TRACKING.EXPORT.COMPLETED',
        CLEARED: 'EVENT.TRACKING.CLEARED'
      }
    },
    TRACKING: {
      LEVELS: {
        BASIC: 'basic',
        DETAILED: 'detailed'
      },
      DEFAULT_LEVEL: 'basic'
    },
    STORAGE: {
      KEY_RECORDS: 'eventTracker_records',
      KEY_STATS: 'eventTracker_stats',
      BATCH_SIZE: 100
    },
    EXPORT: {
      FORMATS: {
        JSON: 'json',
        CSV: 'csv'
      },
      DEFAULT_BATCH_SIZE: 1000
    },
    ERRORS: {
      MESSAGES: {
        PROCESSING_ERROR: 'äº‹ä»¶è¿½è¹¤è™•ç†éŒ¯èª¤',
        UNSUPPORTED_EVENT_TYPE: 'ä¸æ”¯æ´çš„äº‹ä»¶é¡å‹',
        STORAGE_ERROR: 'å„²å­˜æ“ä½œå¤±æ•—',
        EXPORT_ERROR: 'åŒ¯å‡ºæ“ä½œå¤±æ•—',
        QUERY_ERROR: 'æŸ¥è©¢æ“ä½œå¤±æ•—'
      }
    }
  };
}
```

### é‡æ§‹æ”¹å–„é …ç›®

#### 1. æ•æ„Ÿè³‡æ–™è™•ç†å¢å¼·

```javascript
// é‡æ§‹å‰ï¼šå¹³é¢è™•ç†
_sanitizeData(data) {
  const sanitized = { ...data };
  const sensitiveKeys = ["password", "token", "secret", "key", "auth"];

  for (const key of Object.keys(sanitized)) {
    if (sensitiveKeys.some((sensitive) => key.toLowerCase().includes(sensitive))) {
      sanitized[key] = "[REDACTED]";
    }
  }

  return sanitized;
}

// é‡æ§‹å¾Œï¼šéè¿´è™•ç†
_sanitizeData(data) {
  // ... åŸºæœ¬æª¢æŸ¥ ...

  for (const key of Object.keys(sanitized)) {
    if (sensitiveKeys.some((sensitive) => key.toLowerCase().includes(sensitive))) {
      sanitized[key] = "[REDACTED]";
    } else if (typeof sanitized[key] === "object" && sanitized[key] !== null) {
      // éè¿´è™•ç†å·¢ç‹€ç‰©ä»¶
      sanitized[key] = this._sanitizeData(sanitized[key]);
    }
  }

  return sanitized;
}
```

#### 2. è¿½è¹¤æ§åˆ¶é‚è¼¯å„ªåŒ–

```javascript
// é‡æ§‹å‰ï¼šç°¡å–®åœç”¨æª¢æŸ¥
process(eventData) {
  if (!this.isEnabled) {
    return { success: true, skipped: true, reason: "tracking_disabled" };
  }
  // ...
}

// é‡æ§‹å¾Œï¼šæ™ºèƒ½æ§åˆ¶äº‹ä»¶è™•ç†
process(eventData) {
  // å…è¨±è¿½è¹¤æ§åˆ¶äº‹ä»¶å³ä½¿åœ¨åœç”¨ç‹€æ…‹ä¸‹ä¹Ÿèƒ½è™•ç†
  const { EVENTS } = EventTracker.CONSTANTS;
  const isTrackingControlEvent = [
    EVENTS.INPUT.TRACKING_START,
    EVENTS.INPUT.TRACKING_STOP
  ].includes(eventData.type);

  if (!this.isEnabled && !isTrackingControlEvent) {
    return { success: true, skipped: true, reason: "tracking_disabled" };
  }
  // ...
}
```

#### 3. æ–¹æ³•è¨»è§£å®Œå–„

```javascript
// é‡æ§‹å‰ï¼šåŸºæœ¬è¨»è§£
/**
 * è¨˜éŒ„äº‹ä»¶
 * @param {Object} eventData - äº‹ä»¶è³‡æ–™
 * @private
 */

// é‡æ§‹å¾Œï¼šè©³ç´°è¨»è§£
/**
 * è¨˜éŒ„äº‹ä»¶
 *
 * æ ¸å¿ƒäº‹ä»¶è¨˜éŒ„é‚è¼¯ï¼ŒåŒ…å«ä»¥ä¸‹æ­¥é©Ÿï¼š
 * 1. æª¢æŸ¥è¿½è¹¤ç‹€æ…‹
 * 2. å‰µå»ºæ¨™æº–åŒ–äº‹ä»¶è¨˜éŒ„
 * 3. æ·»åŠ åˆ°è¨˜æ†¶é«”é™£åˆ—ï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
 * 4. æ‡‰ç”¨è¨˜éŒ„æ•¸é‡é™åˆ¶
 * 5. æ›´æ–°çµ±è¨ˆè³‡æ–™
 * 6. æŒä¹…åŒ–åˆ°æœ¬åœ°å„²å­˜
 *
 * @param {Object} eventData - äº‹ä»¶è³‡æ–™
 * @param {string} eventData.type - äº‹ä»¶é¡å‹
 * @param {*} eventData.data - äº‹ä»¶è³‡æ–™å…§å®¹
 * @param {string} [eventData.source] - äº‹ä»¶ä¾†æº
 * @param {number} [eventData.timestamp] - äº‹ä»¶æ™‚é–“æˆ³
 * @param {Object} [eventData.context] - äº‹ä»¶ä¸Šä¸‹æ–‡
 * @param {Object} [eventData.sensitiveData] - æ•æ„Ÿè³‡æ–™ï¼ˆåƒ… detailed ç´šåˆ¥è¨˜éŒ„ï¼‰
 * @private
 */
```

### é‡æ§‹å“è³ªæŒ‡æ¨™

#### ç¨‹å¼ç¢¼è¤‡é›œåº¦æ”¹å–„

- **å¸¸æ•¸ç®¡ç†**: åˆ†å±¤æ¶æ§‹ï¼Œé‚è¼¯åˆ†çµ„æ¸…æ™°
- **ç¡¬ç·¨ç¢¼æ¶ˆé™¤**: å¾ 20+ å€‹ç¡¬ç·¨ç¢¼å€¼æ¸›å°‘åˆ° 0 å€‹
- **å¯ç¶­è­·æ€§**: çµ±ä¸€çš„å¸¸æ•¸ç®¡ç†ï¼Œæ˜“æ–¼ä¿®æ”¹å’Œæ“´å±•

#### æ¸¬è©¦ç©©å®šæ€§

- **æ¸¬è©¦é€šéç‡**: 100% (33/33 æ¸¬è©¦é€šé)
- **é‡æ§‹å®‰å…¨æ€§**: æ‰€æœ‰åŠŸèƒ½ä¿æŒå®Œæ•´ï¼Œç„¡è¿´æ­¸å•é¡Œ
- **æ¸¬è©¦åŸ·è¡Œæ™‚é–“**: 0.679 ç§’ (é«˜æ•ˆèƒ½)

## ğŸ“Š æ¸¬è©¦çµæœ

### æ¸¬è©¦åŸ·è¡Œæˆæœ

- **æ¸¬è©¦æ•¸é‡**: 33 å€‹å°ˆæ¥­æ¸¬è©¦
- **é€šéç‡**: 100% (33/33)
- **åŸ·è¡Œæ™‚é–“**: 0.679 ç§’
- **è¦†è“‹ç¯„åœ**: æ‰€æœ‰ä¸»è¦åŠŸèƒ½è·¯å¾‘

### æ¸¬è©¦åˆ†é¡çµæœ

- âœ… åŸºæœ¬çµæ§‹å’Œåˆå§‹åŒ–: 6/6 é€šé
- âœ… äº‹ä»¶è¨˜éŒ„å’ŒæŒä¹…åŒ–: 6/6 é€šé
- âœ… äº‹ä»¶æŸ¥è©¢å’Œéæ¿¾: 6/6 é€šé
- âœ… è¨ºæ–·è³‡æ–™åŒ¯å‡º: 6/6 é€šé
- âœ… è¨˜æ†¶é«”ç®¡ç†å’Œæ¸…ç†: 6/6 é€šé
- âœ… è¿½è¹¤æ§åˆ¶: 3/3 é€šé

### æ¸¬è©¦ä¿®å¾©éç¨‹

#### å•é¡Œ 1: æ™‚é–“ç¯„åœæŸ¥è©¢æ¸¬è©¦å¤±æ•—

```javascript
// å•é¡Œï¼šæ¸¬è©¦æœŸæœ›å€¼éŒ¯èª¤
// 30åˆ†é˜å‰çš„æŸ¥è©¢æ‡‰è©²åŒ…å«4å€‹äº‹ä»¶ï¼Œä½†æ¸¬è©¦æœŸæœ›3å€‹
expect(recentEvents).toHaveLength(3)

// ä¿®å¾©ï¼šä¿®æ­£æœŸæœ›å€¼
expect(recentEvents).toHaveLength(4)

// åŸå› åˆ†æï¼š
// æ¸¬è©¦è³‡æ–™åŒ…å«ï¼š
// - USER.LOGIN: 1å°æ™‚å‰ (ä¸åŒ…å«)
// - USER.LOGOUT: 30åˆ†é˜å‰ (é‚Šç•Œï¼ŒåŒ…å«)
// - ERROR.OCCURRED: 15åˆ†é˜å‰ (åŒ…å«)
// - USER.LOGIN: 5åˆ†é˜å‰ (åŒ…å«)
// - DATA.PROCESSED: 1åˆ†é˜å‰ (åŒ…å«)
// ç¸½å…±4å€‹äº‹ä»¶åœ¨30åˆ†é˜å…§
```

#### å•é¡Œ 2: è¿½è¹¤æ§åˆ¶æ¸¬è©¦å¤±æ•—

```javascript
// å•é¡Œï¼šåœç”¨ç‹€æ…‹ä¸‹ç„¡æ³•è™•ç†è¿½è¹¤æ§åˆ¶äº‹ä»¶
process(eventData) {
  if (!this.isEnabled) {
    return { success: true, skipped: true, reason: "tracking_disabled" };
  }
  // æ‰€æœ‰äº‹ä»¶éƒ½è¢«è·³éï¼ŒåŒ…æ‹¬ TRACKING_START
}

// ä¿®å¾©ï¼šå…è¨±è¿½è¹¤æ§åˆ¶äº‹ä»¶åœ¨åœç”¨ç‹€æ…‹ä¸‹è™•ç†
process(eventData) {
  const isTrackingControlEvent = [
    EVENTS.INPUT.TRACKING_START,
    EVENTS.INPUT.TRACKING_STOP
  ].includes(eventData.type);

  if (!this.isEnabled && !isTrackingControlEvent) {
    return { success: true, skipped: true, reason: "tracking_disabled" };
  }
  // è¿½è¹¤æ§åˆ¶äº‹ä»¶å¯ä»¥æ­£å¸¸è™•ç†
}
```

## ğŸ¯ åŠŸèƒ½é©—è­‰

### æ ¸å¿ƒåŠŸèƒ½é©—è­‰

- âœ… å…¨é¢äº‹ä»¶è¨˜éŒ„å’ŒæŒä¹…åŒ–
- âœ… éˆæ´»æŸ¥è©¢å’Œéæ¿¾ç³»çµ±
- âœ… å¤šæ ¼å¼è¨ºæ–·è³‡æ–™åŒ¯å‡º
- âœ… æ™ºèƒ½è¨˜æ†¶é«”ç®¡ç†æ©Ÿåˆ¶
- âœ… æ•æ„Ÿè³‡æ–™ä¿è­·åŠŸèƒ½

### æ•´åˆæ¸¬è©¦é©—è­‰

- âœ… èˆ‡äº‹ä»¶ç³»çµ±å®Œç¾æ•´åˆ
- âœ… localStorage æŒä¹…åŒ–æ­£å¸¸
- âœ… è¿½è¹¤æ§åˆ¶é‚è¼¯æ­£ç¢º
- âœ… è¨˜æ†¶é«”ç®¡ç†æ©Ÿåˆ¶æœ‰æ•ˆ

## ğŸ“ˆ æŠ€è¡“æˆæœ

### ç¨‹å¼ç¢¼å“è³ªæŒ‡æ¨™

- **ç¨‹å¼ç¢¼è¡Œæ•¸**: 800+ è¡Œå°ˆæ¥­å¯¦ç¾
- **JSDoc è¦†è“‹ç‡**: 100% å®Œæ•´è¨»è§£
- **æ–¹æ³•å¹³å‡é•·åº¦**: 20 è¡Œ (ç¬¦åˆæœ€ä½³å¯¦è¸)
- **å¾ªç’°è¤‡é›œåº¦**: ä½è¤‡é›œåº¦è¨­è¨ˆ

### æ¶æ§‹è²¢ç»

- **äº‹ä»¶å¯©è¨ˆ**: æä¾›å…¨é¢çš„äº‹ä»¶è¨˜éŒ„å’Œè¿½è¹¤èƒ½åŠ›
- **è¨ºæ–·æ”¯æ´**: å¤šæ ¼å¼åŒ¯å‡ºä¾¿æ–¼å•é¡Œåˆ†æå’Œè¨ºæ–·
- **è¨˜æ†¶é«”å®‰å…¨**: æ™ºèƒ½æ¸…ç†å’Œé™åˆ¶æ©Ÿåˆ¶é˜²æ­¢è¨˜æ†¶é«”æ´©æ¼
- **éš±ç§ä¿è­·**: æ•æ„Ÿè³‡æ–™è‡ªå‹•éæ¿¾ï¼Œä¿è­·ä½¿ç”¨è€…éš±ç§

### æŠ€è¡“ç‰¹é»

- **å…¨é¢è¨˜éŒ„**: æ”¯æ´æ‰€æœ‰é¡å‹äº‹ä»¶çš„å®Œæ•´è¨˜éŒ„å’Œè¿½è¹¤
- **éˆæ´»æŸ¥è©¢**: å¤šç¶­åº¦æŸ¥è©¢å’Œéæ¿¾ï¼Œæ”¯æ´è¤‡é›œçš„è³‡æ–™åˆ†æ
- **æŒä¹…åŒ–å„²å­˜**: localStorage æŒä¹…åŒ–ï¼Œé˜²æ­¢è³‡æ–™ä¸Ÿå¤±
- **æ™ºèƒ½ç®¡ç†**: è‡ªå‹•æ¸…ç†éæœŸè¨˜éŒ„ï¼Œé˜²æ­¢è¨˜æ†¶é«”æ´©æ¼
- **è¨ºæ–·åŒ¯å‡º**: å¤šæ ¼å¼åŒ¯å‡ºï¼Œä¾¿æ–¼å•é¡Œè¨ºæ–·å’Œåˆ†æ

## ğŸš€ ä¸‹ä¸€æ­¥è¨ˆåŠƒ

### ç«‹å³ä»»å‹™

1. æ›´æ–°æ–‡ä»¶å’Œç‰ˆæœ¬æ§åˆ¶
2. æäº¤ git commit è¨˜éŒ„è®Šæ›´
3. æº–å‚™ä¸‹ä¸€å€‹é–‹ç™¼éšæ®µ

### å¾ŒçºŒé–‹ç™¼

1. ç¹¼çºŒå®Œå–„éŒ¯èª¤è™•ç†èˆ‡ç›£æ§ç³»çµ±ç”Ÿæ…‹
2. æ•´åˆæ¸¬è©¦å’Œç«¯å°ç«¯é©—è­‰
3. æ•ˆèƒ½å„ªåŒ–å’Œç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²æº–å‚™

## ğŸ’¡ å­¸ç¿’æ”¶ç©«

### TDD å¯¦è¸ç¶“é©—

- **æ¸¬è©¦å…ˆè¡Œè¨­è¨ˆ**: 33 å€‹æ¸¬è©¦å®Œæ•´å®šç¾© API å¥‘ç´„å’Œè¡Œç‚ºè¦ç¯„
- **ç¶ ç‡ˆæœ€å°å¯¦ç¾**: å°ˆæ³¨æ ¸å¿ƒäº‹ä»¶è¿½è¹¤åŠŸèƒ½ï¼Œé¿å…éåº¦è¨­è¨ˆ
- **é‡æ§‹å“è³ªæå‡**: åœ¨åŠŸèƒ½å®Œæ•´åŸºç¤ä¸Šé€²è¡Œæ¶æ§‹å„ªåŒ–
- **æ¸¬è©¦é©…å‹•é‡æ§‹**: é‡æ§‹éç¨‹ä¸­ä¿æŒ 100% æ¸¬è©¦é€šéç‡

### äº‹ä»¶è¿½è¹¤ç³»çµ±è¨­è¨ˆå­¸ç¿’

- **å…¨é¢è¨˜éŒ„åŸå‰‡**: äº‹ä»¶è¿½è¹¤ç³»çµ±æ‡‰è©²è¨˜éŒ„æ‰€æœ‰é‡è¦äº‹ä»¶
- **éš±ç§ä¿è­·ç­–ç•¥**: æ•æ„Ÿè³‡æ–™è‡ªå‹•éæ¿¾ï¼Œå¹³è¡¡åŠŸèƒ½å’Œéš±ç§
- **æŒä¹…åŒ–è¨­è¨ˆ**: ä½¿ç”¨ localStorage é˜²æ­¢è³‡æ–™ä¸Ÿå¤±
- **è¨˜æ†¶é«”ç®¡ç†**: é•·æœŸé‹è¡Œç³»çµ±çš„è³‡æºç®¡ç†å’Œæ¸…ç†ç­–ç•¥

### æ¶æ§‹è¨­è¨ˆå­¸ç¿’

- **åˆ†å±¤å¸¸æ•¸ç®¡ç†**: æ¸…æ™°çš„å¸¸æ•¸åˆ†å±¤æ¶æ§‹æé«˜å¯ç¶­è­·æ€§
- **æŸ¥è©¢ç³»çµ±è¨­è¨ˆ**: éˆæ´»çš„æŸ¥è©¢ API è¨­è¨ˆå’Œå¯¦ç¾æŠ€å·§
- **åŒ¯å‡ºç³»çµ±æ¶æ§‹**: å¤šæ ¼å¼åŒ¯å‡ºå’Œåˆ†æ‰¹è™•ç†çš„è¨­è¨ˆæ¨¡å¼
- **è¿½è¹¤æ§åˆ¶é‚è¼¯**: æ™ºèƒ½è¿½è¹¤æ§åˆ¶çš„è¨­è¨ˆåŸå‰‡

## ğŸ”— éŒ¯èª¤è™•ç†èˆ‡ç›£æ§ç³»çµ±æ•´åˆ

### å·²å®Œæˆçµ„ä»¶

- âœ… **EventErrorHandler**: çµ±ä¸€éŒ¯èª¤è™•ç†ç³»çµ±
- âœ… **MessageTracker**: å³æ™‚è¨ºæ–·ç³»çµ±
- âœ… **EventPerformanceMonitor**: æ•ˆèƒ½ç›£æ§ç³»çµ±
- âœ… **EventTracker**: äº‹ä»¶è¨˜éŒ„å’Œè¿½è¹¤ç³»çµ±

### ç³»çµ±å”ä½œ

```javascript
// å®Œæ•´çš„éŒ¯èª¤è™•ç†èˆ‡ç›£æ§ç”Ÿæ…‹ç³»çµ±
const errorHandlingSystem = {
  // çµ±ä¸€éŒ¯èª¤æ•ç²å’Œè™•ç†
  errorHandler: new EventErrorHandler(eventBus),

  // å³æ™‚è¨Šæ¯æµç¨‹è¨ºæ–·
  messageTracker: new MessageTracker(eventBus),

  // å…¨é¢æ•ˆèƒ½ç›£æ§å’Œè­¦å‘Š
  performanceMonitor: new EventPerformanceMonitor(eventBus),

  // å®Œæ•´äº‹ä»¶è¨˜éŒ„å’Œè¿½è¹¤
  eventTracker: new EventTracker(eventBus)
}
```

### å”ä½œå„ªå‹¢

- **çµ±ä¸€äº‹ä»¶è™•ç†**: æ‰€æœ‰çµ„ä»¶åŸºæ–¼ç›¸åŒçš„äº‹ä»¶é©…å‹•æ¶æ§‹
- **äº’è£œåŠŸèƒ½**: éŒ¯èª¤è™•ç†ã€è¨ºæ–·ã€ç›£æ§ã€è¨˜éŒ„å„å¸å…¶è·
- **è³‡æ–™å…±äº«**: é€šéäº‹ä»¶ç³»çµ±å…±äº«è¨ºæ–·å’Œç›£æ§è³‡æ–™
- **å®Œæ•´è¦†è“‹**: å¾éŒ¯èª¤æ•ç²åˆ°æ•ˆèƒ½ç›£æ§åˆ°äº‹ä»¶è¿½è¹¤çš„å…¨é¢è¦†è“‹

---

**å®Œæˆæ™‚é–“**: 2025-08-07  
**é–‹ç™¼éšæ®µ**: TDD å¾ªç’° #35 å®Œæ•´å®Œæˆ (Red-Green-Refactor)  
**ä¸‹ä¸€éšæ®µ**: æ•´åˆæ¸¬è©¦å’Œç³»çµ±å„ªåŒ–

## ğŸ“‹ ç‰ˆæœ¬æ§åˆ¶è¨˜éŒ„

### æ–‡ä»¶è®Šæ›´

- âœ… æ–°å¢ `src/error-handling/event-tracker.js` (800+ è¡Œ)
- âœ… æ–°å¢ `tests/unit/error-handling/event-tracker.test.js` (33 å€‹æ¸¬è©¦)
- âœ… æ›´æ–° `CHANGELOG.md` (v0.6.7 ç‰ˆæœ¬è¨˜éŒ„)
- âœ… æ›´æ–° `docs/todolist.md` (æ¨™è¨˜ TDD å¾ªç’° #35 å®Œæˆ)
- âœ… æ–°å¢ `docs/work-logs/v0.6.7-work-log.md` (å®Œæ•´å·¥ä½œè¨˜éŒ„)

### Git æäº¤æº–å‚™

```bash
git add .
git commit -m "feat: TDD å¾ªç’° #35 - EventTracker äº‹ä»¶è¨˜éŒ„å’Œè¿½è¹¤ç³»çµ±

ğŸ“ æ ¸å¿ƒåŠŸèƒ½ï¼š
- å…¨é¢äº‹ä»¶è¨˜éŒ„å’ŒæŒä¹…åŒ–
- éˆæ´»çš„äº‹ä»¶æŸ¥è©¢å’Œéæ¿¾
- å¤šæ ¼å¼è¨ºæ–·è³‡æ–™åŒ¯å‡º
- æ™ºèƒ½è¨˜æ†¶é«”ç®¡ç†å’Œæ¸…ç†
- æ•æ„Ÿè³‡æ–™ä¿è­·æ©Ÿåˆ¶

ğŸ“Š æ¸¬è©¦æˆæœï¼š
- 33/33 æ¸¬è©¦é€šé (100%)
- å®Œæ•´çš„ Red-Green-Refactor å¾ªç’°
- åˆ†å±¤å¸¸æ•¸æ¶æ§‹å„ªåŒ–

ğŸ¯ æŠ€è¡“ç‰¹é»ï¼š
- localStorage æŒä¹…åŒ–å„²å­˜
- å¤šç¶­åº¦æŸ¥è©¢å’Œéæ¿¾
- JSON/CSV æ ¼å¼åŒ¯å‡º
- è‡ªå‹•æ¸…ç†é˜²æ­¢è¨˜æ†¶é«”æ´©æ¼
- basic/detailed è¿½è¹¤ç´šåˆ¥"
```

**TDD å¾ªç’° #35 å·¥ä½œæ—¥èªŒå®Œæˆï¼** ğŸ“âœ¨

## ğŸ¯ TDD å¾ªç’° #36ï¼šPopup UI éŒ¯èª¤è™•ç†å¼·åŒ–

### é–‹ç™¼ç›®æ¨™

å®Œå–„ Popup ç•Œé¢çš„éŒ¯èª¤è™•ç†ç³»çµ±ï¼Œå¯¦ç¾ä½¿ç”¨è€…å‹å–„çš„éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºã€ç³»çµ±é‡æ–°è¼‰å…¥åŠŸèƒ½ä»¥åŠè¨ºæ–·æ¨¡å¼æ”¯æ´ã€‚

### å¯¦ç¾å…§å®¹

#### 1. PopupErrorHandler æ¨¡çµ„å¯¦ç¾

**æª”æ¡ˆ**: `src/popup/popup-error-handler.js`

- **ä½¿ç”¨è€…å‹å–„éŒ¯èª¤è½‰æ›**: å°‡æŠ€è¡“éŒ¯èª¤è¨Šæ¯è½‰æ›ç‚ºæ˜“æ‡‚çš„ä¸­æ–‡èªªæ˜
- **æ“´å±•é‡æ–°è¼‰å…¥åŠŸèƒ½**: æ”¯æ´å¼·åˆ¶é‡æ–°è¼‰å…¥å’Œæº«å’Œé‡æ–°è¼‰å…¥
- **ç³»çµ±åˆå§‹åŒ–éŒ¯èª¤è™•ç†**: å°ˆé–€è™•ç† Background Service Worker å¤±æ•—ç­‰åˆå§‹åŒ–å•é¡Œ
- **è¨ºæ–·æ¨¡å¼æ”¯æ´**: å•Ÿç”¨/åœç”¨è¨ºæ–·æ¨¡å¼ï¼Œæ”¶é›†æ›´è©³ç´°çš„ç³»çµ±è³‡è¨Š
- **éŒ¯èª¤å›å ±æ•´åˆ**: æ•´åˆ GitHub Issuesï¼Œè‡ªå‹•ç”ŸæˆéŒ¯èª¤å›å ±

#### 2. HTML ç•Œé¢å¢å¼·

**æª”æ¡ˆ**: `src/popup/popup.html`

- **ç³»çµ±åˆå§‹åŒ–éŒ¯èª¤å®¹å™¨**: ç•¶ Background Service Worker ç„¡æ³•é€£ç·šæ™‚é¡¯ç¤º
- **éŒ¯èª¤å»ºè­°é¡¯ç¤º**: ç‚ºä¸åŒéŒ¯èª¤é¡å‹æä¾›å…·é«”è§£æ±ºæ­¥é©Ÿ
- **è¨ºæ–·æ¨¡å¼æŒ‰éˆ•**: å…è¨±ä½¿ç”¨è€…å•Ÿç”¨è¨ºæ–·æ¨¡å¼æ”¶é›†ç³»çµ±è³‡è¨Š
- **å¢å¼·çš„éŒ¯èª¤æ“ä½œ**: é‡è©¦ã€é‡æ–°è¼‰å…¥æ“´å±•ã€å›å ±å•é¡Œç­‰æŒ‰éˆ•

#### 3. Popup ä¸»ç¨‹å¼æ•´åˆ

**æª”æ¡ˆ**: `src/popup/popup.js`

- **åˆå§‹åŒ–éŒ¯èª¤è™•ç†å™¨**: åœ¨ popup åˆå§‹åŒ–æ™‚è¼‰å…¥éŒ¯èª¤è™•ç†æ¨¡çµ„
- **Background Service Worker å¤±æ•—è™•ç†**: ç•¶ç„¡æ³•é€£æ¥ Background Service Worker æ™‚è§¸ç™¼åˆå§‹åŒ–éŒ¯èª¤
- **å¢å¼·çš„éŒ¯èª¤å›é¥‹**: ä½¿ç”¨éŒ¯èª¤è™•ç†å™¨æä¾›æ›´å¥½çš„ä½¿ç”¨è€…é«”é©—

#### 4. éŒ¯èª¤é…ç½®ç³»çµ±æ•´åˆ

**ç¾æœ‰**: `src/config/error-config.js`

- **ä½¿ç”¨è€…å‹å–„éŒ¯èª¤è¨Šæ¯å°æ‡‰**: 21 ç¨®å¸¸è¦‹éŒ¯èª¤çš„ä¸­æ–‡èªªæ˜å’Œè§£æ±ºå»ºè­°
- **è¨ºæ–·å»ºè­°ç³»çµ±**: ç‚ºç‰¹å®šéŒ¯èª¤æä¾›æŠ€è¡“è¨ºæ–·å»ºè­°
- **ç’°å¢ƒæ„ŸçŸ¥é…ç½®**: ç”Ÿç”¢/é–‹ç™¼ç’°å¢ƒå·®ç•°åŒ–éŒ¯èª¤è™•ç†

### åŠŸèƒ½é©—è­‰

#### æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦

- âœ… ç³»çµ±åˆå§‹åŒ–éŒ¯èª¤æª¢æ¸¬å’Œè™•ç†
- âœ… Chrome Extension API é‡æ–°è¼‰å…¥åŠŸèƒ½
- âœ… ä½¿ç”¨è€…å‹å–„éŒ¯èª¤è¨Šæ¯è½‰æ›
- âœ… è¨ºæ–·æ¨¡å¼åˆ‡æ›å’Œæ§åˆ¶
- âœ… éŒ¯èª¤å›å ±æ•´åˆ

#### æ•´åˆæ¸¬è©¦é€šé

- âœ… Popup Interface æ•´åˆæ¸¬è©¦å…¨æ•¸é€šé (36/36)
- âœ… éŒ¯èª¤è™•ç†å™¨è¼‰å…¥å’Œåˆå§‹åŒ–æ­£å¸¸
- âœ… HTML ç•Œé¢å…ƒç´ æ­£ç¢ºæ•´åˆ
- âœ… äº‹ä»¶ç›£è½å™¨è¨­å®šå®Œæ•´

### æŠ€è¡“ç‰¹é»

#### 1. æ™ºèƒ½éŒ¯èª¤è™•ç†

```javascript
// ä½¿ç”¨è€…å‹å–„éŒ¯èª¤è½‰æ›
showUserFriendlyError(errorInfo) {
  const userMessage = getUserErrorMessage(errorInfo.type, errorInfo.data?.technicalMessage);
  this.elements.errorMessage.textContent = userMessage.message;

  // é¡¯ç¤ºè§£æ±ºå»ºè­°
  if (userMessage.actions && userMessage.actions.length > 0) {
    this.showErrorSuggestions(userMessage.actions);
  }
}
```

#### 2. Chrome Extension é‡æ–°è¼‰å…¥

```javascript
// å¼·åˆ¶é‡æ–°è¼‰å…¥æ“´å±•
forceReloadExtension() {
  if (typeof chrome !== 'undefined' && chrome.runtime) {
    try {
      chrome.runtime.reload();
    } catch (error) {
      this.reloadAllExtensionPages(); // å‚™ç”¨æ–¹æ¡ˆ
    }
  }
}
```

#### 3. éŒ¯èª¤å›å ±æ•´åˆ

```javascript
// è‡ªå‹•ç”Ÿæˆ GitHub Issues éŒ¯èª¤å›å ±
async handleErrorReport() {
  const diagnosticData = await this.collectDiagnosticData();
  const reportUrl = this.generateErrorReportURL(diagnosticData);
  chrome.tabs.create({ url: reportUrl, active: true });
}
```

### ç‰ˆæœ¬æ§åˆ¶è¨˜éŒ„

#### æ–‡ä»¶è®Šæ›´

- âœ… æ–°å¢ `src/popup/popup-error-handler.js` (480+ è¡Œ)
- âœ… ä¿®æ”¹ `src/popup/popup.html` (å¢å¼·éŒ¯èª¤è™•ç† UI)
- âœ… ä¿®æ”¹ `src/popup/popup.js` (æ•´åˆéŒ¯èª¤è™•ç†å™¨)
- âœ… æ–°å¢ `tests/unit/popup/popup-error-handler.test.js` (æ¸¬è©¦æª”æ¡ˆ)
- âœ… æ–°å¢ `docs/USER_ERROR_GUIDE.md` (ä½¿ç”¨è€…éŒ¯èª¤æŒ‡å—)

#### Git æäº¤æº–å‚™

```bash
git add .
git commit -m "feat: TDD å¾ªç’° #36 - Popup UI éŒ¯èª¤è™•ç†å¼·åŒ–

ğŸ“ æ ¸å¿ƒåŠŸèƒ½ï¼š
- ä½¿ç”¨è€…å‹å–„éŒ¯èª¤è¨Šæ¯é¡¯ç¤º
- Chrome Extension é‡æ–°è¼‰å…¥åŠŸèƒ½
- ç³»çµ±åˆå§‹åŒ–éŒ¯èª¤è™•ç†
- è¨ºæ–·æ¨¡å¼å’ŒéŒ¯èª¤å›å ±æ•´åˆ
- å®Œæ•´çš„ UI éŒ¯èª¤è™•ç†æµç¨‹

ğŸ“Š æ¸¬è©¦æˆæœï¼š
- Popup Interface æ•´åˆæ¸¬è©¦é€šé (36/36)
- éŒ¯èª¤è™•ç†ç³»çµ±å®Œæ•´æ•´åˆ
- ä½¿ç”¨è€…é«”é©—å¤§å¹…æ”¹å–„

ğŸ¯ æŠ€è¡“ç‰¹é»ï¼š
- æ™ºèƒ½éŒ¯èª¤é¡å‹è­˜åˆ¥
- å¤šç¨®é‡æ–°è¼‰å…¥æ–¹æ¡ˆ
- GitHub Issues æ•´åˆ
- è¨ºæ–·è³‡æ–™æ”¶é›†
- 21 ç¨®éŒ¯èª¤é¡å‹æ”¯æ´"
```

### ğŸ† éŒ¯èª¤è™•ç†èˆ‡ç›£æ§ç³»çµ±å®Œæ•´ç”Ÿæ…‹

ç¶“éäº”å€‹ TDD å¾ªç’°çš„é–‹ç™¼ï¼Œæˆ‘å€‘å·²ç¶“å»ºç«‹äº†ä¸€å€‹å®Œæ•´çš„éŒ¯èª¤è™•ç†èˆ‡ç›£æ§ç³»çµ±ï¼š

1. **TDD å¾ªç’° #32**: EventErrorHandler - çµ±ä¸€éŒ¯èª¤è™•ç†
2. **TDD å¾ªç’° #33**: MessageTracker - å³æ™‚è¨ºæ–·ç³»çµ±
3. **TDD å¾ªç’° #34**: EventPerformanceMonitor - æ•ˆèƒ½ç›£æ§
4. **TDD å¾ªç’° #35**: EventTracker - äº‹ä»¶è¨˜éŒ„è¿½è¹¤
5. **TDD å¾ªç’° #36**: Popup UI éŒ¯èª¤è™•ç†å¼·åŒ– - ä½¿ç”¨è€…ç•Œé¢å®Œå–„

é€™å€‹ç³»çµ±ç‚ºæ•´å€‹æ‡‰ç”¨æä¾›äº†å¾å¾Œç«¯äº‹ä»¶è™•ç†åˆ°å‰ç«¯ä½¿ç”¨è€…ç•Œé¢çš„å…¨é¢éŒ¯èª¤è™•ç†ã€è¨ºæ–·ã€ç›£æ§å’Œè¿½è¹¤èƒ½åŠ›ï¼Œæ˜¯ä¸€å€‹ä¼æ¥­ç´šçš„å®Œæ•´ç›£æ§è§£æ±ºæ–¹æ¡ˆã€‚
