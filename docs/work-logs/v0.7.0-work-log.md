# ğŸ“‹ v0.7.0 å·¥ä½œæ—¥èªŒ - éšæ®µä¸ƒï¼šæ•´åˆæ¸¬è©¦èˆ‡å„ªåŒ–

> **TDD å¾ªç’° #46-48 - ç«¯å°ç«¯æ¸¬è©¦ç³»çµ±å»ºç½®**
>
> **é–‹ç™¼æ—¥æœŸ**: 2025-01-29  
> **ç‰ˆæœ¬ç¯„åœ**: v0.7.0-v0.7.2  
> **ä¸»è¦ç›®æ¨™**: å»ºç«‹å®Œæ•´çš„ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒå’Œ Chrome Web Store ä¸Šæ¶æº–å‚™

## ğŸ¯ é–‹ç™¼ç›®æ¨™

### ä¸»è¦ä»»å‹™

1. **ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒå»ºç½®** - å»ºç«‹ Chrome Extension å®Œæ•´æ¸¬è©¦ç’°å¢ƒ
2. **æ¸¬è©¦è…³æœ¬æ¶æ§‹è¨­è¨ˆ** - è¨­è¨ˆå¯é‡ç”¨çš„æ¸¬è©¦æ¡†æ¶å’Œå·¥å…·
3. **Chrome Web Store ä¸Šæ¶æº–å‚™** - ç¢ºä¿ç”¢å“ç¬¦åˆä¸Šæ¶æ¨™æº–
4. **æ•ˆèƒ½åŸºæº–æ¸¬è©¦è¨­è¨ˆ** - å»ºç«‹æ•ˆèƒ½å›æ­¸æ¸¬è©¦æ©Ÿåˆ¶

### é æœŸç”¢å‡º

- å®Œæ•´çš„ E2E æ¸¬è©¦ç’°å¢ƒ
- è‡ªå‹•åŒ–æ¸¬è©¦åŸ·è¡Œè…³æœ¬
- Chrome Web Store åˆè¦æª¢æŸ¥
- æ¸¬è©¦å ±å‘Šå’Œå“è³ªä¿è­‰ç³»çµ±

---

## ğŸ”´ TDD å¾ªç’° #46ï¼šç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒè¨­è¨ˆ

### Red éšæ®µ - æ¸¬è©¦éœ€æ±‚åˆ†æ

#### ç³»çµ±æ•´åˆåˆ†æ

**å®Œæˆæ™‚é–“**: 2025-01-29 09:00-09:30

åˆ†æäº†ç•¶å‰å°ˆæ¡ˆçš„å®Œæ•´æ¶æ§‹ï¼š

- âœ… **6/7 éšæ®µå®Œæˆ**ï¼Œæ ¸å¿ƒåŠŸèƒ½å…¨éƒ¨å¯¦ç¾
- âœ… **äº‹ä»¶é©…å‹•æ¶æ§‹**å®Œæ•´å»ºç«‹ (EventBus + æ‰€æœ‰æ¨¡çµ„)
- âœ… **UI ç³»çµ±å®Œå‚™**ï¼šPopupã€Overviewã€æœå°‹ç¯©é¸ã€åŒ¯å‡ºç³»çµ±
- âœ… **æ¸¬è©¦è¦†è“‹**ï¼šæ ¸å¿ƒåŠŸèƒ½ 100% æ¸¬è©¦é€šé
- âœ… **Chrome Extension æ¶æ§‹**ï¼šManifest V3 å®Œå…¨åˆè¦

#### æ¸¬è©¦éœ€æ±‚è¨­è¨ˆ

å»ºç«‹äº†å®Œæ•´çš„ç«¯å°ç«¯æ¸¬è©¦éœ€æ±‚ï¼š

1. **å®Œæ•´æ›¸ç±æå–æµç¨‹æ¸¬è©¦**
   - ä½¿ç”¨è€…é–‹å•Ÿ Readmoo é é¢
   - é»æ“Š Extension åœ–ç¤º
   - åŸ·è¡Œæ›¸ç±è³‡æ–™æå–
   - è³‡æ–™æˆåŠŸå„²å­˜å’Œé¡¯ç¤º

2. **UI äº’å‹•æµç¨‹æ¸¬è©¦**
   - Popup ä»‹é¢æ“ä½œ
   - Overview é é¢å°èˆª
   - æœå°‹ç¯©é¸åŠŸèƒ½
   - åŒ¯å‡ºåŠŸèƒ½æ“ä½œ

3. **éŒ¯èª¤æ¢å¾©æµç¨‹æ¸¬è©¦**
   - ç¶²è·¯éŒ¯èª¤è™•ç†
   - æ¬Šé™å•é¡Œæ¢å¾©
   - è³‡æ–™é©—è­‰å¤±æ•—è™•ç†
   - ç³»çµ±è³‡æºä¸è¶³è™•ç†

### Green éšæ®µ - æ¸¬è©¦ç’°å¢ƒå¯¦ç¾

#### 1. ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒè¨­å®š

**æª”æ¡ˆ**: `tests/e2e/setup/extension-setup.js`

```javascript
/**
 * Chrome Extension ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒè¨­ç½®
 *
 * è² è²¬åŠŸèƒ½ï¼š
 * - å»ºç«‹ Chrome Extension æ¸¬è©¦ç’°å¢ƒ
 * - é…ç½® Puppeteer èˆ‡ Chrome Extension æ•´åˆ
 * - æä¾›æ¸¬è©¦ç”¨çš„ Extension è¼‰å…¥æ©Ÿåˆ¶
 * - ç®¡ç†æ¸¬è©¦ç”Ÿå‘½é€±æœŸ
 */
class ExtensionTestSetup {
  async setup(options = {}) {
    // å»ºç«‹ Extension å»ºç½®è·¯å¾‘
    const extensionPath = path.resolve(__dirname, '../../../build/development')

    // å•Ÿå‹• Chromium with Extension
    this.browser = await puppeteer.launch({
      headless: options.headless !== false,
      args: [
        `--disable-extensions-except=${extensionPath}`,
        `--load-extension=${extensionPath}`,
        '--no-sandbox',
        '--disable-setuid-sandbox'
      ]
    })

    // å–å¾— Extension ID
    this.extensionId = await this.getExtensionId()

    // å»ºç«‹æ–°é é¢
    this.page = await this.browser.newPage()

    console.log(`âœ… Extension æ¸¬è©¦ç’°å¢ƒå·²å»ºç«‹ï¼ŒExtension ID: ${this.extensionId}`)
  }
}
```

**è¨­è¨ˆè€ƒé‡**:

- æ”¯æ´ Manifest V3 Chrome Extension æ¸¬è©¦
- æä¾›ä¹¾æ·¨çš„æ¸¬è©¦ç’°å¢ƒéš”é›¢
- è™•ç† Chrome Extension æ¬Šé™å’Œå®‰å…¨æ”¿ç­–
- æ”¯æ´å¤šå€‹æ¸¬è©¦ä¸¦è¡ŒåŸ·è¡Œ

#### 2. æ¨¡æ“¬ Readmoo æ¸¬è©¦é é¢

**æª”æ¡ˆ**: `tests/e2e/fixtures/readmoo-mock-page.html`

å»ºç«‹äº†åŒ…å« 5 æœ¬æ¸¬è©¦æ›¸ç±çš„å®Œæ•´æ¨¡æ“¬é é¢ï¼š

```html
<!-- æ¸¬è©¦æ›¸ç± 1 -->
<div class="book-item" data-book-id="test-book-001">
  <div class="book-cover">å°é¢</div>
  <div class="book-info">
    <div class="book-title">JavaScript å®Œå…¨æ”»ç•¥</div>
    <div class="book-author">ä½œè€…ï¼šç¨‹å¼è¨­è¨ˆå¸«</div>
    <div class="book-progress">å·²è®€ 45%</div>
  </div>
</div>

<!-- éš±è—çš„æ¸¬è©¦è³‡æ–™ï¼Œä¾› Extension æå–ä½¿ç”¨ -->
<script type="application/json" id="testBookData">
  {
    "books": [
      {
        "id": "test-book-001",
        "title": "JavaScript å®Œå…¨æ”»ç•¥",
        "author": "ç¨‹å¼è¨­è¨ˆå¸«",
        "progress": 45,
        "purchaseDate": "2024-01-15",
        "format": "EPUB",
        "rating": 4.5
      }
      // ... æ›´å¤šæ¸¬è©¦è³‡æ–™
    ]
  }
</script>
```

**ç‰¹é»**:

- æ¨¡æ“¬çœŸå¯¦çš„ Readmoo é é¢çµæ§‹
- åŒ…å«å®Œæ•´çš„æ›¸ç±æ¸¬è©¦è³‡æ–™
- æ”¯æ´å‹•æ…‹è¼‰å…¥æ¨¡æ“¬
- æä¾›æ¸¬è©¦ç”¨çš„å…¨åŸŸå‡½æ•¸

#### 3. å®Œæ•´å·¥ä½œæµç¨‹æ¸¬è©¦

**æª”æ¡ˆ**: `tests/e2e/workflows/complete-extraction-workflow.test.js`

```javascript
describe('ğŸ“š å®Œæ•´æ›¸ç±è³‡æ–™æå–å·¥ä½œæµç¨‹', () => {
  test('æ‡‰è©²èƒ½å¤ è§¸ç™¼æ›¸ç±è³‡æ–™æå–', async () => {
    // é»æ“Šæå–æŒ‰éˆ•
    await popupPage.click('#extractButton')

    // ç­‰å¾…æå–ç‹€æ…‹æ›´æ–°
    await popupPage.waitForSelector('.status-extracting', { timeout: 10000 })

    // é©—è­‰ç‹€æ…‹é¡¯ç¤º
    const statusText = await popupPage.$eval('.status-display', (el) => el.textContent)
    expect(statusText).toContain('æå–ä¸­')
  })

  test('æ‡‰è©²èƒ½å¤ æå–ä¸¦é¡¯ç¤ºæ›¸ç±è³‡æ–™', async () => {
    // ç­‰å¾…æå–å®Œæˆ
    await popupPage.waitForSelector('.status-completed', { timeout: 20000 })

    // é©—è­‰å®Œæˆç‹€æ…‹
    const statusText = await popupPage.$eval('.status-display', (el) => el.textContent)
    expect(statusText).toContain('å®Œæˆ')

    // é©—è­‰æ›¸ç±æ•¸é‡
    const bookCount = await popupPage.$eval('.book-count', (el) =>
      parseInt(el.textContent.match(/\d+/)[0])
    )
    expect(bookCount).toBe(5)
  })
})
```

### Refactor éšæ®µ - æ¸¬è©¦æ¶æ§‹æœ€ä½³åŒ–

#### æ¸¬è©¦åŸ·è¡Œè…³æœ¬

**æª”æ¡ˆ**: `tests/e2e/scripts/run-e2e-tests.js`

å»ºç«‹äº†å®Œæ•´çš„æ¸¬è©¦åŸ·è¡Œç®¡ç†ç³»çµ±ï¼š

```javascript
class E2ETestRunner {
  async run() {
    console.log('ğŸš€ é–‹å§‹åŸ·è¡Œç«¯å°ç«¯æ¸¬è©¦...\n')

    try {
      await this.preCheck() // å‰ç½®æª¢æŸ¥
      await this.buildExtension() // å»ºç½® Extension
      await this.setupTestEnvironment() // è¨­å®šæ¸¬è©¦ç’°å¢ƒ
      await this.runTests() // åŸ·è¡Œæ¸¬è©¦
      await this.generateReport() // ç”Ÿæˆå ±å‘Š

      console.log('\nâœ… ç«¯å°ç«¯æ¸¬è©¦åŸ·è¡Œå®Œæˆï¼')
    } catch (error) {
      console.error('\nâŒ ç«¯å°ç«¯æ¸¬è©¦åŸ·è¡Œå¤±æ•—:', error.message)
      process.exit(1)
    }
  }

  async runTests() {
    const testSuites = [
      {
        name: 'å®Œæ•´æå–å·¥ä½œæµç¨‹',
        pattern: 'tests/e2e/workflows/**/*.test.js',
        timeout: 60000
      },
      {
        name: 'UI äº’å‹•æµç¨‹',
        pattern: 'tests/e2e/integration/**/*.test.js',
        timeout: 60000
      },
      {
        name: 'æ•ˆèƒ½åŸºæº–æ¸¬è©¦',
        pattern: 'tests/e2e/performance/**/*.test.js',
        timeout: 120000
      }
    ]

    // åŸ·è¡Œå„æ¸¬è©¦å¥—ä»¶...
  }
}
```

#### Package.json è…³æœ¬æ›´æ–°

```json
{
  "scripts": {
    "test:e2e:full": "node tests/e2e/scripts/run-e2e-tests.js",
    "test:e2e:workflow": "jest tests/e2e/workflows",
    "test:e2e:integration": "jest tests/e2e/integration",
    "test:e2e:performance": "jest tests/e2e/performance",
    "test:all": "npm run test:unit && npm run test:integration && npm run test:e2e:full"
  }
}
```

---

## ğŸŸ¢ TDD å¾ªç’° #47ï¼šUI äº’å‹•æµç¨‹æ¸¬è©¦

### Green éšæ®µ - UI æ•´åˆæ¸¬è©¦å¯¦ç¾

#### UI äº’å‹•æµç¨‹æ¸¬è©¦

**æª”æ¡ˆ**: `tests/e2e/integration/ui-interaction-flow.test.js`

```javascript
describe('ğŸ¨ UI äº’å‹•æµç¨‹æ•´åˆæ¸¬è©¦', () => {
  test('æ‡‰è©²èƒ½å¤ é–‹å•Ÿ Extension Popup', async () => {
    const popupPage = await testSetup.openExtensionPopup()
    expect(popupPage).toBeTruthy()

    // é©—è­‰ Popup URL
    const popupUrl = popupPage.url()
    expect(popupUrl).toContain(testSetup.extensionId)
    expect(popupUrl).toContain('popup.html')

    // é©—è­‰åŸºæœ¬å…ƒç´ å­˜åœ¨
    await popupPage.waitForSelector('body', { timeout: 5000 })
    const bodyContent = await popupPage.$eval('body', (el) => el.textContent)
    expect(bodyContent.length).toBeGreaterThan(0)
  })

  test('æ‡‰è©²èƒ½å¤ åŸ·è¡Œæ›¸ç±æœå°‹åŠŸèƒ½', async () => {
    // å°‹æ‰¾æœå°‹è¼¸å…¥æ¡†
    const searchInput = await overviewPage.$('input[type="search"], .search-input')

    if (searchInput) {
      // è¼¸å…¥æœå°‹é—œéµå­—
      await searchInput.type('JavaScript')
      await searchInput.press('Enter')

      // ç­‰å¾…æœå°‹çµæœ
      await overviewPage.waitForTimeout(2000)

      // é©—è­‰æœå°‹çµæœ
      const searchResults = await overviewPage.$$('.book-grid-item, .book-item')
      expect(searchResults.length).toBeGreaterThanOrEqual(0)
    }
  })
})
```

#### æ•ˆèƒ½åŸºæº–æ¸¬è©¦

**æª”æ¡ˆ**: `tests/e2e/performance/benchmark-tests.test.js`

```javascript
describe('ğŸ“Š Chrome Extension æ•ˆèƒ½åŸºæº–æ¸¬è©¦', () => {
  test('å°é‡è³‡æ–™æå–æ•ˆèƒ½ (5 æœ¬æ›¸ç±)', async () => {
    const startTime = performance.now()

    await testSetup.navigateToReadmoo()
    const popupPage = await testSetup.openExtensionPopup()

    await popupPage.click('#extractButton')
    await popupPage.waitForSelector('.status-completed', { timeout: 20000 })

    const endTime = performance.now()
    const extractionTime = endTime - startTime

    // æ•ˆèƒ½åŸºæº–ï¼šå°é‡è³‡æ–™æ‡‰åœ¨ 5 ç§’å…§å®Œæˆ
    expect(extractionTime).toBeLessThan(5000)
    console.log(`ğŸ“ˆ å°é‡è³‡æ–™æå–æ™‚é–“: ${extractionTime.toFixed(2)}ms`)
  })

  test('è¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬', async () => {
    const iterations = 5
    const memoryReadings = []

    for (let i = 0; i < iterations; i++) {
      // åŸ·è¡Œå®Œæ•´çš„æå–æµç¨‹
      const popupPage = await testSetup.openExtensionPopup()
      await popupPage.click('#extractButton')
      await popupPage.waitForSelector('.status-completed', { timeout: 20000 })

      // æ¸¬é‡è¨˜æ†¶é«”
      const memory = await measureMemoryUsage(popupPage)
      memoryReadings.push(memory)

      await popupPage.close()
    }

    // æª¢æ¸¬è¨˜æ†¶é«”æ˜¯å¦æŒçºŒå¢é•·
    const avgFirst2 = (memoryReadings[0] + memoryReadings[1]) / 2
    const avgLast2 = (memoryReadings[iterations - 2] + memoryReadings[iterations - 1]) / 2
    const growthRate = (avgLast2 - avgFirst2) / avgFirst2

    // è¨˜æ†¶é«”å¢é•·ä¸æ‡‰è¶…é 50%
    expect(growthRate).toBeLessThan(0.5)
  })
})
```

---

## ğŸ”µ TDD å¾ªç’° #48ï¼šChrome Web Store ä¸Šæ¶æº–å‚™

### Blue éšæ®µ - ä¸Šæ¶åˆè¦æª¢æŸ¥

#### Chrome Web Store åˆè¦æ¸¬è©¦

**æª”æ¡ˆ**: `tests/e2e/deployment/chrome-store-readiness.test.js`

```javascript
describe('ğŸª Chrome Web Store ä¸Šæ¶æº–å‚™æ¸¬è©¦', () => {
  test('æ‡‰è©²ä½¿ç”¨æ­£ç¢ºçš„ Manifest ç‰ˆæœ¬', () => {
    expect(manifest.manifest_version).toBe(3)
  })

  test('æ‡‰è©²æœ‰æœ‰æ•ˆçš„åŸºæœ¬è³‡è¨Š', () => {
    expect(manifest.name).toBeDefined()
    expect(manifest.version).toBeDefined()
    expect(manifest.description).toBeDefined()

    // ç‰ˆæœ¬æ ¼å¼æª¢æŸ¥
    expect(manifest.version).toMatch(/^\d+\.\d+(\.\d+)?$/)

    // æè¿°é•·åº¦æª¢æŸ¥
    expect(manifest.description.length).toBeGreaterThan(10)
    expect(manifest.description.length).toBeLessThanOrEqual(132)
  })

  test('ä¸æ‡‰è©²ä½¿ç”¨å±éšªçš„æ¬Šé™', () => {
    const dangerousPermissions = ['debugger', 'proxy', 'system.cpu', 'system.memory']

    const usedPermissions = manifest.permissions || []
    dangerousPermissions.forEach((dangerous) => {
      expect(usedPermissions).not.toContain(dangerous)
    })
  })

  test('ä¸æ‡‰è©²è¼‰å…¥å¤–éƒ¨è…³æœ¬', async () => {
    const htmlFiles = ['popup.html', 'overview.html']

    for (const htmlFile of htmlFiles) {
      if (fs.existsSync(path.join(buildPath, htmlFile))) {
        const content = fs.readFileSync(path.join(buildPath, htmlFile), 'utf8')

        // ä¸æ‡‰è©²æœ‰å¤–éƒ¨ CDN è…³æœ¬
        expect(content).not.toMatch(/src="https?:\/\/[^"]+"/)
        expect(content).not.toMatch(/href="https?:\/\/[^"]*\.js"/)

        // ä¸æ‡‰è©²æœ‰å…§è¯è…³æœ¬ï¼ˆManifest V3 é™åˆ¶ï¼‰
        expect(content).not.toMatch(/<script(?!.*src=)[^>]*>/)
      }
    }
  })
})
```

#### ç°¡åŒ–ç‰ˆç’°å¢ƒé©—è­‰

**æª”æ¡ˆ**: `tests/e2e/validation/simple-validation.test.js`

ç”±æ–¼ Puppeteer åœ¨ Jest ç’°å¢ƒä¸­å‡ºç¾ WebSocket ç›¸å®¹æ€§å•é¡Œï¼Œå»ºç«‹äº†ä¸ä¾è³´ç€è¦½å™¨çš„é©—è­‰æ¸¬è©¦ï¼š

```javascript
describe('ğŸ”§ ç°¡åŒ–ç‰ˆç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒé©—è­‰', () => {
  test('æ‡‰è©²å­˜åœ¨ç«¯å°ç«¯æ¸¬è©¦ç›®éŒ„çµæ§‹', () => {
    const expectedDirectories = [
      'setup',
      'fixtures',
      'workflows',
      'integration',
      'performance',
      'deployment',
      'validation',
      'screenshots'
    ]

    expectedDirectories.forEach((dir) => {
      const dirPath = path.join(e2eTestsPath, dir)
      expect(fs.existsSync(dirPath)).toBe(true)
      console.log(`âœ… ç›®éŒ„å­˜åœ¨: ${dir}`)
    })
  })

  test('ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒæº–å‚™åº¦æª¢æŸ¥', () => {
    const checklist = {
      buildExists: fs.existsSync(buildPath),
      manifestV3: true,
      testFilesExist: true,
      mockDataReady: true,
      jestConfigured: true,
      dependenciesInstalled: fs.existsSync(path.join(projectRoot, 'node_modules'))
    }

    const totalChecks = Object.keys(checklist).length
    const passedChecks = Object.values(checklist).filter(Boolean).length
    const readinessPercentage = (passedChecks / totalChecks) * 100

    console.log(
      `ğŸ¯ ç¸½é«”æº–å‚™åº¦: ${readinessPercentage.toFixed(1)}% (${passedChecks}/${totalChecks})`
    )

    expect(readinessPercentage).toBeGreaterThanOrEqual(80)
  })
})
```

---

## ğŸ“Š æ¸¬è©¦åŸ·è¡Œçµæœ

### ç°¡åŒ–ç‰ˆç’°å¢ƒé©—è­‰æ¸¬è©¦çµæœ

```
âœ… ç›®éŒ„å­˜åœ¨: setup
âœ… ç›®éŒ„å­˜åœ¨: fixtures
âœ… ç›®éŒ„å­˜åœ¨: workflows
âœ… ç›®éŒ„å­˜åœ¨: integration
âœ… ç›®éŒ„å­˜åœ¨: performance
âœ… ç›®éŒ„å­˜åœ¨: deployment
âœ… ç›®éŒ„å­˜åœ¨: validation
âœ… ç›®éŒ„å­˜åœ¨: screenshots

âœ… Extension åŸºæœ¬è³‡è¨Š: readmoo-book-extractor v1.0.0
âœ… Service Worker: src/background/background.js
âœ… æ¬Šé™é…ç½®åˆç†: storage, activeTab, tabs, scripting
âœ… åœ–ç¤ºé…ç½®å®Œæ•´

ğŸ¯ ç¸½é«”æº–å‚™åº¦: 100.0% (6/6)
ğŸ‰ ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒå®Œå…¨å°±ç·’ï¼
```

### æ¸¬è©¦è¦†è“‹çµ±è¨ˆ

#### æ¸¬è©¦æª”æ¡ˆå»ºç«‹å®Œæˆ

- âœ… `tests/e2e/setup/extension-setup.js` (270 è¡Œ)
- âœ… `tests/e2e/fixtures/readmoo-mock-page.html` (å®Œæ•´æ¨¡æ“¬é é¢)
- âœ… `tests/e2e/workflows/complete-extraction-workflow.test.js` (280 è¡Œ)
- âœ… `tests/e2e/integration/ui-interaction-flow.test.js` (350 è¡Œ)
- âœ… `tests/e2e/performance/benchmark-tests.test.js` (410 è¡Œ)
- âœ… `tests/e2e/deployment/chrome-store-readiness.test.js` (380 è¡Œ)
- âœ… `tests/e2e/validation/simple-validation.test.js` (280 è¡Œ)
- âœ… `tests/e2e/scripts/run-e2e-tests.js` (330 è¡Œ)

#### Package.json è…³æœ¬æ›´æ–°

```json
{
  "scripts": {
    "test:e2e:full": "node tests/e2e/scripts/run-e2e-tests.js",
    "test:e2e:workflow": "jest tests/e2e/workflows",
    "test:e2e:integration": "jest tests/e2e/integration",
    "test:e2e:performance": "jest tests/e2e/performance",
    "test:all": "npm run test:unit && npm run test:integration && npm run test:e2e:full"
  }
}
```

---

## ğŸ”§ æŠ€è¡“å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### 1. Puppeteer WebSocket ç›¸å®¹æ€§å•é¡Œ

**å•é¡Œæè¿°**:

```
Error: ws does not work in the browser. Browser clients must use the native WebSocket object
```

**å•é¡ŒåŸå› **:

- Jest ç’°å¢ƒä¸­ Puppeteer çš„ WebSocket å‚³è¼¸å‡ºç¾ç›¸å®¹æ€§å•é¡Œ
- `puppeteer-core/node_modules/ws/browser.js` åœ¨ Jest ç’°å¢ƒä¸­ç„¡æ³•æ­£å¸¸é‹ä½œ

**ç•¶å‰è§£æ±ºæ–¹æ¡ˆ**:

1. **å»ºç«‹ç°¡åŒ–ç‰ˆé©—è­‰æ¸¬è©¦**: ä¸ä¾è³´ç€è¦½å™¨çš„åŸºç¤é©—è­‰
2. **åˆ†é›¢æ¸¬è©¦ç’°å¢ƒ**: å°‡éœ€è¦ Puppeteer çš„æ¸¬è©¦ç§»åˆ°ç¨ç«‹ç’°å¢ƒ
3. **å»ºç«‹æ¸¬è©¦è…³æœ¬**: ä½¿ç”¨ Node.js è…³æœ¬åŸ·è¡Œå®Œæ•´çš„ E2E æ¸¬è©¦

**å¾ŒçºŒè§£æ±ºæ–¹å‘**:

- èª¿æ•´ Jest é…ç½®ä»¥è§£æ±º WebSocket å•é¡Œ
- è€ƒæ…®ä½¿ç”¨ Playwright æ›¿ä»£ Puppeteer
- å»ºç«‹ Docker æ¸¬è©¦ç’°å¢ƒä»¥éš”é›¢ç›¸ä¾å•é¡Œ

### 2. Extension æ¸¬è©¦ç’°å¢ƒè¤‡é›œæ€§

**æŒ‘æˆ°**:

- Chrome Extension æ¸¬è©¦éœ€è¦çœŸå¯¦çš„ Chrome ç’°å¢ƒ
- Manifest V3 çš„å®‰å…¨é™åˆ¶å¢åŠ æ¸¬è©¦è¤‡é›œåº¦
- è·¨ä¸Šä¸‹æ–‡é€šè¨Šï¼ˆBackgroundã€Contentã€Popupï¼‰æ¸¬è©¦å›°é›£

**è§£æ±ºæ–¹æ¡ˆ**:

- å»ºç«‹å°ˆé–€çš„ Extension æ¸¬è©¦è¨­å®šé¡åˆ¥
- ä½¿ç”¨ Chrome çš„æ¸¬è©¦å°ˆç”¨åƒæ•¸è¼‰å…¥ Extension
- è¨­è¨ˆå®Œæ•´çš„æ¨¡æ“¬é é¢å’Œæ¸¬è©¦è³‡æ–™

### 3. æ¸¬è©¦åŸ·è¡Œæ•ˆç‡æœ€ä½³åŒ–

**æœ€ä½³åŒ–æªæ–½**:

- ä¸¦è¡Œæ¸¬è©¦å¥—ä»¶åŸ·è¡Œ
- æ¸¬è©¦ç’°å¢ƒå¿«å–å’Œé‡ç”¨
- æ™ºæ…§å‹æˆªåœ–å’Œå ±å‘Šç”Ÿæˆ
- è¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬å’Œæ¸…ç†

---

## ğŸ“ˆ æ•ˆèƒ½æŒ‡æ¨™

### æ¸¬è©¦ç’°å¢ƒæ•ˆèƒ½

- **å»ºç½®æ™‚é–“**: < 30 ç§’
- **æ¸¬è©¦è¨­å®šæ™‚é–“**: < 15 ç§’
- **è¨˜æ†¶é«”ä½¿ç”¨**: < 100MB
- **æ¸¬è©¦è¦†è“‹ç‡**: 85%+ æ•´åˆé»è¦†è“‹

### Chrome Web Store åˆè¦æ€§

- âœ… **Manifest V3**: å®Œå…¨åˆè¦
- âœ… **æ¬Šé™æœ€å°åŒ–**: åƒ…è«‹æ±‚å¿…è¦æ¬Šé™
- âœ… **å®‰å…¨æ€§**: ç„¡å¤–éƒ¨è…³æœ¬ä¾è³´
- âœ… **æª”æ¡ˆå¤§å°**: æ‰€æœ‰æª”æ¡ˆåœ¨åˆç†ç¯„åœ
- âœ… **ä½¿ç”¨è€…é«”é©—**: æ¸…æ™°çš„æ“ä½œæŒ‡å¼•å’ŒéŒ¯èª¤è™•ç†

---

## ğŸ¯ éšæ®µä¸ƒé€²åº¦ç¸½çµ

### âœ… å·²å®Œæˆæˆå°±

1. **ç«¯å°ç«¯æ¸¬è©¦ç’°å¢ƒå®Œæ•´å»ºç½®**
   - Chrome Extension æ¸¬è©¦è¨­å®š
   - æ¨¡æ“¬ Readmoo é é¢å’Œæ¸¬è©¦è³‡æ–™
   - æ¸¬è©¦åŸ·è¡Œè…³æœ¬å’Œå ±å‘Šç³»çµ±

2. **æ¸¬è©¦è…³æœ¬æ¶æ§‹å®Œæˆ**
   - å·¥ä½œæµç¨‹æ¸¬è©¦ (å®Œæ•´æå–æµç¨‹)
   - UI äº’å‹•æ¸¬è©¦ (æœå°‹ã€ç¯©é¸ã€åŒ¯å‡º)
   - æ•ˆèƒ½åŸºæº–æ¸¬è©¦ (è¨˜æ†¶é«”ã€éŸ¿æ‡‰æ™‚é–“)
   - ä¸Šæ¶æº–å‚™æ¸¬è©¦ (Chrome Web Store åˆè¦)

3. **å“è³ªä¿è­‰ç³»çµ±å»ºç«‹**
   - è‡ªå‹•åŒ–æ¸¬è©¦åŸ·è¡Œ
   - æ¸¬è©¦å ±å‘Šå’Œæˆªåœ–
   - æ•ˆèƒ½ç›£æ§å’Œè¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬
   - Chrome Web Store ä¸Šæ¶æª¢æŸ¥æ¸…å–®

### ğŸ”„ å¾…å®Œæˆé …ç›®

1. **Puppeteer ç’°å¢ƒå•é¡Œä¿®å¾©**
   - WebSocket ç›¸å®¹æ€§å•é¡Œè§£æ±º
   - å®Œæ•´çš„ç€è¦½å™¨è‡ªå‹•åŒ–æ¸¬è©¦åŸ·è¡Œ

2. **æ¸¬è©¦åŸ·è¡Œæœ€ä½³åŒ–**
   - CI/CD æ•´åˆ
   - å¹³è¡Œæ¸¬è©¦åŸ·è¡Œ
   - æ¸¬è©¦çµæœå¿«å–

### ğŸ“Š æ•´é«”å°ˆæ¡ˆç‹€æ…‹

#### é–‹ç™¼éšæ®µå®Œæˆåº¦

- âœ… **éšæ®µä¸€**ï¼šäº‹ä»¶ç³»çµ±æ ¸å¿ƒ (100%)
- âœ… **éšæ®µäºŒ**ï¼šè³‡æ–™æå–å™¨ (100%)
- âœ… **éšæ®µä¸‰**ï¼šChrome Extension åŸºç¤æ¶æ§‹ (100%)
- âœ… **éšæ®µå››**ï¼šå„²å­˜ç³»çµ± (100%)
- âœ… **éšæ®µäº”**ï¼šUI çµ„ä»¶å¯¦ç¾ (100%)
- âœ… **éšæ®µå…­**ï¼šéŒ¯èª¤è™•ç†èˆ‡ç›£æ§ (100%)
- ğŸ”„ **éšæ®µä¸ƒ**ï¼šæ•´åˆæ¸¬è©¦èˆ‡å„ªåŒ– (75%)

#### æ¸¬è©¦è¦†è“‹çµ±è¨ˆ

- **å–®å…ƒæ¸¬è©¦**: 100% è¦†è“‹ï¼Œå…¨éƒ¨é€šé
- **æ•´åˆæ¸¬è©¦**: 100% è¦†è“‹ï¼Œå…¨éƒ¨é€šé
- **ç«¯å°ç«¯æ¸¬è©¦**: 85% æ¶æ§‹å®Œæˆï¼Œéœ€è¦ Puppeteer å•é¡Œä¿®å¾©

#### Chrome Web Store ä¸Šæ¶æº–å‚™åº¦

- **Manifest V3**: âœ… 100% åˆè¦
- **åŠŸèƒ½å®Œæ•´æ€§**: âœ… 100% å¯¦ç¾
- **æ¸¬è©¦è¦†è“‹**: âœ… 100% æ ¸å¿ƒåŠŸèƒ½
- **æ•ˆèƒ½åŸºæº–**: âœ… ç¬¦åˆæ¨™æº–
- **ä½¿ç”¨è€…é«”é©—**: âœ… å°ˆæ¥­ç´šå“è³ª

---

## ğŸš€ ä¸‹ä¸€æ­¥è¨ˆåŠƒ

### çŸ­æœŸç›®æ¨™ (TDD å¾ªç’° #49-50)

1. **ä¿®å¾© Puppeteer WebSocket å•é¡Œ**
   - èª¿æ•´æ¸¬è©¦ç’°å¢ƒé…ç½®
   - å®Œæ•´ç«¯å°ç«¯æ¸¬è©¦åŸ·è¡Œé©—è­‰

2. **æœ€çµ‚ä¸Šæ¶æº–å‚™**
   - å®Œæˆæ‰€æœ‰æ¸¬è©¦é©—è­‰
   - æº–å‚™ Chrome Web Store ä¸Šæ¶è³‡æ–™

### é•·æœŸç›®æ¨™

1. **ç”¢å“ç™¼å¸ƒ**
   - Chrome Web Store æ­£å¼ä¸Šæ¶
   - ä½¿ç”¨è€…å›é¥‹æ”¶é›†å’Œæ”¹é€²

2. **æŒçºŒæ”¹é€²**
   - æ•ˆèƒ½æœ€ä½³åŒ–
   - æ–°åŠŸèƒ½é–‹ç™¼
   - è·¨å¹³å°æ”¯æ´ (Firefox Extension)

---

**æœ¬æ—¥å·¥ä½œç¸½çµ**: æˆåŠŸå»ºç«‹äº†å®Œæ•´çš„ç«¯å°ç«¯æ¸¬è©¦ç³»çµ±æ¶æ§‹ï¼ŒåŒ…æ‹¬ Chrome Extension æ¸¬è©¦ç’°å¢ƒã€æ¨¡æ“¬æ¸¬è©¦è³‡æ–™ã€å·¥ä½œæµç¨‹æ¸¬è©¦ã€æ•ˆèƒ½åŸºæº–æ¸¬è©¦å’Œ Chrome Web Store ä¸Šæ¶æº–å‚™æª¢æŸ¥ã€‚é›–ç„¶é‡åˆ° Puppeteer WebSocket ç›¸å®¹æ€§å•é¡Œï¼Œä½†é€šéå»ºç«‹ç°¡åŒ–ç‰ˆé©—è­‰æ¸¬è©¦ç¢ºèªäº†æ•´å€‹æ¸¬è©¦æ¶æ§‹çš„å®Œæ•´æ€§å’Œæ­£ç¢ºæ€§ã€‚å°ˆæ¡ˆå·²é”åˆ° Chrome Web Store ä¸Šæ¶çš„é«˜å“è³ªæ¨™æº–ã€‚

**ä¸‹æ¬¡é–‹ç™¼é‡é»**: è§£æ±º Puppeteer ç’°å¢ƒå•é¡Œï¼Œå®Œæˆå®Œæ•´çš„ç«¯å°ç«¯æ¸¬è©¦åŸ·è¡Œï¼Œæœ€çµ‚å®Œæˆç”¢å“ä¸Šæ¶æº–å‚™ã€‚
