# Agent 輸出標準格式規範

根據 Claude Code sub-agent 最佳實踐，本文件定義所有 sub-agent 的標準輸出格式，確保主線程能夠有效地理解和使用 agent 的研究規劃成果。

## 🎯 核心原則

### Agent 職責邊界

- **Sub-agent**: 純研究和規劃，絕不執行實作
- **主線程**: 負責閱讀規劃並執行所有實際實作
- **標準溝通**: 透過統一格式確保高效溝通

### 輸出要求

1. **簡潔明確**: 主要訊息控制在 3-5 句話內
2. **指向性強**: 明確指出規劃檔案位置
3. **行動導向**: 明確告知主線程下一步行動
4. **完整性**: 包含所有必要的上下文更新資訊

## 📋 標準輸出格式

### 基本格式模板

```
我已經完成 [任務名稱] 的 [工作類型] 工作。

📋 **規劃檔案**: `docs/context/agent_plans/[類別]/[檔案名稱].md`
🔄 **上下文更新**: 已更新 `docs/context/session_contexts/context_session_X.md`
🔍 **主要發現**: [重要發現的簡要總結]
🎯 **建議行動**: [對主線程的具體建議]
⚠️  **注意事項**: [如有特殊注意事項]

請在繼續實作前先閱讀規劃檔案。
```

### 各類型 Agent 專用格式

#### 🏗 架構設計類 Agent (basil-event-architect)

```
我已經完成 [系統/模組名稱] 的架構設計規劃工作。

📋 **架構規劃**: `docs/context/agent_plans/architecture/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
🏗 **架構方案**: [架構方案簡要描述]
🔗 **整合點**: [關鍵整合點和依賴]
⚡ **技術選擇**: [核心技術選擇理由]

請先審閱架構設計後再開始實作。
```

#### 🧪 測試策略類 Agent (sage-test-architect, coriander-integration-tester)

```
我已經完成 [功能/模組] 的測試策略規劃工作。

📋 **測試規劃**: `docs/context/agent_plans/testing/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
🧪 **測試策略**: [測試策略簡要描述]
📊 **覆蓋目標**: [測試覆蓋率和品質目標]
🔍 **重點測試**: [關鍵測試場景]

請依據測試規劃進行 TDD 實作。
```

#### 🎨 設計規劃類 Agent (lavender-interface-designer)

```
我已經完成 [介面/功能] 的 UI/UX 設計規劃工作。

📋 **設計規劃**: `docs/context/agent_plans/ui_design/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
🎨 **設計概念**: [設計概念簡要描述]
📱 **使用者體驗**: [關鍵 UX 考量]
🔧 **技術實現**: [技術實現要點]

請完整實現設計規範中的所有要求。
```

#### 📊 資料處理類 Agent (oregano-data-miner)

```
我已經完成 [資料源/處理流程] 的資料提取策略規劃工作。

📋 **提取規劃**: `docs/context/agent_plans/data_extraction/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
📊 **資料策略**: [資料提取策略描述]
🔍 **關鍵欄位**: [重要資料欄位]
⚡ **效能考量**: [效能和穩定性考量]

請按照提取策略實作資料處理邏輯。
```

#### ⚡ 效能優化類 Agent (ginger-performance-tuner)

```
我已經完成 [系統/功能] 的效能分析和優化規劃工作。

📋 **優化規劃**: `docs/context/agent_plans/performance/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
⚡ **效能瓶頸**: [主要效能問題]
📈 **優化目標**: [具體效能提升目標]
🔧 **實作策略**: [優化實作策略]

請按照優化計劃執行效能改善工作。
```

#### 📋 專案管理類 Agent (rosemary-project-manager)

```
我已經完成 [專案/任務] 的項目規劃和任務分析工作。

📋 **專案規劃**: `docs/context/agent_plans/project/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
📊 **任務分解**: [主要任務分解結果]
⏰ **時程規劃**: [關鍵時程安排]
🎯 **里程碑**: [重要里程碑定義]

請根據專案規劃執行具體開發工作。
```

#### ✅ 合規檢查類 Agent (project-compliance-agent)

```
我已經完成 [功能/模組] 的合規性檢查和驗證工作。

📋 **合規報告**: `docs/context/agent_plans/compliance/[檔案名稱].md`
🔄 **上下文更新**: 已更新專案上下文檔案
✅ **合規狀態**: [合規檢查結果]
⚠️  **問題清單**: [發現的合規問題]
🔧 **修正建議**: [具體修正建議]

請處理所有合規問題後再進行下一步。
```

## 🚫 禁止輸出格式

### 禁止的行為描述

❌ **錯誤**: "我已經實作了..."  
✅ **正確**: "我已經規劃了..."

❌ **錯誤**: "程式碼已經修改完成"  
✅ **正確**: "修改計劃已經制定完成"

❌ **錯誤**: "測試已經通過"  
✅ **正確**: "測試策略已經設計完成"

❌ **錯誤**: "功能可以正常運作"  
✅ **正確**: "實作計劃可以確保功能正常運作"

### 禁止的直接指令

❌ **錯誤**: "請執行以下程式碼..."  
✅ **正確**: "請參考規劃檔案中的實作步驟..."

❌ **錯誤**: "運行測試指令..."  
✅ **正確**: "按照測試規劃執行測試..."

## 📏 品質檢查清單

每個 Agent 輸出前必須檢查：

### 內容檢查

- [ ] 是否明確表達是「規劃」而非「實作」
- [ ] 是否提供了具體的檔案路徑
- [ ] 是否包含主要發現的簡要總結
- [ ] 是否給出明確的後續行動建議
- [ ] 是否更新了相關的上下文檔案

### 格式檢查

- [ ] 使用了正確的 emoji 標識
- [ ] 檔案路徑格式正確且存在
- [ ] 訊息長度適中（不超過 200 字）
- [ ] 語言使用繁體中文
- [ ] 結尾包含指導性語句

### 職責邊界檢查

- [ ] 沒有描述任何實際實作工作
- [ ] 沒有聲稱修改了程式碼
- [ ] 沒有直接給出程式碼片段
- [ ] 沒有執行任何實際操作

## 🔄 上下文更新要求

每個 Agent 完成工作後必須：

1. **更新專案上下文檔案**
   - 在「Agent 工作記錄」中新增完成項目
   - 在「待執行計劃」中新增對應計劃
   - 更新「最後更新」時間戳記

2. **建立規劃檔案**
   - 使用標準模板格式
   - 包含完整的分析和計劃
   - 檔案命名遵循規範

3. **確保輸出一致性**
   - 輸出訊息與檔案內容一致
   - 建議行動與規劃內容對應
   - 上下文更新準確反映工作狀態
