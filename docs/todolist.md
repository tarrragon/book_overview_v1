# 📋 TDD 開發任務清單

## 🎯 開發原則

- 嚴格遵循 **Red-Green-Refactor** 循環
- 每個功能必須先寫測試（紅燈）
- 實現最小可用代碼讓測試通過（綠燈）  
- 重構優化代碼（重構）
- 所有測試必須保持通過狀態

## 📊 進度追蹤圖例

- ⭕ 待開始
- 🔴 紅燈 - 測試失敗
- 🟢 綠燈 - 測試通過
- 🔵 重構 - 代碼優化
- ✅ 完成

## 🏗 開發階段概覽

### 架構優先順序（事件驅動設計）
1. **🎭 階段一：事件系統核心** - 系統通信基礎
2. **📚 階段二：資料提取器** - 基於事件系統的資料提取
3. **🏗 階段三：Chrome Extension 基礎架構** - 整合事件系統
4. **💾 階段四：儲存系統** - 事件驅動的資料儲存
5. **🎨 階段五：UI 組件** - 使用者界面實現

---

## 🔴 優先級：修復失敗的測試（TDD 紅燈狀態）

### 0.1 修復當前失敗的測試

**依照TDD原則，必須先讓現有測試通過，才能繼續新功能開發**

- [x] ✅ **測試失敗**: Chrome Storage 配額錯誤處理
- [x] ✅ **實現**: 在 Chrome Storage 適配器中加入配額檢查
- [x] ✅ **驗證**: 確認測試通過
- [x] ✅ **重構**: 優化錯誤處理邏輯

- [x] ✅ **測試失敗**: localStorage 模擬機制修正
- [x] ✅ **實現**: 修正測試環境中的 localStorage 模擬
- [x] ✅ **驗證**: 確認測試通過
- [x] ✅ **重構**: 優化模擬機制

- [x] ✅ **測試失敗**: 資料格式驗證功能
- [x] ✅ **實現**: 建立書籍資料格式驗證函數
- [x] ✅ **驗證**: 確認測試通過
- [x] ✅ **重構**: 優化驗證邏輯

- [x] ✅ **已完成**: 無效書籍ID處理邏輯（多書城支援）
- [x] ✅ **實現**: 加入無效ID的檢查與處理
- [x] ✅ **驗證**: 確認測試通過
- [x] ✅ **重構**: 優化ID處理邏輯

#### TDD 循環追蹤 - 失敗測試修復

- [x] ✅ **已完成**: 實現儲存配額錯誤處理
- [x] ✅ 確認測試從紅燈變綠燈
- [x] ✅ 重構與優化程式碼
- [x] ✅ **已完成**: localStorage 模擬修正
- [x] ✅ 確認測試通過
- [x] ✅ 重構相關程式碼
- [x] ✅ **已完成**: 資料格式驗證功能
- [x] ✅ 確認測試通過
- [x] ✅ 重構相關程式碼
- [x] ✅ **已完成**: 多書城書籍ID處理邏輯
- [x] ✅ 確認測試通過
- [x] ✅ 重構相關程式碼

### 🎉 階段 0.1 完成：TDD測試框架 (50/50 測試通過)

---

## 🌐 多書城支援目標

### 支援書城

- [x] ✅ Readmoo - 架構已設計
- [ ] ⭕ 博客來、金石堂、Kobo 等 - 待開發

### 架構任務

- [x] ✅ 可配置書城支援系統
- [ ] ⭕ 書城適配器介面 (v0.2.0 規劃中)
- [ ] ⭕ 統一資料格式轉換器 (v0.2.0 規劃中)

---

## 🎯 v0.2.0 開發階段概覽 (基於事件系統的完整架構)

### 📈 開發進度總覽

```
✅ v0.1.0 事件系統核心 (已完成) - 107/107 測試通過
📚 v0.2.0 資料提取器實現 (規劃中) - 預計9個TDD循環
🏗 v0.3.0 Chrome Extension整合 (規劃中) - 預計5個TDD循環  
💾 v0.4.0 儲存系統實現 (規劃中) - 預計7個TDD循環
🎨 v0.5.0 UI組件實現 (規劃中) - 預計9個TDD循環

總預計: 30個TDD循環 | 當前完成: 3/30 (10%)
```

### 🏆 技術里程碑

1. **v0.1.0 ✅ 完成** - 企業級事件系統核心
   - EventBus: Observer模式、優先級、錯誤隔離
   - EventHandler: 抽象基底、生命週期、統計追蹤
   - ChromeEventBridge: 跨上下文通訊、Promise包裝

2. **v0.2.0 📚 規劃中** - 事件驅動資料提取器  
   - BookDataExtractor: 基於EventHandler的智能提取器
   - BookstoreAdapter: 多書城適配器系統  
   - ExtractionEventHandler: 進度追蹤、完成通知
   - DataValidator: 資料驗證和清理

3. **v0.3.0 🏗 規劃中** - Chrome Extension整合
   - Manifest V3: Service Worker、Content Script
   - 事件系統整合: 跨上下文無縫通訊
   - Popup UI: 事件驅動的控制界面

4. **v0.4.0 💾 規劃中** - 統一儲存系統
   - StorageEventHandler: 事件驅動的儲存管理
   - 多適配器支援: Chrome Storage、IndexedDB
   - 自動降級: 容錯和備份機制

5. **v0.5.0 🎨 規劃中** - 完整UI系統
   - UIEventHandler: 響應式UI更新
   - Overview頁面: 事件驅動的書籍管理
   - ExportManager: 事件觸發的匯出系統

### 🎭 架構優勢

**事件驅動設計**
- 🔄 完全解耦的模組間通訊
- ⚡ 非同步、高效能的事件處理
- 🛡 錯誤隔離和恢復機制
- 📊 完整的監控和統計

**多書城支援**  
- 🌐 統一的適配器介面
- 🔧 可配置的書城規則
- 📈 易於擴展的架構設計
- 🎯 專業的錯誤處理

**Chrome Extension專業化**
- 📱 Manifest V3 現代化標準
- 🔗 跨上下文無縫通訊
- 🎮 事件驅動的使用者界面
- 🛠 完整的開發和部署工具

---

## 🎭 階段一：事件系統核心實現 ✅ 完成

### 1.1 事件總線 (Event Bus) 核心 ✅

- [x] ✅ **測試**: EventBus 類別基本功能測試
  - [x] ✅ 測試事件註冊功能
  - [x] ✅ 實現事件註冊
  - [x] ✅ 重構事件註冊邏輯
  - [x] ✅ 測試事件觸發功能  
  - [x] ✅ 實現事件觸發
  - [x] ✅ 重構事件分發邏輯
  - [x] ✅ 測試事件移除功能
  - [x] ✅ 實現事件移除
  - [x] ✅ 重構完整事件總線

#### 核心測試項目 ✅

- [x] ✅ 事件註冊與移除
- [x] ✅ 事件觸發與傳播
- [x] ✅ 事件優先級處理
- [x] ✅ 錯誤處理與隔離
- [x] ✅ 效能與記憶體管理

#### 實現成果

- **實現位置**: `src/core/event-bus.js`
- **測試覆蓋**: 15個測試，100%通過
- **功能特性**: 優先級排序、錯誤隔離、統計追蹤、記憶體管理

### 1.2 事件處理器基底類別 ✅

- [x] ✅ **測試**: EventHandler 抽象類別測試
  - [x] ✅ 測試處理器介面規範
  - [x] ✅ 實現 EventHandler 基底類別
  - [x] ✅ 重構處理器架構
  - [x] ✅ 測試統計功能
  - [x] ✅ 實現執行統計
  - [x] ✅ 重構統計邏輯

#### 實現成果

- **實現位置**: `src/core/event-handler.js`
- **測試覆蓋**: 20個測試，100%通過
- **功能特性**: 抽象基底類別、生命週期管理、統計追蹤、錯誤隔離

### 1.3 Chrome Extension 事件橋接 ✅

- [x] ✅ **測試**: ChromeEventBridge 跨上下文通訊測試
  - [x] ✅ 測試 background ↔ content script 通訊
  - [x] ✅ 實現跨上下文事件傳遞
  - [x] ✅ 重構通訊機制
  - [x] ✅ 測試 popup ↔ background 通訊
  - [x] ✅ 實現彈出視窗通訊
  - [x] ✅ 重構整體橋接邏輯

#### 實現成果

- **實現位置**: `src/core/chrome-event-bridge.js`
- **測試覆蓋**: 22個測試，100%通過
- **功能特性**: 跨上下文通訊、Promise包裝Chrome API、錯誤容錯、資源管理

### 🎉 階段一完成：事件系統核心 (57/57 測試通過)

---

## 📚 階段二：資料提取器實現 (基於 v0.1.0 事件系統)

> **設計文檔**: `docs/architecture/data-extractor-design.md`  
> **基於**: v0.1.0 事件系統核心 (EventBus + EventHandler + ChromeEventBridge)

### 2.1 BookDataExtractor 核心提取器 (繼承 EventHandler)

- [ ] ⭕ **TDD循環 #1**: BookDataExtractor 基礎架構
  - [ ] 🔴 測試 EventHandler 繼承和事件支援
  - [ ] 🟢 實現 BookDataExtractor 基底類別
  - [ ] 🔵 重構提取器架構

- [ ] ⭕ **TDD循環 #2**: 書城識別和適配器選擇
  - [ ] 🔴 測試 URL 書城識別邏輯
  - [ ] 🟢 實現書城檢測功能
  - [ ] 🔵 重構識別算法
  - [ ] 🔴 測試適配器選擇機制
  - [ ] 🟢 實現適配器註冊和選擇
  - [ ] 🔵 重構適配器管理

- [ ] ⭕ **TDD循環 #3**: 事件驅動提取流程
  - [ ] 🔴 測試 EXTRACTION.STARTED 事件處理
  - [ ] 🟢 實現提取開始邏輯
  - [ ] 🔵 重構事件處理
  - [ ] 🔴 測試 EXTRACTION.COMPLETED 事件觸發
  - [ ] 🟢 實現提取完成邏輯
  - [ ] 🔵 重構完成處理

#### 實現目標
- **實現位置**: `src/extractors/book-data-extractor.js`
- **事件支援**: `EXTRACTION.STARTED`, `TAB.UPDATED.BOOKSTORE`, `USER.EXTRACT.REQUESTED`
- **功能特性**: 基於EventHandler、多書城支援、事件驅動流程

### 2.2 BookstoreAdapter 適配器系統

- [ ] ⭕ **TDD循環 #4**: BookstoreAdapter 基底類別
  - [ ] 🔴 測試適配器基底類別功能
  - [ ] 🟢 實現 BookstoreAdapter 抽象類別
  - [ ] 🔵 重構適配器介面

- [ ] ⭕ **TDD循環 #5**: ReadmooAdapter 實現
  - [ ] 🔴 測試 Readmoo URL 識別
  - [ ] 🟢 實現 ReadmooAdapter 初始化
  - [ ] 🔵 重構適配器配置
  - [ ] 🔴 測試 DOM 元素查找
  - [ ] 🟢 實現書籍元素選擇器
  - [ ] 🔵 重構 DOM 查詢邏輯
  - [ ] 🔴 測試書籍資料提取
  - [ ] 🟢 實現完整的資料提取
  - [ ] 🔵 重構提取邏輯

- [ ] ⭕ **TDD循環 #6**: 進度和狀態提取
  - [ ] 🔴 測試閱讀進度解析
  - [ ] 🟢 實現進度條資料提取
  - [ ] 🔵 重構進度計算
  - [ ] 🔴 測試特殊標記識別（新書/完讀）
  - [ ] 🟢 實現狀態標記提取
  - [ ] 🔵 重構狀態識別邏輯

#### 實現目標
- **實現位置**: `src/extractors/adapters/`
- **支援書城**: Readmoo (v0.2.0), 博客來/金石堂/Kobo (後續版本)
- **功能特性**: 抽象適配器、URL識別、DOM解析、資料驗證

### 2.3 ExtractionEventHandler 事件處理器

- [ ] ⭕ **TDD循環 #7**: 提取進度事件處理器
  - [ ] 🔴 測試 EXTRACTION.PROGRESS 事件處理
  - [ ] 🟢 實現 ExtractionProgressHandler
  - [ ] 🔵 重構進度處理邏輯
  - [ ] 🔴 測試 UI 進度更新事件觸發
  - [ ] 🟢 實現 UI.PROGRESS.UPDATE 事件
  - [ ] 🔵 重構 UI 整合

- [ ] ⭕ **TDD循環 #8**: 提取完成事件處理器
  - [ ] 🔴 測試 EXTRACTION.COMPLETED 事件處理
  - [ ] 🟢 實現 ExtractionCompletedHandler
  - [ ] 🔵 重構完成處理邏輯
  - [ ] 🔴 測試儲存事件觸發
  - [ ] 🟢 實現 STORAGE.SAVE.REQUESTED 事件
  - [ ] 🔵 重構儲存整合
  - [ ] 🔴 測試通知事件觸發
  - [ ] 🟢 實現 UI.NOTIFICATION.SHOW 事件
  - [ ] 🔵 重構通知系統

#### 實現目標
- **實現位置**: `src/extractors/handlers/`
- **事件處理**: 進度追蹤、完成通知、儲存觸發、UI更新
- **功能特性**: 基於EventHandler、事件鏈式處理、錯誤隔離

### 2.4 DataValidator 資料驗證器

- [ ] ⭕ **TDD循環 #9**: 書籍資料驗證器
  - [ ] 🔴 測試基本資料格式驗證
  - [ ] 🟢 實現 DataValidator 核心
  - [ ] 🔵 重構驗證邏輯
  - [ ] 🔴 測試書城特定驗證規則
  - [ ] 🟢 實現書城適配驗證
  - [ ] 🔵 重構驗證規則
  - [ ] 🔴 測試資料清理和標準化
  - [ ] 🟢 實現資料清理邏輯
  - [ ] 🔵 重構清理機制

#### 實現目標
- **實現位置**: `src/extractors/validators/`
- **驗證規則**: 必填欄位、資料格式、書城特定規則
- **功能特性**: 資料清理、格式標準化、錯誤報告

### 🎉 階段二完成：基於事件系統的資料提取器 (預計9個TDD循環)

---

## 🏗 階段三：Chrome Extension 基礎架構 (整合事件系統)

> **依賴**: v0.1.0 事件系統核心 + v0.2.0 資料提取器  
> **目標**: 將事件系統和提取器整合到 Chrome Extension 中

### 3.1 Chrome Extension 核心檔案

- [ ] ⭕ **TDD循環 #10**: manifest.json 配置
  - [ ] 🔴 測試 Manifest V3 格式驗證
  - [ ] 🟢 實現 manifest.json 基礎配置
  - [ ] 🔵 重構權限和配置
  - [ ] 🔴 測試事件系統權限需求
  - [ ] 🟢 實現完整的權限配置
  - [ ] 🔵 重構 manifest 結構

- [ ] ⭕ **TDD循環 #11**: Background Service Worker (事件系統整合)
  - [ ] 🔴 測試 Service Worker 載入
  - [ ] 🟢 實現基本 background.js
  - [ ] 🔵 重構 Worker 結構
  - [ ] 🔴 測試事件系統初始化
  - [ ] 🟢 實現 EventBus 在 background 中的初始化
  - [ ] 🔵 重構事件系統整合
  - [ ] 🔴 測試跨上下文事件橋接
  - [ ] 🟢 實現 ChromeEventBridge 初始化
  - [ ] 🔵 重構橋接器配置

- [ ] ⭕ **TDD循環 #12**: Content Script (提取器整合)
  - [ ] 🔴 測試 Content Script 注入
  - [ ] 🟢 實現基本 content.js
  - [ ] 🔵 重構注入邏輯
  - [ ] 🔴 測試提取器在 Content Script 中的初始化
  - [ ] 🟢 實現 BookDataExtractor 整合
  - [ ] 🔵 重構提取器集成
  - [ ] 🔴 測試事件通訊機制
  - [ ] 🟢 實現 content 與 background 事件通訊
  - [ ] 🔵 重構通訊邏輯

#### 實現目標
- **實現位置**: `manifest.json`, `src/background/`, `src/content/`
- **核心功能**: Manifest V3、Service Worker、Content Script
- **事件整合**: EventBus 初始化、ChromeEventBridge 配置、跨上下文通訊

### 3.2 Popup UI (事件驅動界面)

- [ ] ⭕ **TDD循環 #13**: Popup 基本界面
  - [ ] 🔴 測試 Popup HTML 結構
  - [ ] 🟢 實現基本 popup.html
  - [ ] 🔵 重構 UI 結構
  - [ ] 🔴 測試 Popup 與 background 通訊
  - [ ] 🟢 實現事件驅動的 popup.js
  - [ ] 🔵 重構 Popup 事件處理

- [ ] ⭕ **TDD循環 #14**: 提取控制界面
  - [ ] 🔴 測試提取觸發按鈕
  - [ ] 🟢 實現提取開始 UI
  - [ ] 🔵 重構提取控制
  - [ ] 🔴 測試進度顯示
  - [ ] 🟢 實現進度條和狀態顯示
  - [ ] 🔵 重構進度 UI
  - [ ] 🔴 測試結果展示
  - [ ] 🟢 實現提取結果展示
  - [ ] 🔵 重構結果 UI

#### 實現目標
- **實現位置**: `src/popup/`
- **UI功能**: 提取控制、進度顯示、結果展示、設定管理
- **事件整合**: UI事件驅動、background通訊、即時狀態更新

---

## 💾 階段四：儲存系統實現 (事件驅動)

> **依賴**: v0.1.0 事件系統 + v0.2.0 資料提取器  
> **目標**: 基於事件系統實現統一的資料儲存解決方案

### 4.1 StorageEventHandler 儲存事件處理器 (繼承 EventHandler)

- [ ] ⭕ **TDD循環 #15**: 儲存請求事件處理器
  - [ ] 🔴 測試 STORAGE.SAVE.REQUESTED 事件處理
  - [ ] 🟢 實現 StorageSaveHandler
  - [ ] 🔵 重構儲存處理邏輯
  - [ ] 🔴 測試 STORAGE.LOAD.REQUESTED 事件處理
  - [ ] 🟢 實現 StorageLoadHandler
  - [ ] 🔵 重構載入處理邏輯

- [ ] ⭕ **TDD循環 #16**: 儲存完成事件處理器
  - [ ] 🔴 測試 STORAGE.SAVE.COMPLETED 事件觸發
  - [ ] 🟢 實現儲存完成通知
  - [ ] 🔵 重構完成處理
  - [ ] 🔴 測試 STORAGE.ERROR 事件處理
  - [ ] 🟢 實現錯誤處理和恢復
  - [ ] 🔵 重構錯誤處理邏輯

#### 實現目標
- **實現位置**: `src/storage/handlers/`
- **事件支援**: `STORAGE.SAVE.REQUESTED`, `STORAGE.LOAD.REQUESTED`, `STORAGE.SAVE.COMPLETED`
- **功能特性**: 基於EventHandler、自動適配器選擇、錯誤恢復

### 4.2 StorageAdapter 適配器系統

- [ ] ⭕ **TDD循環 #17**: StorageAdapter 基底類別
  - [ ] 🔴 測試適配器基底類別功能
  - [ ] 🟢 實現 StorageAdapter 抽象類別
  - [ ] 🔵 重構適配器介面
  - [ ] 🔴 測試適配器能力檢測
  - [ ] 🟢 實現容量和功能檢測
  - [ ] 🔵 重構檢測邏輯

- [ ] ⭕ **TDD循環 #18**: ChromeStorageAdapter 實現
  - [ ] 🔴 測試 Chrome Storage API 包裝
  - [ ] 🟢 實現 ChromeStorageAdapter
  - [ ] 🔵 重構 Chrome Storage 邏輯
  - [ ] 🔴 測試配額管理和錯誤處理
  - [ ] 🟢 實現配額檢查和超出處理
  - [ ] 🔵 重構配額管理
  - [ ] 🔴 測試同步/非同步儲存
  - [ ] 🟢 實現 sync 和 local 儲存選擇
  - [ ] 🔵 重構儲存策略

- [ ] ⭕ **TDD循環 #19**: IndexedDBAdapter 實現
  - [ ] 🔴 測試 IndexedDB 初始化
  - [ ] 🟢 實現 IndexedDBAdapter
  - [ ] 🔵 重構資料庫邏輯
  - [ ] 🔴 測試大量資料批次處理
  - [ ] 🟢 實現批次操作和事務
  - [ ] 🔵 重構效能最佳化
  - [ ] 🔴 測試資料遷移和版本管理
  - [ ] 🟢 實現資料庫升級機制
  - [ ] 🔵 重構遷移邏輯

#### 實現目標
- **實現位置**: `src/storage/adapters/`
- **支援儲存**: Chrome Storage (sync/local), IndexedDB, LocalStorage (fallback)
- **功能特性**: 自動降級、配額管理、批次處理、資料遷移

### 4.3 StorageManager 統一儲存管理器

- [ ] ⭕ **TDD循環 #20**: 適配器選擇和管理
  - [ ] 🔴 測試適配器自動選擇邏輯
  - [ ] 🟢 實現 StorageManager 核心
  - [ ] 🔵 重構管理器架構
  - [ ] 🔴 測試適配器降級機制
  - [ ] 🟢 實現自動降級和容錯
  - [ ] 🔵 重構降級邏輯

- [ ] ⭕ **TDD循環 #21**: 資料同步和備份
  - [ ] 🔴 測試跨適配器資料同步
  - [ ] 🟢 實現自動備份機制
  - [ ] 🔵 重構同步邏輯
  - [ ] 🔴 測試資料一致性檢查
  - [ ] 🟢 實現一致性驗證
  - [ ] 🔵 重構驗證機制

#### 實現目標
- **實現位置**: `src/storage/storage-manager.js`
- **核心功能**: 適配器管理、自動降級、資料同步、備份恢復
- **事件整合**: 與提取器無縫整合、即時狀態回饋

### 🎉 階段四完成：完整的事件驅動儲存系統 (預計7個TDD循環)

---

## 🎨 階段五：UI 組件實現 (事件驅動界面)

> **依賴**: v0.1.0 事件系統 + v0.2.0 資料提取器 + v0.3.0 Chrome Extension  
> **目標**: 基於事件系統實現響應式和互動式使用者界面

### 5.1 UIEventHandler UI事件處理器 (繼承 EventHandler)

- [ ] ⭕ **TDD循環 #22**: UI更新事件處理器
  - [ ] 🔴 測試 UI.PROGRESS.UPDATE 事件處理
  - [ ] 🟢 實現 UIProgressHandler
  - [ ] 🔵 重構進度更新邏輯
  - [ ] 🔴 測試 UI.NOTIFICATION.SHOW 事件處理
  - [ ] 🟢 實現 UINotificationHandler
  - [ ] 🔵 重構通知系統

- [ ] ⭕ **TDD循環 #23**: UI狀態管理事件處理器
  - [ ] 🔴 測試 UI.STATE.CHANGED 事件處理
  - [ ] 🟢 實現 UIStateHandler
  - [ ] 🔵 重構狀態管理
  - [ ] 🔴 測試跨組件狀態同步
  - [ ] 🟢 實現狀態同步機制
  - [ ] 🔵 重構狀態同步邏輯

#### 實現目標
- **實現位置**: `src/ui/handlers/`
- **事件支援**: `UI.PROGRESS.UPDATE`, `UI.NOTIFICATION.SHOW`, `UI.STATE.CHANGED`
- **功能特性**: 基於EventHandler、響應式更新、狀態管理

### 5.2 Popup 彈出視窗 (事件驅動控制面板)

- [ ] ⭕ **TDD循環 #24**: Popup 核心功能
  - [ ] 🔴 測試 Popup 與事件系統整合
  - [ ] 🟢 實現 Popup 事件監聽
  - [ ] 🔵 重構事件整合
  - [ ] 🔴 測試提取控制操作
  - [ ] 🟢 實現提取觸發和控制
  - [ ] 🔵 重構控制邏輯

- [ ] ⭕ **TDD循環 #25**: Popup UI組件
  - [ ] 🔴 測試狀態顯示組件
  - [ ] 🟢 實現即時狀態更新
  - [ ] 🔵 重構狀態顯示
  - [ ] 🔴 測試進度條組件
  - [ ] 🟢 實現動態進度顯示
  - [ ] 🔵 重構進度組件

#### 實現目標
- **實現位置**: `src/popup/`
- **UI功能**: 狀態顯示、提取控制、進度追蹤、設定管理
- **事件整合**: 與background通訊、即時狀態更新、使用者操作回饋

### 5.3 Overview 概覽頁面 (響應式書籍管理)

- [ ] ⭕ **TDD循環 #26**: Overview 頁面架構
  - [ ] 🔴 測試頁面初始化和事件系統整合
  - [ ] 🟢 實現 Overview 基底架構
  - [ ] 🔵 重構頁面架構
  - [ ] 🔴 測試資料載入和顯示
  - [ ] 🟢 實現事件驅動的資料載入
  - [ ] 🔵 重構資料處理

- [ ] ⭕ **TDD循環 #27**: 書籍展示系統
  - [ ] 🔴 測試書籍網格渲染
  - [ ] 🟢 實現響應式書籍網格
  - [ ] 🔵 重構渲染邏輯
  - [ ] 🔴 測試虛擬滾動
  - [ ] 🟢 實現大量資料處理
  - [ ] 🔵 重構效能優化

- [ ] ⭕ **TDD循環 #28**: 搜尋和篩選系統
  - [ ] 🔴 測試即時搜尋功能
  - [ ] 🟢 實現搜尋組件
  - [ ] 🔵 重構搜尋演算法
  - [ ] 🔴 測試多維度篩選
  - [ ] 🟢 實現篩選器系統
  - [ ] 🔵 重構篩選邏輯

#### 實現目標
- **實現位置**: `overview.html`, `assets/js/`
- **核心功能**: 書籍展示、搜尋篩選、批次操作、詳細檢視
- **事件整合**: 監聽儲存事件、響應資料變更、觸發UI更新

### 5.4 ExportManager 匯出管理系統 (事件觸發)

- [ ] ⭕ **TDD循環 #29**: 匯出事件處理器
  - [ ] 🔴 測試 EXPORT.REQUESTED 事件處理
  - [ ] 🟢 實現 ExportHandler
  - [ ] 🔵 重構匯出邏輯
  - [ ] 🔴 測試多格式匯出支援
  - [ ] 🟢 實現 CSV、JSON 匯出器
  - [ ] 🔵 重構格式處理

- [ ] ⭕ **TDD循環 #30**: 匯出進度和通知
  - [ ] 🔴 測試匯出進度追蹤
  - [ ] 🟢 實現進度通知系統
  - [ ] 🔵 重構進度處理
  - [ ] 🔴 測試匯出完成事件
  - [ ] 🟢 實現 EXPORT.COMPLETED 事件
  - [ ] 🔵 重構完成處理

#### 實現目標
- **實現位置**: `src/ui/export/`
- **匯出格式**: CSV、JSON、Excel (進階功能)
- **功能特性**: 進度追蹤、背景處理、批次匯出、格式自訂

### 🎉 階段五完成：完整的事件驅動UI系統 (預計9個TDD循環)

---

## 🔧 階段六：錯誤處理與監控

### 6.1 錯誤處理系統

- [ ] ⭕ **測試**: EventErrorHandler 測試
  - [ ] 🔴 測試錯誤捕獲
  - [ ] 🟢 實現錯誤處理器
  - [ ] 🔵 重構錯誤邏輯
  - [ ] 🔴 測試斷路器模式
  - [ ] 🟢 實現斷路器
  - [ ] 🔵 重構恢復機制

### 6.2 效能監控

- [ ] ⭕ **測試**: EventPerformanceMonitor 測試
  - [ ] 🔴 測試效能指標收集
  - [ ] 🟢 實現效能監控
  - [ ] 🔵 重構監控邏輯
  - [ ] 🔴 測試效能警告
  - [ ] 🟢 實現警告機制
  - [ ] 🔵 重構警告邏輯

### 6.3 事件追蹤

- [ ] ⭕ **測試**: EventTracker 測試
  - [ ] 🔴 測試事件記錄
  - [ ] 🟢 實現事件追蹤
  - [ ] 🔵 重構追蹤邏輯
  - [ ] 🔴 測試資料匯出
  - [ ] 🟢 實現追蹤匯出
  - [ ] 🔵 重構匯出格式

---

## 🔗 階段七：整合測試與優化

### 7.1 端對端測試

- [ ] ⭕ **測試**: 完整資料提取流程測試
  - [ ] 🔴 測試使用者操作流程
  - [ ] 🟢 實現端對端測試
  - [ ] 🔵 重構測試腳本
  - [ ] 🔴 測試錯誤恢復流程
  - [ ] 🟢 實現錯誤測試
  - [ ] 🔵 重構錯誤處理

### 7.2 效能優化

- [ ] ⭕ **測試**: 效能基準測試
  - [ ] 🔴 測試大量資料處理
  - [ ] 🟢 實現效能優化
  - [ ] 🔵 重構最佳化邏輯
  - [ ] 🔴 測試記憶體使用
  - [ ] 🟢 實現記憶體最佳化
  - [ ] 🔵 重構資源管理

### 7.3 使用者體驗優化

- [ ] ⭕ **測試**: UX 互動測試
  - [ ] 🔴 測試載入狀態
  - [ ] 🟢 實現載入指示器
  - [ ] 🔵 重構使用者回饋
  - [ ] 🔴 測試錯誤訊息
  - [ ] 🟢 實現友善錯誤訊息
  - [ ] 🔵 重構訊息系統

---

## 📊 總體進度追蹤

### 整體完成度

- [ ] 🏗 階段一：Chrome Extension 基礎架構 (0%)
- [ ] 🎭 階段二：事件系統核心實現 (0%)
- [ ] 📚 階段三：資料提取器實現 (0%)
- [ ] 💾 階段四：儲存系統實現 (0%)
- [ ] 🎨 階段五：UI 組件實現 (0%)
- [ ] 🔧 階段六：錯誤處理與監控 (0%)
- [ ] 🔗 階段七：整合測試與優化 (0%)

### TDD 循環統計

- 🔴 紅燈階段: 0 個測試待實現
- 🟢 綠燈階段: 0 個功能待完成  
- 🔵 重構階段: 0 個項目待重構
- ✅ 已完成: 0 個項目

### 測試覆蓋率目標

- [ ] 單元測試覆蓋率 ≥ 90%
- [ ] 整合測試覆蓋率 ≥ 80%
- [ ] 端對端測試覆蓋率 ≥ 70%

---

## 🎯 當前焦點

**✅ 已完成的基礎工作：**

1. ✅ 建立專案檔案結構整理
2. ✅ 新增 .gitignore 檔案  
3. ✅ 將文件檔案整理到 docs/ 資料夾
4. ✅ 建立 CHANGELOG.md 版本記錄
5. ✅ 建立 .cursorrules 開發規範
6. ✅ 完成 TDD 測試框架建置與驗證
7. ✅ 確認紅燈狀態 - 4個功能測試失敗，等待實現

**🔴 當前紅燈狀態分析：**

- **總計測試**: 49個測試 (4個失敗，45個通過)
- **失敗原因**: 功能尚未實現（符合TDD預期）
- **已完成的功能** ✅:
  1. 儲存配額錯誤處理 (Chrome Storage)
  2. localStorage 模擬修正
  3. 資料格式驗證功能
  4. 無效書籍ID處理邏輯（多書城支援）

**🎉 TDD 基礎階段完成：100% 測試通過 (50/50)**

**🎯 下一階段：Chrome Extension 實現**

**TDD 提醒：**

- ❗ 絕對不能在沒有測試的情況下寫程式碼
- ❗ 每次只實現讓測試通過的最小程式碼
- ❗ 重構時必須保持所有測試通過
- ❗ 定期執行完整測試套件

---

**最後更新：** 2025-07-29
**版本：** v0.0.1
